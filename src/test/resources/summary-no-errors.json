[
  {
    "location": {
      "file": "src/test/resources/opa/policies/policies-test.rego",
      "row": 3,
      "col": 1
    },
    "package": "data.http.request.authz",
    "name": "test_allow_is_false_by_default",
    "duration": 495819,
    "trace": [
      {
        "Op": "Enter",
        "Node": [
          {
            "index": 0,
            "terms": [
              {
                "type": "ref",
                "value": [
                  {
                    "type": "var",
                    "value": "eq"
                  }
                ]
              },
              {
                "type": "ref",
                "value": [
                  {
                    "type": "var",
                    "value": "data"
                  },
                  {
                    "type": "string",
                    "value": "http"
                  },
                  {
                    "type": "string",
                    "value": "request"
                  },
                  {
                    "type": "string",
                    "value": "authz"
                  },
                  {
                    "type": "string",
                    "value": "test_allow_is_false_by_default"
                  }
                ]
              },
              {
                "type": "var",
                "value": "$term1"
              }
            ]
          }
        ],
        "Location": {
          "file": "",
          "row": 1,
          "col": 1
        },
        "QueryID": 0,
        "ParentID": 0,
        "Locals": null,
        "LocalMetadata": {},
        "Message": ""
      },
      {
        "Op": "Enter",
        "Node": {
          "head": {
            "name": "test_allow_is_false_by_default",
            "value": {
              "type": "boolean",
              "value": true
            }
          },
          "body": [
            {
              "index": 0,
              "negated": true,
              "terms": {
                "type": "ref",
                "value": [
                  {
                    "type": "var",
                    "value": "data"
                  },
                  {
                    "type": "string",
                    "value": "http"
                  },
                  {
                    "type": "string",
                    "value": "request"
                  },
                  {
                    "type": "string",
                    "value": "authz"
                  },
                  {
                    "type": "string",
                    "value": "allow"
                  }
                ]
              }
            }
          ]
        },
        "Location": {
          "file": "src/test/resources/opa/policies/policies-test.rego",
          "row": 3,
          "col": 1
        },
        "QueryID": 1,
        "ParentID": 0,
        "Locals": null,
        "LocalMetadata": {},
        "Message": ""
      },
      {
        "Op": "Enter",
        "Node": [
          {
            "index": 0,
            "terms": {
              "type": "ref",
              "value": [
                {
                  "type": "var",
                  "value": "data"
                },
                {
                  "type": "string",
                  "value": "http"
                },
                {
                  "type": "string",
                  "value": "request"
                },
                {
                  "type": "string",
                  "value": "authz"
                },
                {
                  "type": "string",
                  "value": "allow"
                }
              ]
            }
          }
        ],
        "Location": {
          "file": "src/test/resources/opa/policies/policies-test.rego",
          "row": 4,
          "col": 9
        },
        "QueryID": 2,
        "ParentID": 1,
        "Locals": null,
        "LocalMetadata": {},
        "Message": ""
      },
      {
        "Op": "Enter",
        "Node": {
          "head": {
            "name": "allow",
            "value": {
              "type": "var",
              "value": "__local29__"
            }
          },
          "body": [
            {
              "index": 0,
              "terms": {
                "type": "boolean",
                "value": true
              }
            },
            {
              "generated": true,
              "index": 1,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local29__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "status"
                    },
                    {
                      "type": "string",
                      "value": "allowed"
                    }
                  ]
                }
              ]
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 47,
          "col": 9
        },
        "QueryID": 3,
        "ParentID": 2,
        "Locals": null,
        "LocalMetadata": {},
        "Message": ""
      },
      {
        "Op": "Enter",
        "Node": {
          "head": {
            "name": "status",
            "value": {
              "type": "object",
              "value": [
                [
                  {
                    "type": "string",
                    "value": "allowed"
                  },
                  {
                    "type": "boolean",
                    "value": true
                  }
                ],
                [
                  {
                    "type": "string",
                    "value": "reason"
                  },
                  {
                    "type": "var",
                    "value": "__local17__"
                  }
                ]
              ]
            }
          },
          "body": [
            {
              "generated": true,
              "index": 0,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local44__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "accessToWhitelistAllowed"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 1,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "count"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local44__"
                },
                {
                  "type": "var",
                  "value": "__local18__"
                }
              ]
            },
            {
              "index": 2,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "gt"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local18__"
                },
                {
                  "type": "number",
                  "value": 0
                }
              ]
            },
            {
              "generated": true,
              "index": 3,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local45__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "accessToWhitelistAllowed"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 4,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "concat"
                    }
                  ]
                },
                {
                  "type": "string",
                  "value": " | "
                },
                {
                  "type": "var",
                  "value": "__local45__"
                },
                {
                  "type": "var",
                  "value": "__local17__"
                }
              ]
            }
          ],
          "else": {
            "head": {
              "name": "status",
              "value": {
                "type": "object",
                "value": [
                  [
                    {
                      "type": "string",
                      "value": "allowed"
                    },
                    {
                      "type": "boolean",
                      "value": false
                    }
                  ],
                  [
                    {
                      "type": "string",
                      "value": "reason"
                    },
                    {
                      "type": "var",
                      "value": "__local19__"
                    }
                  ]
                ]
              }
            },
            "body": [
              {
                "generated": true,
                "index": 0,
                "terms": [
                  {
                    "type": "ref",
                    "value": [
                      {
                        "type": "var",
                        "value": "eq"
                      }
                    ]
                  },
                  {
                    "type": "var",
                    "value": "__local46__"
                  },
                  {
                    "type": "ref",
                    "value": [
                      {
                        "type": "var",
                        "value": "data"
                      },
                      {
                        "type": "string",
                        "value": "http"
                      },
                      {
                        "type": "string",
                        "value": "request"
                      },
                      {
                        "type": "string",
                        "value": "authz"
                      },
                      {
                        "type": "string",
                        "value": "accessToResourceNotAllowed"
                      }
                    ]
                  }
                ]
              },
              {
                "generated": true,
                "index": 1,
                "terms": [
                  {
                    "type": "ref",
                    "value": [
                      {
                        "type": "var",
                        "value": "count"
                      }
                    ]
                  },
                  {
                    "type": "var",
                    "value": "__local46__"
                  },
                  {
                    "type": "var",
                    "value": "__local20__"
                  }
                ]
              },
              {
                "index": 2,
                "terms": [
                  {
                    "type": "ref",
                    "value": [
                      {
                        "type": "var",
                        "value": "gt"
                      }
                    ]
                  },
                  {
                    "type": "var",
                    "value": "__local20__"
                  },
                  {
                    "type": "number",
                    "value": 0
                  }
                ]
              },
              {
                "generated": true,
                "index": 3,
                "terms": [
                  {
                    "type": "ref",
                    "value": [
                      {
                        "type": "var",
                        "value": "eq"
                      }
                    ]
                  },
                  {
                    "type": "var",
                    "value": "__local47__"
                  },
                  {
                    "type": "ref",
                    "value": [
                      {
                        "type": "var",
                        "value": "data"
                      },
                      {
                        "type": "string",
                        "value": "http"
                      },
                      {
                        "type": "string",
                        "value": "request"
                      },
                      {
                        "type": "string",
                        "value": "authz"
                      },
                      {
                        "type": "string",
                        "value": "accessToResourceNotAllowed"
                      }
                    ]
                  }
                ]
              },
              {
                "generated": true,
                "index": 4,
                "terms": [
                  {
                    "type": "ref",
                    "value": [
                      {
                        "type": "var",
                        "value": "concat"
                      }
                    ]
                  },
                  {
                    "type": "string",
                    "value": " | "
                  },
                  {
                    "type": "var",
                    "value": "__local47__"
                  },
                  {
                    "type": "var",
                    "value": "__local19__"
                  }
                ]
              }
            ],
            "else": {
              "head": {
                "name": "status",
                "value": {
                  "type": "object",
                  "value": [
                    [
                      {
                        "type": "string",
                        "value": "allowed"
                      },
                      {
                        "type": "boolean",
                        "value": true
                      }
                    ],
                    [
                      {
                        "type": "string",
                        "value": "reason"
                      },
                      {
                        "type": "string",
                        "value": "Access allowed, all rules passed"
                      }
                    ]
                  ]
                }
              },
              "body": [
                {
                  "index": 0,
                  "terms": {
                    "type": "boolean",
                    "value": true
                  }
                }
              ]
            }
          }
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 39,
          "col": 1
        },
        "QueryID": 4,
        "ParentID": 3,
        "Locals": null,
        "LocalMetadata": {},
        "Message": ""
      },
      {
        "Op": "Fail",
        "Node": {
          "index": 2,
          "terms": [
            {
              "type": "ref",
              "value": [
                {
                  "type": "var",
                  "value": "gt"
                }
              ]
            },
            {
              "type": "var",
              "value": "__local18__"
            },
            {
              "type": "number",
              "value": 0
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 40,
          "col": 5
        },
        "QueryID": 4,
        "ParentID": 3,
        "Locals": [
          {
            "name": "__local44__",
            "type": "set",
            "value": []
          },
          {
            "name": "__local18__",
            "type": "number",
            "value": 0
          }
        ],
        "LocalMetadata": {
          "__local18__": {
            "name": "__local18__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 40,
              "col": 5
            }
          },
          "__local44__": {
            "name": "__local44__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 40,
              "col": 11
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Enter",
        "Node": {
          "head": {
            "name": "status",
            "value": {
              "type": "object",
              "value": [
                [
                  {
                    "type": "string",
                    "value": "allowed"
                  },
                  {
                    "type": "boolean",
                    "value": false
                  }
                ],
                [
                  {
                    "type": "string",
                    "value": "reason"
                  },
                  {
                    "type": "var",
                    "value": "__local19__"
                  }
                ]
              ]
            }
          },
          "body": [
            {
              "generated": true,
              "index": 0,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local46__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "accessToResourceNotAllowed"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 1,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "count"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local46__"
                },
                {
                  "type": "var",
                  "value": "__local20__"
                }
              ]
            },
            {
              "index": 2,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "gt"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local20__"
                },
                {
                  "type": "number",
                  "value": 0
                }
              ]
            },
            {
              "generated": true,
              "index": 3,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local47__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "accessToResourceNotAllowed"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 4,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "concat"
                    }
                  ]
                },
                {
                  "type": "string",
                  "value": " | "
                },
                {
                  "type": "var",
                  "value": "__local47__"
                },
                {
                  "type": "var",
                  "value": "__local19__"
                }
              ]
            }
          ],
          "else": {
            "head": {
              "name": "status",
              "value": {
                "type": "object",
                "value": [
                  [
                    {
                      "type": "string",
                      "value": "allowed"
                    },
                    {
                      "type": "boolean",
                      "value": true
                    }
                  ],
                  [
                    {
                      "type": "string",
                      "value": "reason"
                    },
                    {
                      "type": "string",
                      "value": "Access allowed, all rules passed"
                    }
                  ]
                ]
              }
            },
            "body": [
              {
                "index": 0,
                "terms": {
                  "type": "boolean",
                  "value": true
                }
              }
            ]
          }
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 41,
          "col": 3
        },
        "QueryID": 5,
        "ParentID": 3,
        "Locals": null,
        "LocalMetadata": {},
        "Message": ""
      },
      {
        "Op": "Enter",
        "Node": {
          "head": {
            "name": "accessToResourceNotAllowed",
            "key": {
              "type": "var",
              "value": "__local1__"
            }
          },
          "body": [
            {
              "index": 0,
              "negated": true,
              "terms": {
                "type": "ref",
                "value": [
                  {
                    "type": "var",
                    "value": "input"
                  },
                  {
                    "type": "string",
                    "value": "path"
                  }
                ]
              }
            },
            {
              "index": 1,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local1__"
                },
                {
                  "type": "string",
                  "value": "Invalid input, can't extract path"
                }
              ]
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 17,
          "col": 1
        },
        "QueryID": 8,
        "ParentID": 5,
        "Locals": null,
        "LocalMetadata": {
          "__local1__": {
            "name": "reason",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 17,
              "col": 28
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Enter",
        "Node": [
          {
            "index": 0,
            "terms": {
              "type": "ref",
              "value": [
                {
                  "type": "var",
                  "value": "input"
                },
                {
                  "type": "string",
                  "value": "path"
                }
              ]
            }
          }
        ],
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 18,
          "col": 9
        },
        "QueryID": 9,
        "ParentID": 8,
        "Locals": null,
        "LocalMetadata": {},
        "Message": ""
      },
      {
        "Op": "Fail",
        "Node": {
          "index": 0,
          "terms": {
            "type": "ref",
            "value": [
              {
                "type": "var",
                "value": "input"
              },
              {
                "type": "string",
                "value": "path"
              }
            ]
          }
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 18,
          "col": 9
        },
        "QueryID": 9,
        "ParentID": 8,
        "Locals": null,
        "LocalMetadata": {},
        "Message": ""
      },
      {
        "Op": "Enter",
        "Node": {
          "head": {
            "name": "accessToResourceNotAllowed",
            "key": {
              "type": "var",
              "value": "__local1__"
            }
          },
          "body": [
            {
              "index": 0,
              "negated": true,
              "terms": {
                "type": "ref",
                "value": [
                  {
                    "type": "var",
                    "value": "input"
                  },
                  {
                    "type": "string",
                    "value": "path"
                  }
                ]
              }
            },
            {
              "index": 1,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local1__"
                },
                {
                  "type": "string",
                  "value": "Invalid input, can't extract path"
                }
              ]
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 17,
          "col": 1
        },
        "QueryID": 11,
        "ParentID": 5,
        "Locals": null,
        "LocalMetadata": {
          "__local1__": {
            "name": "reason",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 17,
              "col": 28
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Enter",
        "Node": [
          {
            "index": 0,
            "terms": {
              "type": "ref",
              "value": [
                {
                  "type": "var",
                  "value": "input"
                },
                {
                  "type": "string",
                  "value": "path"
                }
              ]
            }
          }
        ],
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 18,
          "col": 9
        },
        "QueryID": 12,
        "ParentID": 11,
        "Locals": null,
        "LocalMetadata": {},
        "Message": ""
      },
      {
        "Op": "Fail",
        "Node": {
          "index": 0,
          "terms": {
            "type": "ref",
            "value": [
              {
                "type": "var",
                "value": "input"
              },
              {
                "type": "string",
                "value": "path"
              }
            ]
          }
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 18,
          "col": 9
        },
        "QueryID": 12,
        "ParentID": 11,
        "Locals": null,
        "LocalMetadata": {},
        "Message": ""
      },
      {
        "Op": "Fail",
        "Node": {
          "index": 0,
          "terms": {
            "type": "ref",
            "value": [
              {
                "type": "var",
                "value": "data"
              },
              {
                "type": "string",
                "value": "http"
              },
              {
                "type": "string",
                "value": "request"
              },
              {
                "type": "string",
                "value": "authz"
              },
              {
                "type": "string",
                "value": "allow"
              }
            ]
          }
        },
        "Location": {
          "file": "src/test/resources/opa/policies/policies-test.rego",
          "row": 4,
          "col": 9
        },
        "QueryID": 2,
        "ParentID": 1,
        "Locals": null,
        "LocalMetadata": {},
        "Message": ""
      }
    ]
  },
  {
    "location": {
      "file": "src/test/resources/opa/policies/policies-test.rego",
      "row": 12,
      "col": 1
    },
    "package": "data.http.request.authz",
    "name": "test_allow_if_path_is_ping",
    "duration": 451928,
    "trace": [
      {
        "Op": "Enter",
        "Node": [
          {
            "index": 0,
            "terms": [
              {
                "type": "ref",
                "value": [
                  {
                    "type": "var",
                    "value": "eq"
                  }
                ]
              },
              {
                "type": "ref",
                "value": [
                  {
                    "type": "var",
                    "value": "data"
                  },
                  {
                    "type": "string",
                    "value": "http"
                  },
                  {
                    "type": "string",
                    "value": "request"
                  },
                  {
                    "type": "string",
                    "value": "authz"
                  },
                  {
                    "type": "string",
                    "value": "test_allow_if_path_is_ping"
                  }
                ]
              },
              {
                "type": "var",
                "value": "$term1"
              }
            ]
          }
        ],
        "Location": {
          "file": "",
          "row": 1,
          "col": 1
        },
        "QueryID": 0,
        "ParentID": 0,
        "Locals": null,
        "LocalMetadata": {},
        "Message": ""
      },
      {
        "Op": "Enter",
        "Node": {
          "head": {
            "name": "test_allow_if_path_is_ping",
            "value": {
              "type": "boolean",
              "value": true
            }
          },
          "body": [
            {
              "index": 0,
              "terms": {
                "type": "ref",
                "value": [
                  {
                    "type": "var",
                    "value": "data"
                  },
                  {
                    "type": "string",
                    "value": "http"
                  },
                  {
                    "type": "string",
                    "value": "request"
                  },
                  {
                    "type": "string",
                    "value": "authz"
                  },
                  {
                    "type": "string",
                    "value": "allow"
                  }
                ]
              },
              "with": [
                {
                  "target": {
                    "type": "ref",
                    "value": [
                      {
                        "type": "var",
                        "value": "input"
                      }
                    ]
                  },
                  "value": {
                    "type": "object",
                    "value": [
                      [
                        {
                          "type": "string",
                          "value": "path"
                        },
                        {
                          "type": "string",
                          "value": "/ping"
                        }
                      ]
                    ]
                  }
                }
              ]
            }
          ]
        },
        "Location": {
          "file": "src/test/resources/opa/policies/policies-test.rego",
          "row": 12,
          "col": 1
        },
        "QueryID": 1,
        "ParentID": 0,
        "Locals": null,
        "LocalMetadata": {},
        "Message": ""
      },
      {
        "Op": "Enter",
        "Node": {
          "head": {
            "name": "allow",
            "value": {
              "type": "var",
              "value": "__local29__"
            }
          },
          "body": [
            {
              "index": 0,
              "terms": {
                "type": "boolean",
                "value": true
              }
            },
            {
              "generated": true,
              "index": 1,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local29__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "status"
                    },
                    {
                      "type": "string",
                      "value": "allowed"
                    }
                  ]
                }
              ]
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 47,
          "col": 9
        },
        "QueryID": 2,
        "ParentID": 1,
        "Locals": null,
        "LocalMetadata": {},
        "Message": ""
      },
      {
        "Op": "Enter",
        "Node": {
          "head": {
            "name": "status",
            "value": {
              "type": "object",
              "value": [
                [
                  {
                    "type": "string",
                    "value": "allowed"
                  },
                  {
                    "type": "boolean",
                    "value": true
                  }
                ],
                [
                  {
                    "type": "string",
                    "value": "reason"
                  },
                  {
                    "type": "var",
                    "value": "__local17__"
                  }
                ]
              ]
            }
          },
          "body": [
            {
              "generated": true,
              "index": 0,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local44__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "accessToWhitelistAllowed"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 1,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "count"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local44__"
                },
                {
                  "type": "var",
                  "value": "__local18__"
                }
              ]
            },
            {
              "index": 2,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "gt"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local18__"
                },
                {
                  "type": "number",
                  "value": 0
                }
              ]
            },
            {
              "generated": true,
              "index": 3,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local45__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "accessToWhitelistAllowed"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 4,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "concat"
                    }
                  ]
                },
                {
                  "type": "string",
                  "value": " | "
                },
                {
                  "type": "var",
                  "value": "__local45__"
                },
                {
                  "type": "var",
                  "value": "__local17__"
                }
              ]
            }
          ],
          "else": {
            "head": {
              "name": "status",
              "value": {
                "type": "object",
                "value": [
                  [
                    {
                      "type": "string",
                      "value": "allowed"
                    },
                    {
                      "type": "boolean",
                      "value": false
                    }
                  ],
                  [
                    {
                      "type": "string",
                      "value": "reason"
                    },
                    {
                      "type": "var",
                      "value": "__local19__"
                    }
                  ]
                ]
              }
            },
            "body": [
              {
                "generated": true,
                "index": 0,
                "terms": [
                  {
                    "type": "ref",
                    "value": [
                      {
                        "type": "var",
                        "value": "eq"
                      }
                    ]
                  },
                  {
                    "type": "var",
                    "value": "__local46__"
                  },
                  {
                    "type": "ref",
                    "value": [
                      {
                        "type": "var",
                        "value": "data"
                      },
                      {
                        "type": "string",
                        "value": "http"
                      },
                      {
                        "type": "string",
                        "value": "request"
                      },
                      {
                        "type": "string",
                        "value": "authz"
                      },
                      {
                        "type": "string",
                        "value": "accessToResourceNotAllowed"
                      }
                    ]
                  }
                ]
              },
              {
                "generated": true,
                "index": 1,
                "terms": [
                  {
                    "type": "ref",
                    "value": [
                      {
                        "type": "var",
                        "value": "count"
                      }
                    ]
                  },
                  {
                    "type": "var",
                    "value": "__local46__"
                  },
                  {
                    "type": "var",
                    "value": "__local20__"
                  }
                ]
              },
              {
                "index": 2,
                "terms": [
                  {
                    "type": "ref",
                    "value": [
                      {
                        "type": "var",
                        "value": "gt"
                      }
                    ]
                  },
                  {
                    "type": "var",
                    "value": "__local20__"
                  },
                  {
                    "type": "number",
                    "value": 0
                  }
                ]
              },
              {
                "generated": true,
                "index": 3,
                "terms": [
                  {
                    "type": "ref",
                    "value": [
                      {
                        "type": "var",
                        "value": "eq"
                      }
                    ]
                  },
                  {
                    "type": "var",
                    "value": "__local47__"
                  },
                  {
                    "type": "ref",
                    "value": [
                      {
                        "type": "var",
                        "value": "data"
                      },
                      {
                        "type": "string",
                        "value": "http"
                      },
                      {
                        "type": "string",
                        "value": "request"
                      },
                      {
                        "type": "string",
                        "value": "authz"
                      },
                      {
                        "type": "string",
                        "value": "accessToResourceNotAllowed"
                      }
                    ]
                  }
                ]
              },
              {
                "generated": true,
                "index": 4,
                "terms": [
                  {
                    "type": "ref",
                    "value": [
                      {
                        "type": "var",
                        "value": "concat"
                      }
                    ]
                  },
                  {
                    "type": "string",
                    "value": " | "
                  },
                  {
                    "type": "var",
                    "value": "__local47__"
                  },
                  {
                    "type": "var",
                    "value": "__local19__"
                  }
                ]
              }
            ],
            "else": {
              "head": {
                "name": "status",
                "value": {
                  "type": "object",
                  "value": [
                    [
                      {
                        "type": "string",
                        "value": "allowed"
                      },
                      {
                        "type": "boolean",
                        "value": true
                      }
                    ],
                    [
                      {
                        "type": "string",
                        "value": "reason"
                      },
                      {
                        "type": "string",
                        "value": "Access allowed, all rules passed"
                      }
                    ]
                  ]
                }
              },
              "body": [
                {
                  "index": 0,
                  "terms": {
                    "type": "boolean",
                    "value": true
                  }
                }
              ]
            }
          }
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 39,
          "col": 1
        },
        "QueryID": 3,
        "ParentID": 2,
        "Locals": null,
        "LocalMetadata": {},
        "Message": ""
      },
      {
        "Op": "Redo",
        "Node": {
          "head": {
            "name": "accessToWhitelistAllowed",
            "key": {
              "type": "var",
              "value": "__local4__"
            }
          },
          "body": [
            {
              "generated": true,
              "index": 0,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local41__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "input"
                    },
                    {
                      "type": "string",
                      "value": "path"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 1,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local42__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "whitelistedEndpoints"
                    },
                    {
                      "type": "var",
                      "value": "$0"
                    }
                  ]
                }
              ]
            },
            {
              "index": 2,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "startswith"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local41__"
                },
                {
                  "type": "var",
                  "value": "__local42__"
                }
              ]
            },
            {
              "generated": true,
              "index": 3,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local43__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "input"
                    },
                    {
                      "type": "string",
                      "value": "path"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 4,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "sprintf"
                    }
                  ]
                },
                {
                  "type": "string",
                  "value": "Resource '%v' on whitelist"
                },
                {
                  "type": "array",
                  "value": [
                    {
                      "type": "var",
                      "value": "__local43__"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local16__"
                }
              ]
            },
            {
              "index": 5,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local4__"
                },
                {
                  "type": "var",
                  "value": "__local16__"
                }
              ]
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 34,
          "col": 1
        },
        "QueryID": 4,
        "ParentID": 3,
        "Locals": [
          {
            "name": "__local4__",
            "type": "string",
            "value": "Resource '/ping' on whitelist"
          },
          {
            "name": "__local41__",
            "type": "string",
            "value": "/ping"
          },
          {
            "name": "_",
            "type": "number",
            "value": 0
          },
          {
            "name": "__local42__",
            "type": "string",
            "value": "/ping"
          },
          {
            "name": "__local43__",
            "type": "string",
            "value": "/ping"
          },
          {
            "name": "__local16__",
            "type": "string",
            "value": "Resource '/ping' on whitelist"
          }
        ],
        "LocalMetadata": {
          "$0": {
            "name": "$0",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 35,
              "col": 49
            }
          },
          "__local16__": {
            "name": "__local16__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 36,
              "col": 15
            }
          },
          "__local41__": {
            "name": "__local41__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 35,
              "col": 16
            }
          },
          "__local42__": {
            "name": "__local42__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 35,
              "col": 28
            }
          },
          "__local43__": {
            "name": "__local43__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 36,
              "col": 54
            }
          },
          "__local4__": {
            "name": "reason",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 36,
              "col": 5
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Fail",
        "Node": {
          "index": 2,
          "terms": [
            {
              "type": "ref",
              "value": [
                {
                  "type": "var",
                  "value": "startswith"
                }
              ]
            },
            {
              "type": "var",
              "value": "__local41__"
            },
            {
              "type": "var",
              "value": "__local42__"
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 35,
          "col": 5
        },
        "QueryID": 4,
        "ParentID": 3,
        "Locals": [
          {
            "name": "__local41__",
            "type": "string",
            "value": "/ping"
          },
          {
            "name": "_",
            "type": "number",
            "value": 1
          },
          {
            "name": "__local42__",
            "type": "string",
            "value": "/error"
          }
        ],
        "LocalMetadata": {
          "$0": {
            "name": "$0",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 35,
              "col": 49
            }
          },
          "__local41__": {
            "name": "__local41__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 35,
              "col": 16
            }
          },
          "__local42__": {
            "name": "__local42__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 35,
              "col": 28
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Fail",
        "Node": {
          "index": 2,
          "terms": [
            {
              "type": "ref",
              "value": [
                {
                  "type": "var",
                  "value": "startswith"
                }
              ]
            },
            {
              "type": "var",
              "value": "__local41__"
            },
            {
              "type": "var",
              "value": "__local42__"
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 35,
          "col": 5
        },
        "QueryID": 4,
        "ParentID": 3,
        "Locals": [
          {
            "name": "__local41__",
            "type": "string",
            "value": "/ping"
          },
          {
            "name": "_",
            "type": "number",
            "value": 2
          },
          {
            "name": "__local42__",
            "type": "string",
            "value": "/health"
          }
        ],
        "LocalMetadata": {
          "$0": {
            "name": "$0",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 35,
              "col": 49
            }
          },
          "__local41__": {
            "name": "__local41__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 35,
              "col": 16
            }
          },
          "__local42__": {
            "name": "__local42__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 35,
              "col": 28
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Redo",
        "Node": {
          "head": {
            "name": "accessToWhitelistAllowed",
            "key": {
              "type": "var",
              "value": "__local4__"
            }
          },
          "body": [
            {
              "generated": true,
              "index": 0,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local41__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "input"
                    },
                    {
                      "type": "string",
                      "value": "path"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 1,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local42__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "whitelistedEndpoints"
                    },
                    {
                      "type": "var",
                      "value": "$0"
                    }
                  ]
                }
              ]
            },
            {
              "index": 2,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "startswith"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local41__"
                },
                {
                  "type": "var",
                  "value": "__local42__"
                }
              ]
            },
            {
              "generated": true,
              "index": 3,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local43__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "input"
                    },
                    {
                      "type": "string",
                      "value": "path"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 4,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "sprintf"
                    }
                  ]
                },
                {
                  "type": "string",
                  "value": "Resource '%v' on whitelist"
                },
                {
                  "type": "array",
                  "value": [
                    {
                      "type": "var",
                      "value": "__local43__"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local16__"
                }
              ]
            },
            {
              "index": 5,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local4__"
                },
                {
                  "type": "var",
                  "value": "__local16__"
                }
              ]
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 34,
          "col": 1
        },
        "QueryID": 6,
        "ParentID": 3,
        "Locals": [
          {
            "name": "__local43__",
            "type": "string",
            "value": "/ping"
          },
          {
            "name": "__local16__",
            "type": "string",
            "value": "Resource '/ping' on whitelist"
          },
          {
            "name": "__local4__",
            "type": "string",
            "value": "Resource '/ping' on whitelist"
          },
          {
            "name": "__local41__",
            "type": "string",
            "value": "/ping"
          },
          {
            "name": "_",
            "type": "number",
            "value": 0
          },
          {
            "name": "__local42__",
            "type": "string",
            "value": "/ping"
          }
        ],
        "LocalMetadata": {
          "$0": {
            "name": "$0",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 35,
              "col": 49
            }
          },
          "__local16__": {
            "name": "__local16__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 36,
              "col": 15
            }
          },
          "__local41__": {
            "name": "__local41__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 35,
              "col": 16
            }
          },
          "__local42__": {
            "name": "__local42__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 35,
              "col": 28
            }
          },
          "__local43__": {
            "name": "__local43__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 36,
              "col": 54
            }
          },
          "__local4__": {
            "name": "reason",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 36,
              "col": 5
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Fail",
        "Node": {
          "index": 2,
          "terms": [
            {
              "type": "ref",
              "value": [
                {
                  "type": "var",
                  "value": "startswith"
                }
              ]
            },
            {
              "type": "var",
              "value": "__local41__"
            },
            {
              "type": "var",
              "value": "__local42__"
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 35,
          "col": 5
        },
        "QueryID": 6,
        "ParentID": 3,
        "Locals": [
          {
            "name": "_",
            "type": "number",
            "value": 1
          },
          {
            "name": "__local42__",
            "type": "string",
            "value": "/error"
          },
          {
            "name": "__local41__",
            "type": "string",
            "value": "/ping"
          }
        ],
        "LocalMetadata": {
          "$0": {
            "name": "$0",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 35,
              "col": 49
            }
          },
          "__local41__": {
            "name": "__local41__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 35,
              "col": 16
            }
          },
          "__local42__": {
            "name": "__local42__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 35,
              "col": 28
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Fail",
        "Node": {
          "index": 2,
          "terms": [
            {
              "type": "ref",
              "value": [
                {
                  "type": "var",
                  "value": "startswith"
                }
              ]
            },
            {
              "type": "var",
              "value": "__local41__"
            },
            {
              "type": "var",
              "value": "__local42__"
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 35,
          "col": 5
        },
        "QueryID": 6,
        "ParentID": 3,
        "Locals": [
          {
            "name": "__local42__",
            "type": "string",
            "value": "/health"
          },
          {
            "name": "__local41__",
            "type": "string",
            "value": "/ping"
          },
          {
            "name": "_",
            "type": "number",
            "value": 2
          }
        ],
        "LocalMetadata": {
          "$0": {
            "name": "$0",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 35,
              "col": 49
            }
          },
          "__local41__": {
            "name": "__local41__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 35,
              "col": 16
            }
          },
          "__local42__": {
            "name": "__local42__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 35,
              "col": 28
            }
          }
        },
        "Message": ""
      }
    ]
  },
  {
    "location": {
      "file": "src/test/resources/opa/policies/policies-test.rego",
      "row": 16,
      "col": 1
    },
    "package": "data.http.request.authz",
    "name": "test_not_allow_if_without_jwt",
    "fail": true,
    "duration": 596126,
    "trace": [
      {
        "Op": "Enter",
        "Node": [
          {
            "index": 0,
            "terms": [
              {
                "type": "ref",
                "value": [
                  {
                    "type": "var",
                    "value": "eq"
                  }
                ]
              },
              {
                "type": "ref",
                "value": [
                  {
                    "type": "var",
                    "value": "data"
                  },
                  {
                    "type": "string",
                    "value": "http"
                  },
                  {
                    "type": "string",
                    "value": "request"
                  },
                  {
                    "type": "string",
                    "value": "authz"
                  },
                  {
                    "type": "string",
                    "value": "test_not_allow_if_without_jwt"
                  }
                ]
              },
              {
                "type": "var",
                "value": "$term1"
              }
            ]
          }
        ],
        "Location": {
          "file": "",
          "row": 1,
          "col": 1
        },
        "QueryID": 0,
        "ParentID": 0,
        "Locals": null,
        "LocalMetadata": {},
        "Message": ""
      },
      {
        "Op": "Enter",
        "Node": {
          "head": {
            "name": "test_not_allow_if_without_jwt",
            "value": {
              "type": "boolean",
              "value": true
            }
          },
          "body": [
            {
              "index": 0,
              "terms": {
                "type": "ref",
                "value": [
                  {
                    "type": "var",
                    "value": "data"
                  },
                  {
                    "type": "string",
                    "value": "http"
                  },
                  {
                    "type": "string",
                    "value": "request"
                  },
                  {
                    "type": "string",
                    "value": "authz"
                  },
                  {
                    "type": "string",
                    "value": "allow"
                  }
                ]
              },
              "with": [
                {
                  "target": {
                    "type": "ref",
                    "value": [
                      {
                        "type": "var",
                        "value": "input"
                      }
                    ]
                  },
                  "value": {
                    "type": "object",
                    "value": [
                      [
                        {
                          "type": "string",
                          "value": "encodedJwt"
                        },
                        {
                          "type": "null",
                          "value": {}
                        }
                      ],
                      [
                        {
                          "type": "string",
                          "value": "path"
                        },
                        {
                          "type": "string",
                          "value": "/messages"
                        }
                      ]
                    ]
                  }
                }
              ]
            }
          ]
        },
        "Location": {
          "file": "src/test/resources/opa/policies/policies-test.rego",
          "row": 16,
          "col": 1
        },
        "QueryID": 1,
        "ParentID": 0,
        "Locals": null,
        "LocalMetadata": {},
        "Message": ""
      },
      {
        "Op": "Enter",
        "Node": {
          "head": {
            "name": "allow",
            "value": {
              "type": "var",
              "value": "__local29__"
            }
          },
          "body": [
            {
              "index": 0,
              "terms": {
                "type": "boolean",
                "value": true
              }
            },
            {
              "generated": true,
              "index": 1,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local29__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "status"
                    },
                    {
                      "type": "string",
                      "value": "allowed"
                    }
                  ]
                }
              ]
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 47,
          "col": 9
        },
        "QueryID": 2,
        "ParentID": 1,
        "Locals": null,
        "LocalMetadata": {},
        "Message": ""
      },
      {
        "Op": "Enter",
        "Node": {
          "head": {
            "name": "status",
            "value": {
              "type": "object",
              "value": [
                [
                  {
                    "type": "string",
                    "value": "allowed"
                  },
                  {
                    "type": "boolean",
                    "value": true
                  }
                ],
                [
                  {
                    "type": "string",
                    "value": "reason"
                  },
                  {
                    "type": "var",
                    "value": "__local17__"
                  }
                ]
              ]
            }
          },
          "body": [
            {
              "generated": true,
              "index": 0,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local44__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "accessToWhitelistAllowed"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 1,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "count"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local44__"
                },
                {
                  "type": "var",
                  "value": "__local18__"
                }
              ]
            },
            {
              "index": 2,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "gt"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local18__"
                },
                {
                  "type": "number",
                  "value": 0
                }
              ]
            },
            {
              "generated": true,
              "index": 3,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local45__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "accessToWhitelistAllowed"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 4,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "concat"
                    }
                  ]
                },
                {
                  "type": "string",
                  "value": " | "
                },
                {
                  "type": "var",
                  "value": "__local45__"
                },
                {
                  "type": "var",
                  "value": "__local17__"
                }
              ]
            }
          ],
          "else": {
            "head": {
              "name": "status",
              "value": {
                "type": "object",
                "value": [
                  [
                    {
                      "type": "string",
                      "value": "allowed"
                    },
                    {
                      "type": "boolean",
                      "value": false
                    }
                  ],
                  [
                    {
                      "type": "string",
                      "value": "reason"
                    },
                    {
                      "type": "var",
                      "value": "__local19__"
                    }
                  ]
                ]
              }
            },
            "body": [
              {
                "generated": true,
                "index": 0,
                "terms": [
                  {
                    "type": "ref",
                    "value": [
                      {
                        "type": "var",
                        "value": "eq"
                      }
                    ]
                  },
                  {
                    "type": "var",
                    "value": "__local46__"
                  },
                  {
                    "type": "ref",
                    "value": [
                      {
                        "type": "var",
                        "value": "data"
                      },
                      {
                        "type": "string",
                        "value": "http"
                      },
                      {
                        "type": "string",
                        "value": "request"
                      },
                      {
                        "type": "string",
                        "value": "authz"
                      },
                      {
                        "type": "string",
                        "value": "accessToResourceNotAllowed"
                      }
                    ]
                  }
                ]
              },
              {
                "generated": true,
                "index": 1,
                "terms": [
                  {
                    "type": "ref",
                    "value": [
                      {
                        "type": "var",
                        "value": "count"
                      }
                    ]
                  },
                  {
                    "type": "var",
                    "value": "__local46__"
                  },
                  {
                    "type": "var",
                    "value": "__local20__"
                  }
                ]
              },
              {
                "index": 2,
                "terms": [
                  {
                    "type": "ref",
                    "value": [
                      {
                        "type": "var",
                        "value": "gt"
                      }
                    ]
                  },
                  {
                    "type": "var",
                    "value": "__local20__"
                  },
                  {
                    "type": "number",
                    "value": 0
                  }
                ]
              },
              {
                "generated": true,
                "index": 3,
                "terms": [
                  {
                    "type": "ref",
                    "value": [
                      {
                        "type": "var",
                        "value": "eq"
                      }
                    ]
                  },
                  {
                    "type": "var",
                    "value": "__local47__"
                  },
                  {
                    "type": "ref",
                    "value": [
                      {
                        "type": "var",
                        "value": "data"
                      },
                      {
                        "type": "string",
                        "value": "http"
                      },
                      {
                        "type": "string",
                        "value": "request"
                      },
                      {
                        "type": "string",
                        "value": "authz"
                      },
                      {
                        "type": "string",
                        "value": "accessToResourceNotAllowed"
                      }
                    ]
                  }
                ]
              },
              {
                "generated": true,
                "index": 4,
                "terms": [
                  {
                    "type": "ref",
                    "value": [
                      {
                        "type": "var",
                        "value": "concat"
                      }
                    ]
                  },
                  {
                    "type": "string",
                    "value": " | "
                  },
                  {
                    "type": "var",
                    "value": "__local47__"
                  },
                  {
                    "type": "var",
                    "value": "__local19__"
                  }
                ]
              }
            ],
            "else": {
              "head": {
                "name": "status",
                "value": {
                  "type": "object",
                  "value": [
                    [
                      {
                        "type": "string",
                        "value": "allowed"
                      },
                      {
                        "type": "boolean",
                        "value": true
                      }
                    ],
                    [
                      {
                        "type": "string",
                        "value": "reason"
                      },
                      {
                        "type": "string",
                        "value": "Access allowed, all rules passed"
                      }
                    ]
                  ]
                }
              },
              "body": [
                {
                  "index": 0,
                  "terms": {
                    "type": "boolean",
                    "value": true
                  }
                }
              ]
            }
          }
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 39,
          "col": 1
        },
        "QueryID": 3,
        "ParentID": 2,
        "Locals": null,
        "LocalMetadata": {},
        "Message": ""
      },
      {
        "Op": "Enter",
        "Node": {
          "head": {
            "name": "accessToWhitelistAllowed",
            "key": {
              "type": "var",
              "value": "__local4__"
            }
          },
          "body": [
            {
              "generated": true,
              "index": 0,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local41__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "input"
                    },
                    {
                      "type": "string",
                      "value": "path"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 1,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local42__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "whitelistedEndpoints"
                    },
                    {
                      "type": "var",
                      "value": "$0"
                    }
                  ]
                }
              ]
            },
            {
              "index": 2,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "startswith"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local41__"
                },
                {
                  "type": "var",
                  "value": "__local42__"
                }
              ]
            },
            {
              "generated": true,
              "index": 3,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local43__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "input"
                    },
                    {
                      "type": "string",
                      "value": "path"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 4,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "sprintf"
                    }
                  ]
                },
                {
                  "type": "string",
                  "value": "Resource '%v' on whitelist"
                },
                {
                  "type": "array",
                  "value": [
                    {
                      "type": "var",
                      "value": "__local43__"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local16__"
                }
              ]
            },
            {
              "index": 5,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local4__"
                },
                {
                  "type": "var",
                  "value": "__local16__"
                }
              ]
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 34,
          "col": 1
        },
        "QueryID": 4,
        "ParentID": 3,
        "Locals": null,
        "LocalMetadata": {
          "__local4__": {
            "name": "reason",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 34,
              "col": 26
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Fail",
        "Node": {
          "index": 2,
          "terms": [
            {
              "type": "ref",
              "value": [
                {
                  "type": "var",
                  "value": "startswith"
                }
              ]
            },
            {
              "type": "var",
              "value": "__local41__"
            },
            {
              "type": "var",
              "value": "__local42__"
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 35,
          "col": 5
        },
        "QueryID": 4,
        "ParentID": 3,
        "Locals": [
          {
            "name": "__local41__",
            "type": "string",
            "value": "/messages"
          },
          {
            "name": "_",
            "type": "number",
            "value": 0
          },
          {
            "name": "__local42__",
            "type": "string",
            "value": "/ping"
          }
        ],
        "LocalMetadata": {
          "$0": {
            "name": "$0",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 35,
              "col": 49
            }
          },
          "__local41__": {
            "name": "__local41__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 35,
              "col": 16
            }
          },
          "__local42__": {
            "name": "__local42__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 35,
              "col": 28
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Fail",
        "Node": {
          "index": 2,
          "terms": [
            {
              "type": "ref",
              "value": [
                {
                  "type": "var",
                  "value": "startswith"
                }
              ]
            },
            {
              "type": "var",
              "value": "__local41__"
            },
            {
              "type": "var",
              "value": "__local42__"
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 35,
          "col": 5
        },
        "QueryID": 4,
        "ParentID": 3,
        "Locals": [
          {
            "name": "__local41__",
            "type": "string",
            "value": "/messages"
          },
          {
            "name": "_",
            "type": "number",
            "value": 1
          },
          {
            "name": "__local42__",
            "type": "string",
            "value": "/error"
          }
        ],
        "LocalMetadata": {
          "$0": {
            "name": "$0",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 35,
              "col": 49
            }
          },
          "__local41__": {
            "name": "__local41__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 35,
              "col": 16
            }
          },
          "__local42__": {
            "name": "__local42__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 35,
              "col": 28
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Fail",
        "Node": {
          "index": 2,
          "terms": [
            {
              "type": "ref",
              "value": [
                {
                  "type": "var",
                  "value": "startswith"
                }
              ]
            },
            {
              "type": "var",
              "value": "__local41__"
            },
            {
              "type": "var",
              "value": "__local42__"
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 35,
          "col": 5
        },
        "QueryID": 4,
        "ParentID": 3,
        "Locals": [
          {
            "name": "__local41__",
            "type": "string",
            "value": "/messages"
          },
          {
            "name": "_",
            "type": "number",
            "value": 2
          },
          {
            "name": "__local42__",
            "type": "string",
            "value": "/health"
          }
        ],
        "LocalMetadata": {
          "$0": {
            "name": "$0",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 35,
              "col": 49
            }
          },
          "__local41__": {
            "name": "__local41__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 35,
              "col": 16
            }
          },
          "__local42__": {
            "name": "__local42__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 35,
              "col": 28
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Fail",
        "Node": {
          "index": 2,
          "terms": [
            {
              "type": "ref",
              "value": [
                {
                  "type": "var",
                  "value": "gt"
                }
              ]
            },
            {
              "type": "var",
              "value": "__local18__"
            },
            {
              "type": "number",
              "value": 0
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 40,
          "col": 5
        },
        "QueryID": 3,
        "ParentID": 2,
        "Locals": [
          {
            "name": "__local44__",
            "type": "set",
            "value": []
          },
          {
            "name": "__local18__",
            "type": "number",
            "value": 0
          }
        ],
        "LocalMetadata": {
          "__local18__": {
            "name": "__local18__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 40,
              "col": 5
            }
          },
          "__local44__": {
            "name": "__local44__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 40,
              "col": 11
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Enter",
        "Node": {
          "head": {
            "name": "status",
            "value": {
              "type": "object",
              "value": [
                [
                  {
                    "type": "string",
                    "value": "allowed"
                  },
                  {
                    "type": "boolean",
                    "value": false
                  }
                ],
                [
                  {
                    "type": "string",
                    "value": "reason"
                  },
                  {
                    "type": "var",
                    "value": "__local19__"
                  }
                ]
              ]
            }
          },
          "body": [
            {
              "generated": true,
              "index": 0,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local46__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "accessToResourceNotAllowed"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 1,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "count"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local46__"
                },
                {
                  "type": "var",
                  "value": "__local20__"
                }
              ]
            },
            {
              "index": 2,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "gt"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local20__"
                },
                {
                  "type": "number",
                  "value": 0
                }
              ]
            },
            {
              "generated": true,
              "index": 3,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local47__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "accessToResourceNotAllowed"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 4,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "concat"
                    }
                  ]
                },
                {
                  "type": "string",
                  "value": " | "
                },
                {
                  "type": "var",
                  "value": "__local47__"
                },
                {
                  "type": "var",
                  "value": "__local19__"
                }
              ]
            }
          ],
          "else": {
            "head": {
              "name": "status",
              "value": {
                "type": "object",
                "value": [
                  [
                    {
                      "type": "string",
                      "value": "allowed"
                    },
                    {
                      "type": "boolean",
                      "value": true
                    }
                  ],
                  [
                    {
                      "type": "string",
                      "value": "reason"
                    },
                    {
                      "type": "string",
                      "value": "Access allowed, all rules passed"
                    }
                  ]
                ]
              }
            },
            "body": [
              {
                "index": 0,
                "terms": {
                  "type": "boolean",
                  "value": true
                }
              }
            ]
          }
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 41,
          "col": 3
        },
        "QueryID": 6,
        "ParentID": 2,
        "Locals": null,
        "LocalMetadata": {},
        "Message": ""
      },
      {
        "Op": "Enter",
        "Node": {
          "head": {
            "name": "accessToResourceNotAllowed",
            "key": {
              "type": "var",
              "value": "__local0__"
            }
          },
          "body": [
            {
              "index": 0,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "jwtDecoded"
                    }
                  ]
                },
                {
                  "type": "object",
                  "value": []
                }
              ]
            },
            {
              "index": 1,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local0__"
                },
                {
                  "type": "string",
                  "value": "Invalid input, missing JWT"
                }
              ]
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 12,
          "col": 1
        },
        "QueryID": 7,
        "ParentID": 6,
        "Locals": null,
        "LocalMetadata": {
          "__local0__": {
            "name": "reason",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 12,
              "col": 28
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Enter",
        "Node": {
          "head": {
            "name": "jwtDecoded",
            "value": {
              "type": "var",
              "value": "__local5__"
            }
          },
          "body": [
            {
              "generated": true,
              "index": 0,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local48__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "input"
                    },
                    {
                      "type": "string",
                      "value": "encodedJwt"
                    }
                  ]
                }
              ]
            },
            {
              "index": 1,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "neq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local48__"
                },
                {
                  "type": "null",
                  "value": {}
                }
              ]
            },
            {
              "generated": true,
              "index": 2,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local49__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "input"
                    },
                    {
                      "type": "string",
                      "value": "encodedJwt"
                    }
                  ]
                }
              ]
            },
            {
              "index": 3,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "neq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local49__"
                },
                {
                  "type": "string",
                  "value": ""
                }
              ]
            },
            {
              "generated": true,
              "index": 4,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local50__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "input"
                    },
                    {
                      "type": "string",
                      "value": "encodedJwt"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 5,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "io"
                    },
                    {
                      "type": "string",
                      "value": "jwt"
                    },
                    {
                      "type": "string",
                      "value": "decode"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local50__"
                },
                {
                  "type": "var",
                  "value": "__local21__"
                }
              ]
            },
            {
              "index": 6,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local5__"
                },
                {
                  "type": "var",
                  "value": "__local21__"
                }
              ]
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 56,
          "col": 1
        },
        "QueryID": 8,
        "ParentID": 7,
        "Locals": null,
        "LocalMetadata": {
          "__local5__": {
            "name": "jwtd",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 56,
              "col": 14
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Fail",
        "Node": {
          "index": 1,
          "terms": [
            {
              "type": "ref",
              "value": [
                {
                  "type": "var",
                  "value": "neq"
                }
              ]
            },
            {
              "type": "var",
              "value": "__local48__"
            },
            {
              "type": "null",
              "value": {}
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 57,
          "col": 5
        },
        "QueryID": 8,
        "ParentID": 7,
        "Locals": [
          {
            "name": "__local48__",
            "type": "null",
            "value": {}
          }
        ],
        "LocalMetadata": {
          "__local48__": {
            "name": "__local48__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 57,
              "col": 5
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Enter",
        "Node": {
          "head": {
            "name": "accessToResourceNotAllowed",
            "key": {
              "type": "var",
              "value": "__local1__"
            }
          },
          "body": [
            {
              "index": 0,
              "negated": true,
              "terms": {
                "type": "ref",
                "value": [
                  {
                    "type": "var",
                    "value": "input"
                  },
                  {
                    "type": "string",
                    "value": "path"
                  }
                ]
              }
            },
            {
              "index": 1,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local1__"
                },
                {
                  "type": "string",
                  "value": "Invalid input, can't extract path"
                }
              ]
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 17,
          "col": 1
        },
        "QueryID": 10,
        "ParentID": 6,
        "Locals": null,
        "LocalMetadata": {
          "__local1__": {
            "name": "reason",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 17,
              "col": 28
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Fail",
        "Node": {
          "index": 0,
          "negated": true,
          "terms": {
            "type": "ref",
            "value": [
              {
                "type": "var",
                "value": "input"
              },
              {
                "type": "string",
                "value": "path"
              }
            ]
          }
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 18,
          "col": 9
        },
        "QueryID": 10,
        "ParentID": 6,
        "Locals": null,
        "LocalMetadata": {},
        "Message": ""
      },
      {
        "Op": "Enter",
        "Node": {
          "head": {
            "name": "accessToResourceNotAllowed",
            "key": {
              "type": "var",
              "value": "__local2__"
            }
          },
          "body": [
            {
              "generated": true,
              "index": 0,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local31__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "input"
                    },
                    {
                      "type": "string",
                      "value": "path"
                    }
                  ]
                }
              ]
            },
            {
              "index": 1,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "startswith"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local31__"
                },
                {
                  "type": "string",
                  "value": "/messages"
                }
              ]
            },
            {
              "generated": true,
              "index": 2,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local32__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "groupsFromJwt"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 3,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local33__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "allowedGroups"
                    }
                  ]
                }
              ]
            },
            {
              "index": 4,
              "negated": true,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "lists_intersect"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local32__"
                },
                {
                  "type": "var",
                  "value": "__local33__"
                }
              ]
            },
            {
              "generated": true,
              "index": 5,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local34__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "input"
                    },
                    {
                      "type": "string",
                      "value": "path"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 6,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local35__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "allowedGroups"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 7,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "sprintf"
                    }
                  ]
                },
                {
                  "type": "string",
                  "value": "Not allowed to access '%v', required group: '%v'"
                },
                {
                  "type": "array",
                  "value": [
                    {
                      "type": "var",
                      "value": "__local34__"
                    },
                    {
                      "type": "var",
                      "value": "__local35__"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local14__"
                }
              ]
            },
            {
              "index": 8,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local2__"
                },
                {
                  "type": "var",
                  "value": "__local14__"
                }
              ]
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 22,
          "col": 1
        },
        "QueryID": 12,
        "ParentID": 6,
        "Locals": null,
        "LocalMetadata": {
          "__local2__": {
            "name": "reason",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 22,
              "col": 28
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Enter",
        "Node": {
          "head": {
            "name": "groupsFromJwt",
            "value": {
              "type": "var",
              "value": "__local6__"
            }
          },
          "body": [
            {
              "index": 0,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local6__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "jwtDecoded"
                    },
                    {
                      "type": "number",
                      "value": 1
                    },
                    {
                      "type": "string",
                      "value": "odp"
                    },
                    {
                      "type": "string",
                      "value": "groups"
                    }
                  ]
                }
              ]
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 63,
          "col": 1
        },
        "QueryID": 13,
        "ParentID": 12,
        "Locals": null,
        "LocalMetadata": {
          "__local6__": {
            "name": "groups",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 63,
              "col": 17
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Fail",
        "Node": {
          "index": 0,
          "terms": [
            {
              "type": "ref",
              "value": [
                {
                  "type": "var",
                  "value": "eq"
                }
              ]
            },
            {
              "type": "var",
              "value": "__local6__"
            },
            {
              "type": "ref",
              "value": [
                {
                  "type": "var",
                  "value": "data"
                },
                {
                  "type": "string",
                  "value": "http"
                },
                {
                  "type": "string",
                  "value": "request"
                },
                {
                  "type": "string",
                  "value": "authz"
                },
                {
                  "type": "string",
                  "value": "jwtDecoded"
                },
                {
                  "type": "number",
                  "value": 1
                },
                {
                  "type": "string",
                  "value": "odp"
                },
                {
                  "type": "string",
                  "value": "groups"
                }
              ]
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 64,
          "col": 5
        },
        "QueryID": 13,
        "ParentID": 12,
        "Locals": null,
        "LocalMetadata": {
          "__local6__": {
            "name": "groups",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 64,
              "col": 5
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Enter",
        "Node": [
          {
            "index": 0,
            "terms": [
              {
                "type": "ref",
                "value": [
                  {
                    "type": "var",
                    "value": "data"
                  },
                  {
                    "type": "string",
                    "value": "http"
                  },
                  {
                    "type": "string",
                    "value": "request"
                  },
                  {
                    "type": "string",
                    "value": "authz"
                  },
                  {
                    "type": "string",
                    "value": "lists_intersect"
                  }
                ]
              },
              {
                "type": "var",
                "value": "__local32__"
              },
              {
                "type": "var",
                "value": "__local33__"
              }
            ]
          }
        ],
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 24,
          "col": 9
        },
        "QueryID": 16,
        "ParentID": 12,
        "Locals": [
          {
            "name": "__local31__",
            "type": "string",
            "value": "/messages"
          },
          {
            "name": "__local32__",
            "type": "array",
            "value": []
          },
          {
            "name": "__local33__",
            "type": "array",
            "value": [
              {
                "type": "string",
                "value": "sec-ODP-Developer"
              },
              {
                "type": "string",
                "value": "sec-ODP-Data-Controller"
              }
            ]
          }
        ],
        "LocalMetadata": {
          "__local31__": {
            "name": "__local31__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 23,
              "col": 16
            }
          },
          "__local32__": {
            "name": "__local32__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 24,
              "col": 25
            }
          },
          "__local33__": {
            "name": "__local33__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 24,
              "col": 40
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Enter",
        "Node": {
          "head": {
            "name": "lists_intersect",
            "args": [
              {
                "type": "var",
                "value": "list1"
              },
              {
                "type": "var",
                "value": "list2"
              }
            ],
            "value": {
              "type": "boolean",
              "value": true
            }
          },
          "body": [
            {
              "index": 0,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "list1"
                    },
                    {
                      "type": "var",
                      "value": "$2"
                    }
                  ]
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "list2"
                    },
                    {
                      "type": "var",
                      "value": "$3"
                    }
                  ]
                }
              ]
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 75,
          "col": 1
        },
        "QueryID": 17,
        "ParentID": 16,
        "Locals": null,
        "LocalMetadata": {},
        "Message": ""
      },
      {
        "Op": "Fail",
        "Node": {
          "index": 0,
          "terms": [
            {
              "type": "ref",
              "value": [
                {
                  "type": "var",
                  "value": "eq"
                }
              ]
            },
            {
              "type": "ref",
              "value": [
                {
                  "type": "var",
                  "value": "list1"
                },
                {
                  "type": "var",
                  "value": "$2"
                }
              ]
            },
            {
              "type": "ref",
              "value": [
                {
                  "type": "var",
                  "value": "list2"
                },
                {
                  "type": "var",
                  "value": "$3"
                }
              ]
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 76,
          "col": 5
        },
        "QueryID": 17,
        "ParentID": 16,
        "Locals": [
          {
            "name": "list1",
            "type": "array",
            "value": []
          },
          {
            "name": "list2",
            "type": "array",
            "value": [
              {
                "type": "string",
                "value": "sec-ODP-Developer"
              },
              {
                "type": "string",
                "value": "sec-ODP-Data-Controller"
              }
            ]
          }
        ],
        "LocalMetadata": {
          "list1": {
            "name": "list1",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 75,
              "col": 17
            }
          },
          "list2": {
            "name": "list2",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 75,
              "col": 24
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Fail",
        "Node": {
          "index": 0,
          "terms": [
            {
              "type": "ref",
              "value": [
                {
                  "type": "var",
                  "value": "data"
                },
                {
                  "type": "string",
                  "value": "http"
                },
                {
                  "type": "string",
                  "value": "request"
                },
                {
                  "type": "string",
                  "value": "authz"
                },
                {
                  "type": "string",
                  "value": "lists_intersect"
                }
              ]
            },
            {
              "type": "var",
              "value": "__local32__"
            },
            {
              "type": "var",
              "value": "__local33__"
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 24,
          "col": 9
        },
        "QueryID": 16,
        "ParentID": 12,
        "Locals": [
          {
            "name": "__local31__",
            "type": "string",
            "value": "/messages"
          },
          {
            "name": "__local32__",
            "type": "array",
            "value": []
          },
          {
            "name": "__local33__",
            "type": "array",
            "value": [
              {
                "type": "string",
                "value": "sec-ODP-Developer"
              },
              {
                "type": "string",
                "value": "sec-ODP-Data-Controller"
              }
            ]
          }
        ],
        "LocalMetadata": {
          "__local31__": {
            "name": "__local31__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 23,
              "col": 16
            }
          },
          "__local32__": {
            "name": "__local32__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 24,
              "col": 25
            }
          },
          "__local33__": {
            "name": "__local33__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 24,
              "col": 40
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Enter",
        "Node": {
          "head": {
            "name": "accessToResourceNotAllowed",
            "key": {
              "type": "var",
              "value": "__local3__"
            }
          },
          "body": [
            {
              "generated": true,
              "index": 0,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local36__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "input"
                    },
                    {
                      "type": "string",
                      "value": "path"
                    }
                  ]
                }
              ]
            },
            {
              "index": 1,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "startswith"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local36__"
                },
                {
                  "type": "string",
                  "value": "/statistics"
                }
              ]
            },
            {
              "generated": true,
              "index": 2,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local37__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "groupsFromJwt"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 3,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local38__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "allowedGroups"
                    }
                  ]
                }
              ]
            },
            {
              "index": 4,
              "negated": true,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "lists_intersect"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local37__"
                },
                {
                  "type": "var",
                  "value": "__local38__"
                }
              ]
            },
            {
              "generated": true,
              "index": 5,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local39__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "input"
                    },
                    {
                      "type": "string",
                      "value": "path"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 6,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local40__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "allowedGroups"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 7,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "sprintf"
                    }
                  ]
                },
                {
                  "type": "string",
                  "value": "Not allowed to access '%v', required group: '%v'"
                },
                {
                  "type": "array",
                  "value": [
                    {
                      "type": "var",
                      "value": "__local39__"
                    },
                    {
                      "type": "var",
                      "value": "__local40__"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local15__"
                }
              ]
            },
            {
              "index": 8,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local3__"
                },
                {
                  "type": "var",
                  "value": "__local15__"
                }
              ]
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 28,
          "col": 1
        },
        "QueryID": 18,
        "ParentID": 6,
        "Locals": null,
        "LocalMetadata": {
          "__local3__": {
            "name": "reason",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 28,
              "col": 28
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Fail",
        "Node": {
          "index": 1,
          "terms": [
            {
              "type": "ref",
              "value": [
                {
                  "type": "var",
                  "value": "startswith"
                }
              ]
            },
            {
              "type": "var",
              "value": "__local36__"
            },
            {
              "type": "string",
              "value": "/statistics"
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 29,
          "col": 5
        },
        "QueryID": 18,
        "ParentID": 6,
        "Locals": [
          {
            "name": "__local36__",
            "type": "string",
            "value": "/messages"
          }
        ],
        "LocalMetadata": {
          "__local36__": {
            "name": "__local36__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 29,
              "col": 16
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Enter",
        "Node": {
          "head": {
            "name": "accessToResourceNotAllowed",
            "key": {
              "type": "var",
              "value": "__local1__"
            }
          },
          "body": [
            {
              "index": 0,
              "negated": true,
              "terms": {
                "type": "ref",
                "value": [
                  {
                    "type": "var",
                    "value": "input"
                  },
                  {
                    "type": "string",
                    "value": "path"
                  }
                ]
              }
            },
            {
              "index": 1,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local1__"
                },
                {
                  "type": "string",
                  "value": "Invalid input, can't extract path"
                }
              ]
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 17,
          "col": 1
        },
        "QueryID": 20,
        "ParentID": 6,
        "Locals": null,
        "LocalMetadata": {
          "__local1__": {
            "name": "reason",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 17,
              "col": 28
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Fail",
        "Node": {
          "index": 0,
          "negated": true,
          "terms": {
            "type": "ref",
            "value": [
              {
                "type": "var",
                "value": "input"
              },
              {
                "type": "string",
                "value": "path"
              }
            ]
          }
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 18,
          "col": 9
        },
        "QueryID": 20,
        "ParentID": 6,
        "Locals": null,
        "LocalMetadata": {},
        "Message": ""
      },
      {
        "Op": "Enter",
        "Node": {
          "head": {
            "name": "accessToResourceNotAllowed",
            "key": {
              "type": "var",
              "value": "__local2__"
            }
          },
          "body": [
            {
              "generated": true,
              "index": 0,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local31__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "input"
                    },
                    {
                      "type": "string",
                      "value": "path"
                    }
                  ]
                }
              ]
            },
            {
              "index": 1,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "startswith"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local31__"
                },
                {
                  "type": "string",
                  "value": "/messages"
                }
              ]
            },
            {
              "generated": true,
              "index": 2,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local32__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "groupsFromJwt"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 3,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local33__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "allowedGroups"
                    }
                  ]
                }
              ]
            },
            {
              "index": 4,
              "negated": true,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "lists_intersect"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local32__"
                },
                {
                  "type": "var",
                  "value": "__local33__"
                }
              ]
            },
            {
              "generated": true,
              "index": 5,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local34__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "input"
                    },
                    {
                      "type": "string",
                      "value": "path"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 6,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local35__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "allowedGroups"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 7,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "sprintf"
                    }
                  ]
                },
                {
                  "type": "string",
                  "value": "Not allowed to access '%v', required group: '%v'"
                },
                {
                  "type": "array",
                  "value": [
                    {
                      "type": "var",
                      "value": "__local34__"
                    },
                    {
                      "type": "var",
                      "value": "__local35__"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local14__"
                }
              ]
            },
            {
              "index": 8,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local2__"
                },
                {
                  "type": "var",
                  "value": "__local14__"
                }
              ]
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 22,
          "col": 1
        },
        "QueryID": 22,
        "ParentID": 6,
        "Locals": null,
        "LocalMetadata": {
          "__local2__": {
            "name": "reason",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 22,
              "col": 28
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Enter",
        "Node": [
          {
            "index": 0,
            "terms": [
              {
                "type": "ref",
                "value": [
                  {
                    "type": "var",
                    "value": "data"
                  },
                  {
                    "type": "string",
                    "value": "http"
                  },
                  {
                    "type": "string",
                    "value": "request"
                  },
                  {
                    "type": "string",
                    "value": "authz"
                  },
                  {
                    "type": "string",
                    "value": "lists_intersect"
                  }
                ]
              },
              {
                "type": "var",
                "value": "__local32__"
              },
              {
                "type": "var",
                "value": "__local33__"
              }
            ]
          }
        ],
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 24,
          "col": 9
        },
        "QueryID": 23,
        "ParentID": 22,
        "Locals": [
          {
            "name": "__local31__",
            "type": "string",
            "value": "/messages"
          },
          {
            "name": "__local32__",
            "type": "array",
            "value": []
          },
          {
            "name": "__local33__",
            "type": "array",
            "value": [
              {
                "type": "string",
                "value": "sec-ODP-Developer"
              },
              {
                "type": "string",
                "value": "sec-ODP-Data-Controller"
              }
            ]
          }
        ],
        "LocalMetadata": {
          "__local31__": {
            "name": "__local31__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 23,
              "col": 16
            }
          },
          "__local32__": {
            "name": "__local32__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 24,
              "col": 25
            }
          },
          "__local33__": {
            "name": "__local33__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 24,
              "col": 40
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Enter",
        "Node": {
          "head": {
            "name": "lists_intersect",
            "args": [
              {
                "type": "var",
                "value": "list1"
              },
              {
                "type": "var",
                "value": "list2"
              }
            ],
            "value": {
              "type": "boolean",
              "value": true
            }
          },
          "body": [
            {
              "index": 0,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "list1"
                    },
                    {
                      "type": "var",
                      "value": "$2"
                    }
                  ]
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "list2"
                    },
                    {
                      "type": "var",
                      "value": "$3"
                    }
                  ]
                }
              ]
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 75,
          "col": 1
        },
        "QueryID": 24,
        "ParentID": 23,
        "Locals": null,
        "LocalMetadata": {},
        "Message": ""
      },
      {
        "Op": "Fail",
        "Node": {
          "index": 0,
          "terms": [
            {
              "type": "ref",
              "value": [
                {
                  "type": "var",
                  "value": "eq"
                }
              ]
            },
            {
              "type": "ref",
              "value": [
                {
                  "type": "var",
                  "value": "list1"
                },
                {
                  "type": "var",
                  "value": "$2"
                }
              ]
            },
            {
              "type": "ref",
              "value": [
                {
                  "type": "var",
                  "value": "list2"
                },
                {
                  "type": "var",
                  "value": "$3"
                }
              ]
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 76,
          "col": 5
        },
        "QueryID": 24,
        "ParentID": 23,
        "Locals": [
          {
            "name": "list1",
            "type": "array",
            "value": []
          },
          {
            "name": "list2",
            "type": "array",
            "value": [
              {
                "type": "string",
                "value": "sec-ODP-Developer"
              },
              {
                "type": "string",
                "value": "sec-ODP-Data-Controller"
              }
            ]
          }
        ],
        "LocalMetadata": {
          "list1": {
            "name": "list1",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 75,
              "col": 17
            }
          },
          "list2": {
            "name": "list2",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 75,
              "col": 24
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Fail",
        "Node": {
          "index": 0,
          "terms": [
            {
              "type": "ref",
              "value": [
                {
                  "type": "var",
                  "value": "data"
                },
                {
                  "type": "string",
                  "value": "http"
                },
                {
                  "type": "string",
                  "value": "request"
                },
                {
                  "type": "string",
                  "value": "authz"
                },
                {
                  "type": "string",
                  "value": "lists_intersect"
                }
              ]
            },
            {
              "type": "var",
              "value": "__local32__"
            },
            {
              "type": "var",
              "value": "__local33__"
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 24,
          "col": 9
        },
        "QueryID": 23,
        "ParentID": 22,
        "Locals": [
          {
            "name": "__local33__",
            "type": "array",
            "value": [
              {
                "type": "string",
                "value": "sec-ODP-Developer"
              },
              {
                "type": "string",
                "value": "sec-ODP-Data-Controller"
              }
            ]
          },
          {
            "name": "__local31__",
            "type": "string",
            "value": "/messages"
          },
          {
            "name": "__local32__",
            "type": "array",
            "value": []
          }
        ],
        "LocalMetadata": {
          "__local31__": {
            "name": "__local31__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 23,
              "col": 16
            }
          },
          "__local32__": {
            "name": "__local32__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 24,
              "col": 25
            }
          },
          "__local33__": {
            "name": "__local33__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 24,
              "col": 40
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Enter",
        "Node": {
          "head": {
            "name": "accessToResourceNotAllowed",
            "key": {
              "type": "var",
              "value": "__local3__"
            }
          },
          "body": [
            {
              "generated": true,
              "index": 0,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local36__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "input"
                    },
                    {
                      "type": "string",
                      "value": "path"
                    }
                  ]
                }
              ]
            },
            {
              "index": 1,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "startswith"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local36__"
                },
                {
                  "type": "string",
                  "value": "/statistics"
                }
              ]
            },
            {
              "generated": true,
              "index": 2,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local37__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "groupsFromJwt"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 3,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local38__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "allowedGroups"
                    }
                  ]
                }
              ]
            },
            {
              "index": 4,
              "negated": true,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "lists_intersect"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local37__"
                },
                {
                  "type": "var",
                  "value": "__local38__"
                }
              ]
            },
            {
              "generated": true,
              "index": 5,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local39__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "input"
                    },
                    {
                      "type": "string",
                      "value": "path"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 6,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local40__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "allowedGroups"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 7,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "sprintf"
                    }
                  ]
                },
                {
                  "type": "string",
                  "value": "Not allowed to access '%v', required group: '%v'"
                },
                {
                  "type": "array",
                  "value": [
                    {
                      "type": "var",
                      "value": "__local39__"
                    },
                    {
                      "type": "var",
                      "value": "__local40__"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local15__"
                }
              ]
            },
            {
              "index": 8,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local3__"
                },
                {
                  "type": "var",
                  "value": "__local15__"
                }
              ]
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 28,
          "col": 1
        },
        "QueryID": 25,
        "ParentID": 6,
        "Locals": null,
        "LocalMetadata": {
          "__local3__": {
            "name": "reason",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 28,
              "col": 28
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Fail",
        "Node": {
          "index": 1,
          "terms": [
            {
              "type": "ref",
              "value": [
                {
                  "type": "var",
                  "value": "startswith"
                }
              ]
            },
            {
              "type": "var",
              "value": "__local36__"
            },
            {
              "type": "string",
              "value": "/statistics"
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 29,
          "col": 5
        },
        "QueryID": 25,
        "ParentID": 6,
        "Locals": [
          {
            "name": "__local36__",
            "type": "string",
            "value": "/messages"
          }
        ],
        "LocalMetadata": {
          "__local36__": {
            "name": "__local36__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 29,
              "col": 16
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Fail",
        "Node": {
          "index": 0,
          "terms": {
            "type": "ref",
            "value": [
              {
                "type": "var",
                "value": "data"
              },
              {
                "type": "string",
                "value": "http"
              },
              {
                "type": "string",
                "value": "request"
              },
              {
                "type": "string",
                "value": "authz"
              },
              {
                "type": "string",
                "value": "allow"
              }
            ]
          },
          "with": [
            {
              "target": {
                "type": "ref",
                "value": [
                  {
                    "type": "var",
                    "value": "input"
                  }
                ]
              },
              "value": {
                "type": "object",
                "value": [
                  [
                    {
                      "type": "string",
                      "value": "encodedJwt"
                    },
                    {
                      "type": "null",
                      "value": {}
                    }
                  ],
                  [
                    {
                      "type": "string",
                      "value": "path"
                    },
                    {
                      "type": "string",
                      "value": "/messages"
                    }
                  ]
                ]
              }
            }
          ]
        },
        "Location": {
          "file": "src/test/resources/opa/policies/policies-test.rego",
          "row": 17,
          "col": 5
        },
        "QueryID": 1,
        "ParentID": 0,
        "Locals": null,
        "LocalMetadata": {},
        "Message": ""
      },
      {
        "Op": "Fail",
        "Node": {
          "index": 0,
          "terms": [
            {
              "type": "ref",
              "value": [
                {
                  "type": "var",
                  "value": "eq"
                }
              ]
            },
            {
              "type": "ref",
              "value": [
                {
                  "type": "var",
                  "value": "data"
                },
                {
                  "type": "string",
                  "value": "http"
                },
                {
                  "type": "string",
                  "value": "request"
                },
                {
                  "type": "string",
                  "value": "authz"
                },
                {
                  "type": "string",
                  "value": "test_not_allow_if_without_jwt"
                }
              ]
            },
            {
              "type": "var",
              "value": "$term1"
            }
          ]
        },
        "Location": {
          "file": "",
          "row": 1,
          "col": 1
        },
        "QueryID": 0,
        "ParentID": 0,
        "Locals": null,
        "LocalMetadata": {},
        "Message": ""
      }
    ]
  },
  {
    "location": {
      "file": "src/test/resources/opa/policies/policies-test.rego",
      "row": 20,
      "col": 1
    },
    "package": "data.http.request.authz",
    "name": "test_not_allow_if_without_jwt#01",
    "duration": 1187468,
    "trace": [
      {
        "Op": "Enter",
        "Node": [
          {
            "index": 0,
            "terms": [
              {
                "type": "ref",
                "value": [
                  {
                    "type": "var",
                    "value": "eq"
                  }
                ]
              },
              {
                "type": "ref",
                "value": [
                  {
                    "type": "var",
                    "value": "data"
                  },
                  {
                    "type": "string",
                    "value": "http"
                  },
                  {
                    "type": "string",
                    "value": "request"
                  },
                  {
                    "type": "string",
                    "value": "authz"
                  },
                  {
                    "type": "string",
                    "value": "test_not_allow_if_without_jwt#01"
                  }
                ]
              },
              {
                "type": "var",
                "value": "$term1"
              }
            ]
          }
        ],
        "Location": {
          "file": "",
          "row": 1,
          "col": 1
        },
        "QueryID": 0,
        "ParentID": 0,
        "Locals": null,
        "LocalMetadata": {},
        "Message": ""
      },
      {
        "Op": "Enter",
        "Node": {
          "head": {
            "name": "test_not_allow_if_without_jwt#01",
            "value": {
              "type": "boolean",
              "value": true
            }
          },
          "body": [
            {
              "index": 0,
              "negated": true,
              "terms": {
                "type": "ref",
                "value": [
                  {
                    "type": "var",
                    "value": "data"
                  },
                  {
                    "type": "string",
                    "value": "http"
                  },
                  {
                    "type": "string",
                    "value": "request"
                  },
                  {
                    "type": "string",
                    "value": "authz"
                  },
                  {
                    "type": "string",
                    "value": "allow"
                  }
                ]
              },
              "with": [
                {
                  "target": {
                    "type": "ref",
                    "value": [
                      {
                        "type": "var",
                        "value": "input"
                      }
                    ]
                  },
                  "value": {
                    "type": "object",
                    "value": [
                      [
                        {
                          "type": "string",
                          "value": "encodedJwt"
                        },
                        {
                          "type": "string",
                          "value": ""
                        }
                      ],
                      [
                        {
                          "type": "string",
                          "value": "path"
                        },
                        {
                          "type": "string",
                          "value": "/messages"
                        }
                      ]
                    ]
                  }
                }
              ]
            }
          ]
        },
        "Location": {
          "file": "src/test/resources/opa/policies/policies-test.rego",
          "row": 20,
          "col": 1
        },
        "QueryID": 1,
        "ParentID": 0,
        "Locals": null,
        "LocalMetadata": {},
        "Message": ""
      },
      {
        "Op": "Enter",
        "Node": [
          {
            "index": 0,
            "terms": {
              "type": "ref",
              "value": [
                {
                  "type": "var",
                  "value": "data"
                },
                {
                  "type": "string",
                  "value": "http"
                },
                {
                  "type": "string",
                  "value": "request"
                },
                {
                  "type": "string",
                  "value": "authz"
                },
                {
                  "type": "string",
                  "value": "allow"
                }
              ]
            }
          }
        ],
        "Location": {
          "file": "src/test/resources/opa/policies/policies-test.rego",
          "row": 21,
          "col": 9
        },
        "QueryID": 2,
        "ParentID": 1,
        "Locals": null,
        "LocalMetadata": {},
        "Message": ""
      },
      {
        "Op": "Enter",
        "Node": {
          "head": {
            "name": "allow",
            "value": {
              "type": "var",
              "value": "__local29__"
            }
          },
          "body": [
            {
              "index": 0,
              "terms": {
                "type": "boolean",
                "value": true
              }
            },
            {
              "generated": true,
              "index": 1,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local29__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "status"
                    },
                    {
                      "type": "string",
                      "value": "allowed"
                    }
                  ]
                }
              ]
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 47,
          "col": 9
        },
        "QueryID": 3,
        "ParentID": 2,
        "Locals": null,
        "LocalMetadata": {},
        "Message": ""
      },
      {
        "Op": "Enter",
        "Node": {
          "head": {
            "name": "status",
            "value": {
              "type": "object",
              "value": [
                [
                  {
                    "type": "string",
                    "value": "allowed"
                  },
                  {
                    "type": "boolean",
                    "value": true
                  }
                ],
                [
                  {
                    "type": "string",
                    "value": "reason"
                  },
                  {
                    "type": "var",
                    "value": "__local17__"
                  }
                ]
              ]
            }
          },
          "body": [
            {
              "generated": true,
              "index": 0,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local44__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "accessToWhitelistAllowed"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 1,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "count"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local44__"
                },
                {
                  "type": "var",
                  "value": "__local18__"
                }
              ]
            },
            {
              "index": 2,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "gt"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local18__"
                },
                {
                  "type": "number",
                  "value": 0
                }
              ]
            },
            {
              "generated": true,
              "index": 3,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local45__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "accessToWhitelistAllowed"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 4,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "concat"
                    }
                  ]
                },
                {
                  "type": "string",
                  "value": " | "
                },
                {
                  "type": "var",
                  "value": "__local45__"
                },
                {
                  "type": "var",
                  "value": "__local17__"
                }
              ]
            }
          ],
          "else": {
            "head": {
              "name": "status",
              "value": {
                "type": "object",
                "value": [
                  [
                    {
                      "type": "string",
                      "value": "allowed"
                    },
                    {
                      "type": "boolean",
                      "value": false
                    }
                  ],
                  [
                    {
                      "type": "string",
                      "value": "reason"
                    },
                    {
                      "type": "var",
                      "value": "__local19__"
                    }
                  ]
                ]
              }
            },
            "body": [
              {
                "generated": true,
                "index": 0,
                "terms": [
                  {
                    "type": "ref",
                    "value": [
                      {
                        "type": "var",
                        "value": "eq"
                      }
                    ]
                  },
                  {
                    "type": "var",
                    "value": "__local46__"
                  },
                  {
                    "type": "ref",
                    "value": [
                      {
                        "type": "var",
                        "value": "data"
                      },
                      {
                        "type": "string",
                        "value": "http"
                      },
                      {
                        "type": "string",
                        "value": "request"
                      },
                      {
                        "type": "string",
                        "value": "authz"
                      },
                      {
                        "type": "string",
                        "value": "accessToResourceNotAllowed"
                      }
                    ]
                  }
                ]
              },
              {
                "generated": true,
                "index": 1,
                "terms": [
                  {
                    "type": "ref",
                    "value": [
                      {
                        "type": "var",
                        "value": "count"
                      }
                    ]
                  },
                  {
                    "type": "var",
                    "value": "__local46__"
                  },
                  {
                    "type": "var",
                    "value": "__local20__"
                  }
                ]
              },
              {
                "index": 2,
                "terms": [
                  {
                    "type": "ref",
                    "value": [
                      {
                        "type": "var",
                        "value": "gt"
                      }
                    ]
                  },
                  {
                    "type": "var",
                    "value": "__local20__"
                  },
                  {
                    "type": "number",
                    "value": 0
                  }
                ]
              },
              {
                "generated": true,
                "index": 3,
                "terms": [
                  {
                    "type": "ref",
                    "value": [
                      {
                        "type": "var",
                        "value": "eq"
                      }
                    ]
                  },
                  {
                    "type": "var",
                    "value": "__local47__"
                  },
                  {
                    "type": "ref",
                    "value": [
                      {
                        "type": "var",
                        "value": "data"
                      },
                      {
                        "type": "string",
                        "value": "http"
                      },
                      {
                        "type": "string",
                        "value": "request"
                      },
                      {
                        "type": "string",
                        "value": "authz"
                      },
                      {
                        "type": "string",
                        "value": "accessToResourceNotAllowed"
                      }
                    ]
                  }
                ]
              },
              {
                "generated": true,
                "index": 4,
                "terms": [
                  {
                    "type": "ref",
                    "value": [
                      {
                        "type": "var",
                        "value": "concat"
                      }
                    ]
                  },
                  {
                    "type": "string",
                    "value": " | "
                  },
                  {
                    "type": "var",
                    "value": "__local47__"
                  },
                  {
                    "type": "var",
                    "value": "__local19__"
                  }
                ]
              }
            ],
            "else": {
              "head": {
                "name": "status",
                "value": {
                  "type": "object",
                  "value": [
                    [
                      {
                        "type": "string",
                        "value": "allowed"
                      },
                      {
                        "type": "boolean",
                        "value": true
                      }
                    ],
                    [
                      {
                        "type": "string",
                        "value": "reason"
                      },
                      {
                        "type": "string",
                        "value": "Access allowed, all rules passed"
                      }
                    ]
                  ]
                }
              },
              "body": [
                {
                  "index": 0,
                  "terms": {
                    "type": "boolean",
                    "value": true
                  }
                }
              ]
            }
          }
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 39,
          "col": 1
        },
        "QueryID": 4,
        "ParentID": 3,
        "Locals": null,
        "LocalMetadata": {},
        "Message": ""
      },
      {
        "Op": "Enter",
        "Node": {
          "head": {
            "name": "accessToWhitelistAllowed",
            "key": {
              "type": "var",
              "value": "__local4__"
            }
          },
          "body": [
            {
              "generated": true,
              "index": 0,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local41__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "input"
                    },
                    {
                      "type": "string",
                      "value": "path"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 1,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local42__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "whitelistedEndpoints"
                    },
                    {
                      "type": "var",
                      "value": "$0"
                    }
                  ]
                }
              ]
            },
            {
              "index": 2,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "startswith"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local41__"
                },
                {
                  "type": "var",
                  "value": "__local42__"
                }
              ]
            },
            {
              "generated": true,
              "index": 3,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local43__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "input"
                    },
                    {
                      "type": "string",
                      "value": "path"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 4,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "sprintf"
                    }
                  ]
                },
                {
                  "type": "string",
                  "value": "Resource '%v' on whitelist"
                },
                {
                  "type": "array",
                  "value": [
                    {
                      "type": "var",
                      "value": "__local43__"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local16__"
                }
              ]
            },
            {
              "index": 5,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local4__"
                },
                {
                  "type": "var",
                  "value": "__local16__"
                }
              ]
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 34,
          "col": 1
        },
        "QueryID": 5,
        "ParentID": 4,
        "Locals": null,
        "LocalMetadata": {
          "__local4__": {
            "name": "reason",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 34,
              "col": 26
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Fail",
        "Node": {
          "index": 2,
          "terms": [
            {
              "type": "ref",
              "value": [
                {
                  "type": "var",
                  "value": "startswith"
                }
              ]
            },
            {
              "type": "var",
              "value": "__local41__"
            },
            {
              "type": "var",
              "value": "__local42__"
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 35,
          "col": 5
        },
        "QueryID": 5,
        "ParentID": 4,
        "Locals": [
          {
            "name": "__local41__",
            "type": "string",
            "value": "/messages"
          },
          {
            "name": "_",
            "type": "number",
            "value": 0
          },
          {
            "name": "__local42__",
            "type": "string",
            "value": "/ping"
          }
        ],
        "LocalMetadata": {
          "$0": {
            "name": "$0",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 35,
              "col": 49
            }
          },
          "__local41__": {
            "name": "__local41__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 35,
              "col": 16
            }
          },
          "__local42__": {
            "name": "__local42__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 35,
              "col": 28
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Fail",
        "Node": {
          "index": 2,
          "terms": [
            {
              "type": "ref",
              "value": [
                {
                  "type": "var",
                  "value": "startswith"
                }
              ]
            },
            {
              "type": "var",
              "value": "__local41__"
            },
            {
              "type": "var",
              "value": "__local42__"
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 35,
          "col": 5
        },
        "QueryID": 5,
        "ParentID": 4,
        "Locals": [
          {
            "name": "__local41__",
            "type": "string",
            "value": "/messages"
          },
          {
            "name": "_",
            "type": "number",
            "value": 1
          },
          {
            "name": "__local42__",
            "type": "string",
            "value": "/error"
          }
        ],
        "LocalMetadata": {
          "$0": {
            "name": "$0",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 35,
              "col": 49
            }
          },
          "__local41__": {
            "name": "__local41__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 35,
              "col": 16
            }
          },
          "__local42__": {
            "name": "__local42__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 35,
              "col": 28
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Fail",
        "Node": {
          "index": 2,
          "terms": [
            {
              "type": "ref",
              "value": [
                {
                  "type": "var",
                  "value": "startswith"
                }
              ]
            },
            {
              "type": "var",
              "value": "__local41__"
            },
            {
              "type": "var",
              "value": "__local42__"
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 35,
          "col": 5
        },
        "QueryID": 5,
        "ParentID": 4,
        "Locals": [
          {
            "name": "__local41__",
            "type": "string",
            "value": "/messages"
          },
          {
            "name": "_",
            "type": "number",
            "value": 2
          },
          {
            "name": "__local42__",
            "type": "string",
            "value": "/health"
          }
        ],
        "LocalMetadata": {
          "$0": {
            "name": "$0",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 35,
              "col": 49
            }
          },
          "__local41__": {
            "name": "__local41__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 35,
              "col": 16
            }
          },
          "__local42__": {
            "name": "__local42__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 35,
              "col": 28
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Fail",
        "Node": {
          "index": 2,
          "terms": [
            {
              "type": "ref",
              "value": [
                {
                  "type": "var",
                  "value": "gt"
                }
              ]
            },
            {
              "type": "var",
              "value": "__local18__"
            },
            {
              "type": "number",
              "value": 0
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 40,
          "col": 5
        },
        "QueryID": 4,
        "ParentID": 3,
        "Locals": [
          {
            "name": "__local44__",
            "type": "set",
            "value": []
          },
          {
            "name": "__local18__",
            "type": "number",
            "value": 0
          }
        ],
        "LocalMetadata": {
          "__local18__": {
            "name": "__local18__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 40,
              "col": 5
            }
          },
          "__local44__": {
            "name": "__local44__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 40,
              "col": 11
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Enter",
        "Node": {
          "head": {
            "name": "status",
            "value": {
              "type": "object",
              "value": [
                [
                  {
                    "type": "string",
                    "value": "allowed"
                  },
                  {
                    "type": "boolean",
                    "value": false
                  }
                ],
                [
                  {
                    "type": "string",
                    "value": "reason"
                  },
                  {
                    "type": "var",
                    "value": "__local19__"
                  }
                ]
              ]
            }
          },
          "body": [
            {
              "generated": true,
              "index": 0,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local46__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "accessToResourceNotAllowed"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 1,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "count"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local46__"
                },
                {
                  "type": "var",
                  "value": "__local20__"
                }
              ]
            },
            {
              "index": 2,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "gt"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local20__"
                },
                {
                  "type": "number",
                  "value": 0
                }
              ]
            },
            {
              "generated": true,
              "index": 3,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local47__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "accessToResourceNotAllowed"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 4,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "concat"
                    }
                  ]
                },
                {
                  "type": "string",
                  "value": " | "
                },
                {
                  "type": "var",
                  "value": "__local47__"
                },
                {
                  "type": "var",
                  "value": "__local19__"
                }
              ]
            }
          ],
          "else": {
            "head": {
              "name": "status",
              "value": {
                "type": "object",
                "value": [
                  [
                    {
                      "type": "string",
                      "value": "allowed"
                    },
                    {
                      "type": "boolean",
                      "value": true
                    }
                  ],
                  [
                    {
                      "type": "string",
                      "value": "reason"
                    },
                    {
                      "type": "string",
                      "value": "Access allowed, all rules passed"
                    }
                  ]
                ]
              }
            },
            "body": [
              {
                "index": 0,
                "terms": {
                  "type": "boolean",
                  "value": true
                }
              }
            ]
          }
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 41,
          "col": 3
        },
        "QueryID": 7,
        "ParentID": 3,
        "Locals": null,
        "LocalMetadata": {},
        "Message": ""
      },
      {
        "Op": "Enter",
        "Node": {
          "head": {
            "name": "accessToResourceNotAllowed",
            "key": {
              "type": "var",
              "value": "__local0__"
            }
          },
          "body": [
            {
              "index": 0,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "jwtDecoded"
                    }
                  ]
                },
                {
                  "type": "object",
                  "value": []
                }
              ]
            },
            {
              "index": 1,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local0__"
                },
                {
                  "type": "string",
                  "value": "Invalid input, missing JWT"
                }
              ]
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 12,
          "col": 1
        },
        "QueryID": 8,
        "ParentID": 7,
        "Locals": null,
        "LocalMetadata": {
          "__local0__": {
            "name": "reason",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 12,
              "col": 28
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Enter",
        "Node": {
          "head": {
            "name": "jwtDecoded",
            "value": {
              "type": "var",
              "value": "__local5__"
            }
          },
          "body": [
            {
              "generated": true,
              "index": 0,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local48__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "input"
                    },
                    {
                      "type": "string",
                      "value": "encodedJwt"
                    }
                  ]
                }
              ]
            },
            {
              "index": 1,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "neq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local48__"
                },
                {
                  "type": "null",
                  "value": {}
                }
              ]
            },
            {
              "generated": true,
              "index": 2,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local49__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "input"
                    },
                    {
                      "type": "string",
                      "value": "encodedJwt"
                    }
                  ]
                }
              ]
            },
            {
              "index": 3,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "neq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local49__"
                },
                {
                  "type": "string",
                  "value": ""
                }
              ]
            },
            {
              "generated": true,
              "index": 4,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local50__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "input"
                    },
                    {
                      "type": "string",
                      "value": "encodedJwt"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 5,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "io"
                    },
                    {
                      "type": "string",
                      "value": "jwt"
                    },
                    {
                      "type": "string",
                      "value": "decode"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local50__"
                },
                {
                  "type": "var",
                  "value": "__local21__"
                }
              ]
            },
            {
              "index": 6,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local5__"
                },
                {
                  "type": "var",
                  "value": "__local21__"
                }
              ]
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 56,
          "col": 1
        },
        "QueryID": 9,
        "ParentID": 8,
        "Locals": null,
        "LocalMetadata": {
          "__local5__": {
            "name": "jwtd",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 56,
              "col": 14
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Fail",
        "Node": {
          "index": 3,
          "terms": [
            {
              "type": "ref",
              "value": [
                {
                  "type": "var",
                  "value": "neq"
                }
              ]
            },
            {
              "type": "var",
              "value": "__local49__"
            },
            {
              "type": "string",
              "value": ""
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 58,
          "col": 5
        },
        "QueryID": 9,
        "ParentID": 8,
        "Locals": [
          {
            "name": "__local48__",
            "type": "string",
            "value": ""
          },
          {
            "name": "__local49__",
            "type": "string",
            "value": ""
          }
        ],
        "LocalMetadata": {
          "__local48__": {
            "name": "__local48__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 57,
              "col": 5
            }
          },
          "__local49__": {
            "name": "__local49__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 58,
              "col": 5
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Enter",
        "Node": {
          "head": {
            "name": "accessToResourceNotAllowed",
            "key": {
              "type": "var",
              "value": "__local1__"
            }
          },
          "body": [
            {
              "index": 0,
              "negated": true,
              "terms": {
                "type": "ref",
                "value": [
                  {
                    "type": "var",
                    "value": "input"
                  },
                  {
                    "type": "string",
                    "value": "path"
                  }
                ]
              }
            },
            {
              "index": 1,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local1__"
                },
                {
                  "type": "string",
                  "value": "Invalid input, can't extract path"
                }
              ]
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 17,
          "col": 1
        },
        "QueryID": 11,
        "ParentID": 7,
        "Locals": null,
        "LocalMetadata": {
          "__local1__": {
            "name": "reason",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 17,
              "col": 28
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Fail",
        "Node": {
          "index": 0,
          "negated": true,
          "terms": {
            "type": "ref",
            "value": [
              {
                "type": "var",
                "value": "input"
              },
              {
                "type": "string",
                "value": "path"
              }
            ]
          }
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 18,
          "col": 9
        },
        "QueryID": 11,
        "ParentID": 7,
        "Locals": null,
        "LocalMetadata": {},
        "Message": ""
      },
      {
        "Op": "Enter",
        "Node": {
          "head": {
            "name": "accessToResourceNotAllowed",
            "key": {
              "type": "var",
              "value": "__local2__"
            }
          },
          "body": [
            {
              "generated": true,
              "index": 0,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local31__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "input"
                    },
                    {
                      "type": "string",
                      "value": "path"
                    }
                  ]
                }
              ]
            },
            {
              "index": 1,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "startswith"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local31__"
                },
                {
                  "type": "string",
                  "value": "/messages"
                }
              ]
            },
            {
              "generated": true,
              "index": 2,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local32__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "groupsFromJwt"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 3,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local33__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "allowedGroups"
                    }
                  ]
                }
              ]
            },
            {
              "index": 4,
              "negated": true,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "lists_intersect"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local32__"
                },
                {
                  "type": "var",
                  "value": "__local33__"
                }
              ]
            },
            {
              "generated": true,
              "index": 5,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local34__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "input"
                    },
                    {
                      "type": "string",
                      "value": "path"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 6,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local35__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "allowedGroups"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 7,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "sprintf"
                    }
                  ]
                },
                {
                  "type": "string",
                  "value": "Not allowed to access '%v', required group: '%v'"
                },
                {
                  "type": "array",
                  "value": [
                    {
                      "type": "var",
                      "value": "__local34__"
                    },
                    {
                      "type": "var",
                      "value": "__local35__"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local14__"
                }
              ]
            },
            {
              "index": 8,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local2__"
                },
                {
                  "type": "var",
                  "value": "__local14__"
                }
              ]
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 22,
          "col": 1
        },
        "QueryID": 13,
        "ParentID": 7,
        "Locals": null,
        "LocalMetadata": {
          "__local2__": {
            "name": "reason",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 22,
              "col": 28
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Enter",
        "Node": {
          "head": {
            "name": "groupsFromJwt",
            "value": {
              "type": "var",
              "value": "__local6__"
            }
          },
          "body": [
            {
              "index": 0,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local6__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "jwtDecoded"
                    },
                    {
                      "type": "number",
                      "value": 1
                    },
                    {
                      "type": "string",
                      "value": "odp"
                    },
                    {
                      "type": "string",
                      "value": "groups"
                    }
                  ]
                }
              ]
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 63,
          "col": 1
        },
        "QueryID": 14,
        "ParentID": 13,
        "Locals": null,
        "LocalMetadata": {
          "__local6__": {
            "name": "groups",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 63,
              "col": 17
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Fail",
        "Node": {
          "index": 0,
          "terms": [
            {
              "type": "ref",
              "value": [
                {
                  "type": "var",
                  "value": "eq"
                }
              ]
            },
            {
              "type": "var",
              "value": "__local6__"
            },
            {
              "type": "ref",
              "value": [
                {
                  "type": "var",
                  "value": "data"
                },
                {
                  "type": "string",
                  "value": "http"
                },
                {
                  "type": "string",
                  "value": "request"
                },
                {
                  "type": "string",
                  "value": "authz"
                },
                {
                  "type": "string",
                  "value": "jwtDecoded"
                },
                {
                  "type": "number",
                  "value": 1
                },
                {
                  "type": "string",
                  "value": "odp"
                },
                {
                  "type": "string",
                  "value": "groups"
                }
              ]
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 64,
          "col": 5
        },
        "QueryID": 14,
        "ParentID": 13,
        "Locals": null,
        "LocalMetadata": {
          "__local6__": {
            "name": "groups",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 64,
              "col": 5
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Enter",
        "Node": [
          {
            "index": 0,
            "terms": [
              {
                "type": "ref",
                "value": [
                  {
                    "type": "var",
                    "value": "data"
                  },
                  {
                    "type": "string",
                    "value": "http"
                  },
                  {
                    "type": "string",
                    "value": "request"
                  },
                  {
                    "type": "string",
                    "value": "authz"
                  },
                  {
                    "type": "string",
                    "value": "lists_intersect"
                  }
                ]
              },
              {
                "type": "var",
                "value": "__local32__"
              },
              {
                "type": "var",
                "value": "__local33__"
              }
            ]
          }
        ],
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 24,
          "col": 9
        },
        "QueryID": 17,
        "ParentID": 13,
        "Locals": [
          {
            "name": "__local31__",
            "type": "string",
            "value": "/messages"
          },
          {
            "name": "__local32__",
            "type": "array",
            "value": []
          },
          {
            "name": "__local33__",
            "type": "array",
            "value": [
              {
                "type": "string",
                "value": "sec-ODP-Developer"
              },
              {
                "type": "string",
                "value": "sec-ODP-Data-Controller"
              }
            ]
          }
        ],
        "LocalMetadata": {
          "__local31__": {
            "name": "__local31__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 23,
              "col": 16
            }
          },
          "__local32__": {
            "name": "__local32__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 24,
              "col": 25
            }
          },
          "__local33__": {
            "name": "__local33__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 24,
              "col": 40
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Enter",
        "Node": {
          "head": {
            "name": "lists_intersect",
            "args": [
              {
                "type": "var",
                "value": "list1"
              },
              {
                "type": "var",
                "value": "list2"
              }
            ],
            "value": {
              "type": "boolean",
              "value": true
            }
          },
          "body": [
            {
              "index": 0,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "list1"
                    },
                    {
                      "type": "var",
                      "value": "$2"
                    }
                  ]
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "list2"
                    },
                    {
                      "type": "var",
                      "value": "$3"
                    }
                  ]
                }
              ]
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 75,
          "col": 1
        },
        "QueryID": 18,
        "ParentID": 17,
        "Locals": null,
        "LocalMetadata": {},
        "Message": ""
      },
      {
        "Op": "Fail",
        "Node": {
          "index": 0,
          "terms": [
            {
              "type": "ref",
              "value": [
                {
                  "type": "var",
                  "value": "eq"
                }
              ]
            },
            {
              "type": "ref",
              "value": [
                {
                  "type": "var",
                  "value": "list1"
                },
                {
                  "type": "var",
                  "value": "$2"
                }
              ]
            },
            {
              "type": "ref",
              "value": [
                {
                  "type": "var",
                  "value": "list2"
                },
                {
                  "type": "var",
                  "value": "$3"
                }
              ]
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 76,
          "col": 5
        },
        "QueryID": 18,
        "ParentID": 17,
        "Locals": [
          {
            "name": "list1",
            "type": "array",
            "value": []
          },
          {
            "name": "list2",
            "type": "array",
            "value": [
              {
                "type": "string",
                "value": "sec-ODP-Developer"
              },
              {
                "type": "string",
                "value": "sec-ODP-Data-Controller"
              }
            ]
          }
        ],
        "LocalMetadata": {
          "list1": {
            "name": "list1",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 75,
              "col": 17
            }
          },
          "list2": {
            "name": "list2",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 75,
              "col": 24
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Fail",
        "Node": {
          "index": 0,
          "terms": [
            {
              "type": "ref",
              "value": [
                {
                  "type": "var",
                  "value": "data"
                },
                {
                  "type": "string",
                  "value": "http"
                },
                {
                  "type": "string",
                  "value": "request"
                },
                {
                  "type": "string",
                  "value": "authz"
                },
                {
                  "type": "string",
                  "value": "lists_intersect"
                }
              ]
            },
            {
              "type": "var",
              "value": "__local32__"
            },
            {
              "type": "var",
              "value": "__local33__"
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 24,
          "col": 9
        },
        "QueryID": 17,
        "ParentID": 13,
        "Locals": [
          {
            "name": "__local31__",
            "type": "string",
            "value": "/messages"
          },
          {
            "name": "__local32__",
            "type": "array",
            "value": []
          },
          {
            "name": "__local33__",
            "type": "array",
            "value": [
              {
                "type": "string",
                "value": "sec-ODP-Developer"
              },
              {
                "type": "string",
                "value": "sec-ODP-Data-Controller"
              }
            ]
          }
        ],
        "LocalMetadata": {
          "__local31__": {
            "name": "__local31__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 23,
              "col": 16
            }
          },
          "__local32__": {
            "name": "__local32__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 24,
              "col": 25
            }
          },
          "__local33__": {
            "name": "__local33__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 24,
              "col": 40
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Enter",
        "Node": {
          "head": {
            "name": "accessToResourceNotAllowed",
            "key": {
              "type": "var",
              "value": "__local3__"
            }
          },
          "body": [
            {
              "generated": true,
              "index": 0,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local36__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "input"
                    },
                    {
                      "type": "string",
                      "value": "path"
                    }
                  ]
                }
              ]
            },
            {
              "index": 1,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "startswith"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local36__"
                },
                {
                  "type": "string",
                  "value": "/statistics"
                }
              ]
            },
            {
              "generated": true,
              "index": 2,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local37__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "groupsFromJwt"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 3,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local38__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "allowedGroups"
                    }
                  ]
                }
              ]
            },
            {
              "index": 4,
              "negated": true,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "lists_intersect"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local37__"
                },
                {
                  "type": "var",
                  "value": "__local38__"
                }
              ]
            },
            {
              "generated": true,
              "index": 5,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local39__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "input"
                    },
                    {
                      "type": "string",
                      "value": "path"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 6,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local40__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "allowedGroups"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 7,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "sprintf"
                    }
                  ]
                },
                {
                  "type": "string",
                  "value": "Not allowed to access '%v', required group: '%v'"
                },
                {
                  "type": "array",
                  "value": [
                    {
                      "type": "var",
                      "value": "__local39__"
                    },
                    {
                      "type": "var",
                      "value": "__local40__"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local15__"
                }
              ]
            },
            {
              "index": 8,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local3__"
                },
                {
                  "type": "var",
                  "value": "__local15__"
                }
              ]
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 28,
          "col": 1
        },
        "QueryID": 19,
        "ParentID": 7,
        "Locals": null,
        "LocalMetadata": {
          "__local3__": {
            "name": "reason",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 28,
              "col": 28
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Fail",
        "Node": {
          "index": 1,
          "terms": [
            {
              "type": "ref",
              "value": [
                {
                  "type": "var",
                  "value": "startswith"
                }
              ]
            },
            {
              "type": "var",
              "value": "__local36__"
            },
            {
              "type": "string",
              "value": "/statistics"
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 29,
          "col": 5
        },
        "QueryID": 19,
        "ParentID": 7,
        "Locals": [
          {
            "name": "__local36__",
            "type": "string",
            "value": "/messages"
          }
        ],
        "LocalMetadata": {
          "__local36__": {
            "name": "__local36__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 29,
              "col": 16
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Enter",
        "Node": {
          "head": {
            "name": "accessToResourceNotAllowed",
            "key": {
              "type": "var",
              "value": "__local1__"
            }
          },
          "body": [
            {
              "index": 0,
              "negated": true,
              "terms": {
                "type": "ref",
                "value": [
                  {
                    "type": "var",
                    "value": "input"
                  },
                  {
                    "type": "string",
                    "value": "path"
                  }
                ]
              }
            },
            {
              "index": 1,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local1__"
                },
                {
                  "type": "string",
                  "value": "Invalid input, can't extract path"
                }
              ]
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 17,
          "col": 1
        },
        "QueryID": 21,
        "ParentID": 7,
        "Locals": null,
        "LocalMetadata": {
          "__local1__": {
            "name": "reason",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 17,
              "col": 28
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Fail",
        "Node": {
          "index": 0,
          "negated": true,
          "terms": {
            "type": "ref",
            "value": [
              {
                "type": "var",
                "value": "input"
              },
              {
                "type": "string",
                "value": "path"
              }
            ]
          }
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 18,
          "col": 9
        },
        "QueryID": 21,
        "ParentID": 7,
        "Locals": null,
        "LocalMetadata": {},
        "Message": ""
      },
      {
        "Op": "Enter",
        "Node": {
          "head": {
            "name": "accessToResourceNotAllowed",
            "key": {
              "type": "var",
              "value": "__local2__"
            }
          },
          "body": [
            {
              "generated": true,
              "index": 0,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local31__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "input"
                    },
                    {
                      "type": "string",
                      "value": "path"
                    }
                  ]
                }
              ]
            },
            {
              "index": 1,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "startswith"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local31__"
                },
                {
                  "type": "string",
                  "value": "/messages"
                }
              ]
            },
            {
              "generated": true,
              "index": 2,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local32__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "groupsFromJwt"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 3,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local33__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "allowedGroups"
                    }
                  ]
                }
              ]
            },
            {
              "index": 4,
              "negated": true,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "lists_intersect"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local32__"
                },
                {
                  "type": "var",
                  "value": "__local33__"
                }
              ]
            },
            {
              "generated": true,
              "index": 5,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local34__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "input"
                    },
                    {
                      "type": "string",
                      "value": "path"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 6,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local35__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "allowedGroups"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 7,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "sprintf"
                    }
                  ]
                },
                {
                  "type": "string",
                  "value": "Not allowed to access '%v', required group: '%v'"
                },
                {
                  "type": "array",
                  "value": [
                    {
                      "type": "var",
                      "value": "__local34__"
                    },
                    {
                      "type": "var",
                      "value": "__local35__"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local14__"
                }
              ]
            },
            {
              "index": 8,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local2__"
                },
                {
                  "type": "var",
                  "value": "__local14__"
                }
              ]
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 22,
          "col": 1
        },
        "QueryID": 23,
        "ParentID": 7,
        "Locals": null,
        "LocalMetadata": {
          "__local2__": {
            "name": "reason",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 22,
              "col": 28
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Enter",
        "Node": [
          {
            "index": 0,
            "terms": [
              {
                "type": "ref",
                "value": [
                  {
                    "type": "var",
                    "value": "data"
                  },
                  {
                    "type": "string",
                    "value": "http"
                  },
                  {
                    "type": "string",
                    "value": "request"
                  },
                  {
                    "type": "string",
                    "value": "authz"
                  },
                  {
                    "type": "string",
                    "value": "lists_intersect"
                  }
                ]
              },
              {
                "type": "var",
                "value": "__local32__"
              },
              {
                "type": "var",
                "value": "__local33__"
              }
            ]
          }
        ],
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 24,
          "col": 9
        },
        "QueryID": 24,
        "ParentID": 23,
        "Locals": [
          {
            "name": "__local31__",
            "type": "string",
            "value": "/messages"
          },
          {
            "name": "__local32__",
            "type": "array",
            "value": []
          },
          {
            "name": "__local33__",
            "type": "array",
            "value": [
              {
                "type": "string",
                "value": "sec-ODP-Developer"
              },
              {
                "type": "string",
                "value": "sec-ODP-Data-Controller"
              }
            ]
          }
        ],
        "LocalMetadata": {
          "__local31__": {
            "name": "__local31__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 23,
              "col": 16
            }
          },
          "__local32__": {
            "name": "__local32__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 24,
              "col": 25
            }
          },
          "__local33__": {
            "name": "__local33__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 24,
              "col": 40
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Enter",
        "Node": {
          "head": {
            "name": "lists_intersect",
            "args": [
              {
                "type": "var",
                "value": "list1"
              },
              {
                "type": "var",
                "value": "list2"
              }
            ],
            "value": {
              "type": "boolean",
              "value": true
            }
          },
          "body": [
            {
              "index": 0,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "list1"
                    },
                    {
                      "type": "var",
                      "value": "$2"
                    }
                  ]
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "list2"
                    },
                    {
                      "type": "var",
                      "value": "$3"
                    }
                  ]
                }
              ]
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 75,
          "col": 1
        },
        "QueryID": 25,
        "ParentID": 24,
        "Locals": null,
        "LocalMetadata": {},
        "Message": ""
      },
      {
        "Op": "Fail",
        "Node": {
          "index": 0,
          "terms": [
            {
              "type": "ref",
              "value": [
                {
                  "type": "var",
                  "value": "eq"
                }
              ]
            },
            {
              "type": "ref",
              "value": [
                {
                  "type": "var",
                  "value": "list1"
                },
                {
                  "type": "var",
                  "value": "$2"
                }
              ]
            },
            {
              "type": "ref",
              "value": [
                {
                  "type": "var",
                  "value": "list2"
                },
                {
                  "type": "var",
                  "value": "$3"
                }
              ]
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 76,
          "col": 5
        },
        "QueryID": 25,
        "ParentID": 24,
        "Locals": [
          {
            "name": "list1",
            "type": "array",
            "value": []
          },
          {
            "name": "list2",
            "type": "array",
            "value": [
              {
                "type": "string",
                "value": "sec-ODP-Developer"
              },
              {
                "type": "string",
                "value": "sec-ODP-Data-Controller"
              }
            ]
          }
        ],
        "LocalMetadata": {
          "list1": {
            "name": "list1",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 75,
              "col": 17
            }
          },
          "list2": {
            "name": "list2",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 75,
              "col": 24
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Fail",
        "Node": {
          "index": 0,
          "terms": [
            {
              "type": "ref",
              "value": [
                {
                  "type": "var",
                  "value": "data"
                },
                {
                  "type": "string",
                  "value": "http"
                },
                {
                  "type": "string",
                  "value": "request"
                },
                {
                  "type": "string",
                  "value": "authz"
                },
                {
                  "type": "string",
                  "value": "lists_intersect"
                }
              ]
            },
            {
              "type": "var",
              "value": "__local32__"
            },
            {
              "type": "var",
              "value": "__local33__"
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 24,
          "col": 9
        },
        "QueryID": 24,
        "ParentID": 23,
        "Locals": [
          {
            "name": "__local31__",
            "type": "string",
            "value": "/messages"
          },
          {
            "name": "__local32__",
            "type": "array",
            "value": []
          },
          {
            "name": "__local33__",
            "type": "array",
            "value": [
              {
                "type": "string",
                "value": "sec-ODP-Developer"
              },
              {
                "type": "string",
                "value": "sec-ODP-Data-Controller"
              }
            ]
          }
        ],
        "LocalMetadata": {
          "__local31__": {
            "name": "__local31__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 23,
              "col": 16
            }
          },
          "__local32__": {
            "name": "__local32__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 24,
              "col": 25
            }
          },
          "__local33__": {
            "name": "__local33__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 24,
              "col": 40
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Enter",
        "Node": {
          "head": {
            "name": "accessToResourceNotAllowed",
            "key": {
              "type": "var",
              "value": "__local3__"
            }
          },
          "body": [
            {
              "generated": true,
              "index": 0,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local36__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "input"
                    },
                    {
                      "type": "string",
                      "value": "path"
                    }
                  ]
                }
              ]
            },
            {
              "index": 1,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "startswith"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local36__"
                },
                {
                  "type": "string",
                  "value": "/statistics"
                }
              ]
            },
            {
              "generated": true,
              "index": 2,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local37__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "groupsFromJwt"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 3,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local38__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "allowedGroups"
                    }
                  ]
                }
              ]
            },
            {
              "index": 4,
              "negated": true,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "lists_intersect"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local37__"
                },
                {
                  "type": "var",
                  "value": "__local38__"
                }
              ]
            },
            {
              "generated": true,
              "index": 5,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local39__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "input"
                    },
                    {
                      "type": "string",
                      "value": "path"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 6,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local40__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "allowedGroups"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 7,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "sprintf"
                    }
                  ]
                },
                {
                  "type": "string",
                  "value": "Not allowed to access '%v', required group: '%v'"
                },
                {
                  "type": "array",
                  "value": [
                    {
                      "type": "var",
                      "value": "__local39__"
                    },
                    {
                      "type": "var",
                      "value": "__local40__"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local15__"
                }
              ]
            },
            {
              "index": 8,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local3__"
                },
                {
                  "type": "var",
                  "value": "__local15__"
                }
              ]
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 28,
          "col": 1
        },
        "QueryID": 26,
        "ParentID": 7,
        "Locals": null,
        "LocalMetadata": {
          "__local3__": {
            "name": "reason",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 28,
              "col": 28
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Fail",
        "Node": {
          "index": 1,
          "terms": [
            {
              "type": "ref",
              "value": [
                {
                  "type": "var",
                  "value": "startswith"
                }
              ]
            },
            {
              "type": "var",
              "value": "__local36__"
            },
            {
              "type": "string",
              "value": "/statistics"
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 29,
          "col": 5
        },
        "QueryID": 26,
        "ParentID": 7,
        "Locals": [
          {
            "name": "__local36__",
            "type": "string",
            "value": "/messages"
          }
        ],
        "LocalMetadata": {
          "__local36__": {
            "name": "__local36__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 29,
              "col": 16
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Fail",
        "Node": {
          "index": 0,
          "terms": {
            "type": "ref",
            "value": [
              {
                "type": "var",
                "value": "data"
              },
              {
                "type": "string",
                "value": "http"
              },
              {
                "type": "string",
                "value": "request"
              },
              {
                "type": "string",
                "value": "authz"
              },
              {
                "type": "string",
                "value": "allow"
              }
            ]
          }
        },
        "Location": {
          "file": "src/test/resources/opa/policies/policies-test.rego",
          "row": 21,
          "col": 9
        },
        "QueryID": 2,
        "ParentID": 1,
        "Locals": null,
        "LocalMetadata": {},
        "Message": ""
      }
    ]
  },
  {
    "location": {
      "file": "src/test/resources/opa/policies/policies-test.rego",
      "row": 24,
      "col": 1
    },
    "package": "data.http.request.authz",
    "name": "test_not_allow_if_jwt_without_group_for_messages",
    "duration": 2013099,
    "trace": [
      {
        "Op": "Enter",
        "Node": [
          {
            "index": 0,
            "terms": [
              {
                "type": "ref",
                "value": [
                  {
                    "type": "var",
                    "value": "eq"
                  }
                ]
              },
              {
                "type": "ref",
                "value": [
                  {
                    "type": "var",
                    "value": "data"
                  },
                  {
                    "type": "string",
                    "value": "http"
                  },
                  {
                    "type": "string",
                    "value": "request"
                  },
                  {
                    "type": "string",
                    "value": "authz"
                  },
                  {
                    "type": "string",
                    "value": "test_not_allow_if_jwt_without_group_for_messages"
                  }
                ]
              },
              {
                "type": "var",
                "value": "$term1"
              }
            ]
          }
        ],
        "Location": {
          "file": "",
          "row": 1,
          "col": 1
        },
        "QueryID": 0,
        "ParentID": 0,
        "Locals": null,
        "LocalMetadata": {},
        "Message": ""
      },
      {
        "Op": "Enter",
        "Node": {
          "head": {
            "name": "test_not_allow_if_jwt_without_group_for_messages",
            "value": {
              "type": "boolean",
              "value": true
            }
          },
          "body": [
            {
              "generated": true,
              "index": 0,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "generateJWT"
                    }
                  ]
                },
                {
                  "type": "string",
                  "value": ""
                },
                {
                  "type": "var",
                  "value": "__local22__"
                }
              ]
            },
            {
              "index": 1,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local7__"
                },
                {
                  "type": "var",
                  "value": "__local22__"
                }
              ]
            },
            {
              "index": 2,
              "negated": true,
              "terms": {
                "type": "ref",
                "value": [
                  {
                    "type": "var",
                    "value": "data"
                  },
                  {
                    "type": "string",
                    "value": "http"
                  },
                  {
                    "type": "string",
                    "value": "request"
                  },
                  {
                    "type": "string",
                    "value": "authz"
                  },
                  {
                    "type": "string",
                    "value": "allow"
                  }
                ]
              },
              "with": [
                {
                  "target": {
                    "type": "ref",
                    "value": [
                      {
                        "type": "var",
                        "value": "input"
                      }
                    ]
                  },
                  "value": {
                    "type": "object",
                    "value": [
                      [
                        {
                          "type": "string",
                          "value": "encodedJwt"
                        },
                        {
                          "type": "var",
                          "value": "__local7__"
                        }
                      ],
                      [
                        {
                          "type": "string",
                          "value": "path"
                        },
                        {
                          "type": "string",
                          "value": "/messages"
                        }
                      ]
                    ]
                  }
                }
              ]
            }
          ]
        },
        "Location": {
          "file": "src/test/resources/opa/policies/policies-test.rego",
          "row": 24,
          "col": 1
        },
        "QueryID": 1,
        "ParentID": 0,
        "Locals": null,
        "LocalMetadata": {
          "__local7__": {
            "name": "jwt",
            "location": {
              "file": "src/test/resources/opa/policies/policies-test.rego",
              "row": 25,
              "col": 5
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Enter",
        "Node": [
          {
            "index": 0,
            "terms": {
              "type": "ref",
              "value": [
                {
                  "type": "var",
                  "value": "data"
                },
                {
                  "type": "string",
                  "value": "http"
                },
                {
                  "type": "string",
                  "value": "request"
                },
                {
                  "type": "string",
                  "value": "authz"
                },
                {
                  "type": "string",
                  "value": "allow"
                }
              ]
            }
          }
        ],
        "Location": {
          "file": "src/test/resources/opa/policies/policies-test.rego",
          "row": 26,
          "col": 9
        },
        "QueryID": 3,
        "ParentID": 1,
        "Locals": [
          {
            "name": "__local22__",
            "type": "string",
            "value": "eyJhbGciOiAiUlMyNTYiLCAidHlwIjogIkpXVCJ9.eyJjbGllbnRfaWQiOiAib2RwLWRpc21pdCIsICJleHAiOiAxNTgxOTU3NzIxLCAib2RwIjogeyJncm91cHMiOiBbIiJdfSwgInB1cnBvc2UiOiAiYWNjZXNzX3Rva2VuIiwgInNjb3BlIjogIm9wYS1kaXNtaXQiLCAidXNlcm5hbWUiOiAib2RwLWRpc21pdCJ9.V60AwDLqzNfzfOd-R0gxqPHaYU3ok91ogwAvttSuIoZERfevj9qNwaKtp0vfSgpMwAPleXAgDB1ACQbK7ZlQpgqO9npZw3gEELPJaAUcigJs1YgWRz7Yhy1cSDQULK5LycecO_iMPnJtTLR1jrKGdbe-THdXylt2XADxU2MzYHvebf9gNNUZhW_cFyT9RoyxnkPt5t3ktv-WGhwu9x95iedSSQtP3ktuWTOXjavURcVRLwlL7RV1Z5sjcniiMfWNYFcXRQOemKMqvqWIkTzzuaQOCbBIp-gp00EvkNi2-9FFnzZ2_mxha95WSFMypQl5HzCgiPyl3PJ_XExuXRPjLg"
          },
          {
            "name": "__local7__",
            "type": "string",
            "value": "eyJhbGciOiAiUlMyNTYiLCAidHlwIjogIkpXVCJ9.eyJjbGllbnRfaWQiOiAib2RwLWRpc21pdCIsICJleHAiOiAxNTgxOTU3NzIxLCAib2RwIjogeyJncm91cHMiOiBbIiJdfSwgInB1cnBvc2UiOiAiYWNjZXNzX3Rva2VuIiwgInNjb3BlIjogIm9wYS1kaXNtaXQiLCAidXNlcm5hbWUiOiAib2RwLWRpc21pdCJ9.V60AwDLqzNfzfOd-R0gxqPHaYU3ok91ogwAvttSuIoZERfevj9qNwaKtp0vfSgpMwAPleXAgDB1ACQbK7ZlQpgqO9npZw3gEELPJaAUcigJs1YgWRz7Yhy1cSDQULK5LycecO_iMPnJtTLR1jrKGdbe-THdXylt2XADxU2MzYHvebf9gNNUZhW_cFyT9RoyxnkPt5t3ktv-WGhwu9x95iedSSQtP3ktuWTOXjavURcVRLwlL7RV1Z5sjcniiMfWNYFcXRQOemKMqvqWIkTzzuaQOCbBIp-gp00EvkNi2-9FFnzZ2_mxha95WSFMypQl5HzCgiPyl3PJ_XExuXRPjLg"
          }
        ],
        "LocalMetadata": {
          "__local22__": {
            "name": "__local22__",
            "location": {
              "file": "src/test/resources/opa/policies/policies-test.rego",
              "row": 25,
              "col": 12
            }
          },
          "__local7__": {
            "name": "jwt",
            "location": {
              "file": "src/test/resources/opa/policies/policies-test.rego",
              "row": 25,
              "col": 5
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Enter",
        "Node": {
          "head": {
            "name": "allow",
            "value": {
              "type": "var",
              "value": "__local29__"
            }
          },
          "body": [
            {
              "index": 0,
              "terms": {
                "type": "boolean",
                "value": true
              }
            },
            {
              "generated": true,
              "index": 1,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local29__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "status"
                    },
                    {
                      "type": "string",
                      "value": "allowed"
                    }
                  ]
                }
              ]
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 47,
          "col": 9
        },
        "QueryID": 4,
        "ParentID": 3,
        "Locals": null,
        "LocalMetadata": {},
        "Message": ""
      },
      {
        "Op": "Enter",
        "Node": {
          "head": {
            "name": "status",
            "value": {
              "type": "object",
              "value": [
                [
                  {
                    "type": "string",
                    "value": "allowed"
                  },
                  {
                    "type": "boolean",
                    "value": true
                  }
                ],
                [
                  {
                    "type": "string",
                    "value": "reason"
                  },
                  {
                    "type": "var",
                    "value": "__local17__"
                  }
                ]
              ]
            }
          },
          "body": [
            {
              "generated": true,
              "index": 0,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local44__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "accessToWhitelistAllowed"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 1,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "count"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local44__"
                },
                {
                  "type": "var",
                  "value": "__local18__"
                }
              ]
            },
            {
              "index": 2,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "gt"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local18__"
                },
                {
                  "type": "number",
                  "value": 0
                }
              ]
            },
            {
              "generated": true,
              "index": 3,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local45__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "accessToWhitelistAllowed"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 4,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "concat"
                    }
                  ]
                },
                {
                  "type": "string",
                  "value": " | "
                },
                {
                  "type": "var",
                  "value": "__local45__"
                },
                {
                  "type": "var",
                  "value": "__local17__"
                }
              ]
            }
          ],
          "else": {
            "head": {
              "name": "status",
              "value": {
                "type": "object",
                "value": [
                  [
                    {
                      "type": "string",
                      "value": "allowed"
                    },
                    {
                      "type": "boolean",
                      "value": false
                    }
                  ],
                  [
                    {
                      "type": "string",
                      "value": "reason"
                    },
                    {
                      "type": "var",
                      "value": "__local19__"
                    }
                  ]
                ]
              }
            },
            "body": [
              {
                "generated": true,
                "index": 0,
                "terms": [
                  {
                    "type": "ref",
                    "value": [
                      {
                        "type": "var",
                        "value": "eq"
                      }
                    ]
                  },
                  {
                    "type": "var",
                    "value": "__local46__"
                  },
                  {
                    "type": "ref",
                    "value": [
                      {
                        "type": "var",
                        "value": "data"
                      },
                      {
                        "type": "string",
                        "value": "http"
                      },
                      {
                        "type": "string",
                        "value": "request"
                      },
                      {
                        "type": "string",
                        "value": "authz"
                      },
                      {
                        "type": "string",
                        "value": "accessToResourceNotAllowed"
                      }
                    ]
                  }
                ]
              },
              {
                "generated": true,
                "index": 1,
                "terms": [
                  {
                    "type": "ref",
                    "value": [
                      {
                        "type": "var",
                        "value": "count"
                      }
                    ]
                  },
                  {
                    "type": "var",
                    "value": "__local46__"
                  },
                  {
                    "type": "var",
                    "value": "__local20__"
                  }
                ]
              },
              {
                "index": 2,
                "terms": [
                  {
                    "type": "ref",
                    "value": [
                      {
                        "type": "var",
                        "value": "gt"
                      }
                    ]
                  },
                  {
                    "type": "var",
                    "value": "__local20__"
                  },
                  {
                    "type": "number",
                    "value": 0
                  }
                ]
              },
              {
                "generated": true,
                "index": 3,
                "terms": [
                  {
                    "type": "ref",
                    "value": [
                      {
                        "type": "var",
                        "value": "eq"
                      }
                    ]
                  },
                  {
                    "type": "var",
                    "value": "__local47__"
                  },
                  {
                    "type": "ref",
                    "value": [
                      {
                        "type": "var",
                        "value": "data"
                      },
                      {
                        "type": "string",
                        "value": "http"
                      },
                      {
                        "type": "string",
                        "value": "request"
                      },
                      {
                        "type": "string",
                        "value": "authz"
                      },
                      {
                        "type": "string",
                        "value": "accessToResourceNotAllowed"
                      }
                    ]
                  }
                ]
              },
              {
                "generated": true,
                "index": 4,
                "terms": [
                  {
                    "type": "ref",
                    "value": [
                      {
                        "type": "var",
                        "value": "concat"
                      }
                    ]
                  },
                  {
                    "type": "string",
                    "value": " | "
                  },
                  {
                    "type": "var",
                    "value": "__local47__"
                  },
                  {
                    "type": "var",
                    "value": "__local19__"
                  }
                ]
              }
            ],
            "else": {
              "head": {
                "name": "status",
                "value": {
                  "type": "object",
                  "value": [
                    [
                      {
                        "type": "string",
                        "value": "allowed"
                      },
                      {
                        "type": "boolean",
                        "value": true
                      }
                    ],
                    [
                      {
                        "type": "string",
                        "value": "reason"
                      },
                      {
                        "type": "string",
                        "value": "Access allowed, all rules passed"
                      }
                    ]
                  ]
                }
              },
              "body": [
                {
                  "index": 0,
                  "terms": {
                    "type": "boolean",
                    "value": true
                  }
                }
              ]
            }
          }
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 39,
          "col": 1
        },
        "QueryID": 5,
        "ParentID": 4,
        "Locals": null,
        "LocalMetadata": {},
        "Message": ""
      },
      {
        "Op": "Enter",
        "Node": {
          "head": {
            "name": "accessToWhitelistAllowed",
            "key": {
              "type": "var",
              "value": "__local4__"
            }
          },
          "body": [
            {
              "generated": true,
              "index": 0,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local41__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "input"
                    },
                    {
                      "type": "string",
                      "value": "path"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 1,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local42__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "whitelistedEndpoints"
                    },
                    {
                      "type": "var",
                      "value": "$0"
                    }
                  ]
                }
              ]
            },
            {
              "index": 2,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "startswith"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local41__"
                },
                {
                  "type": "var",
                  "value": "__local42__"
                }
              ]
            },
            {
              "generated": true,
              "index": 3,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local43__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "input"
                    },
                    {
                      "type": "string",
                      "value": "path"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 4,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "sprintf"
                    }
                  ]
                },
                {
                  "type": "string",
                  "value": "Resource '%v' on whitelist"
                },
                {
                  "type": "array",
                  "value": [
                    {
                      "type": "var",
                      "value": "__local43__"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local16__"
                }
              ]
            },
            {
              "index": 5,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local4__"
                },
                {
                  "type": "var",
                  "value": "__local16__"
                }
              ]
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 34,
          "col": 1
        },
        "QueryID": 6,
        "ParentID": 5,
        "Locals": null,
        "LocalMetadata": {
          "__local4__": {
            "name": "reason",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 34,
              "col": 26
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Fail",
        "Node": {
          "index": 2,
          "terms": [
            {
              "type": "ref",
              "value": [
                {
                  "type": "var",
                  "value": "startswith"
                }
              ]
            },
            {
              "type": "var",
              "value": "__local41__"
            },
            {
              "type": "var",
              "value": "__local42__"
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 35,
          "col": 5
        },
        "QueryID": 6,
        "ParentID": 5,
        "Locals": [
          {
            "name": "__local41__",
            "type": "string",
            "value": "/messages"
          },
          {
            "name": "_",
            "type": "number",
            "value": 0
          },
          {
            "name": "__local42__",
            "type": "string",
            "value": "/ping"
          }
        ],
        "LocalMetadata": {
          "$0": {
            "name": "$0",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 35,
              "col": 49
            }
          },
          "__local41__": {
            "name": "__local41__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 35,
              "col": 16
            }
          },
          "__local42__": {
            "name": "__local42__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 35,
              "col": 28
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Fail",
        "Node": {
          "index": 2,
          "terms": [
            {
              "type": "ref",
              "value": [
                {
                  "type": "var",
                  "value": "startswith"
                }
              ]
            },
            {
              "type": "var",
              "value": "__local41__"
            },
            {
              "type": "var",
              "value": "__local42__"
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 35,
          "col": 5
        },
        "QueryID": 6,
        "ParentID": 5,
        "Locals": [
          {
            "name": "_",
            "type": "number",
            "value": 1
          },
          {
            "name": "__local42__",
            "type": "string",
            "value": "/error"
          },
          {
            "name": "__local41__",
            "type": "string",
            "value": "/messages"
          }
        ],
        "LocalMetadata": {
          "$0": {
            "name": "$0",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 35,
              "col": 49
            }
          },
          "__local41__": {
            "name": "__local41__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 35,
              "col": 16
            }
          },
          "__local42__": {
            "name": "__local42__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 35,
              "col": 28
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Fail",
        "Node": {
          "index": 2,
          "terms": [
            {
              "type": "ref",
              "value": [
                {
                  "type": "var",
                  "value": "startswith"
                }
              ]
            },
            {
              "type": "var",
              "value": "__local41__"
            },
            {
              "type": "var",
              "value": "__local42__"
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 35,
          "col": 5
        },
        "QueryID": 6,
        "ParentID": 5,
        "Locals": [
          {
            "name": "__local41__",
            "type": "string",
            "value": "/messages"
          },
          {
            "name": "_",
            "type": "number",
            "value": 2
          },
          {
            "name": "__local42__",
            "type": "string",
            "value": "/health"
          }
        ],
        "LocalMetadata": {
          "$0": {
            "name": "$0",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 35,
              "col": 49
            }
          },
          "__local41__": {
            "name": "__local41__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 35,
              "col": 16
            }
          },
          "__local42__": {
            "name": "__local42__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 35,
              "col": 28
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Fail",
        "Node": {
          "index": 2,
          "terms": [
            {
              "type": "ref",
              "value": [
                {
                  "type": "var",
                  "value": "gt"
                }
              ]
            },
            {
              "type": "var",
              "value": "__local18__"
            },
            {
              "type": "number",
              "value": 0
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 40,
          "col": 5
        },
        "QueryID": 5,
        "ParentID": 4,
        "Locals": [
          {
            "name": "__local44__",
            "type": "set",
            "value": []
          },
          {
            "name": "__local18__",
            "type": "number",
            "value": 0
          }
        ],
        "LocalMetadata": {
          "__local18__": {
            "name": "__local18__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 40,
              "col": 5
            }
          },
          "__local44__": {
            "name": "__local44__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 40,
              "col": 11
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Enter",
        "Node": {
          "head": {
            "name": "status",
            "value": {
              "type": "object",
              "value": [
                [
                  {
                    "type": "string",
                    "value": "allowed"
                  },
                  {
                    "type": "boolean",
                    "value": false
                  }
                ],
                [
                  {
                    "type": "string",
                    "value": "reason"
                  },
                  {
                    "type": "var",
                    "value": "__local19__"
                  }
                ]
              ]
            }
          },
          "body": [
            {
              "generated": true,
              "index": 0,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local46__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "accessToResourceNotAllowed"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 1,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "count"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local46__"
                },
                {
                  "type": "var",
                  "value": "__local20__"
                }
              ]
            },
            {
              "index": 2,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "gt"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local20__"
                },
                {
                  "type": "number",
                  "value": 0
                }
              ]
            },
            {
              "generated": true,
              "index": 3,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local47__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "accessToResourceNotAllowed"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 4,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "concat"
                    }
                  ]
                },
                {
                  "type": "string",
                  "value": " | "
                },
                {
                  "type": "var",
                  "value": "__local47__"
                },
                {
                  "type": "var",
                  "value": "__local19__"
                }
              ]
            }
          ],
          "else": {
            "head": {
              "name": "status",
              "value": {
                "type": "object",
                "value": [
                  [
                    {
                      "type": "string",
                      "value": "allowed"
                    },
                    {
                      "type": "boolean",
                      "value": true
                    }
                  ],
                  [
                    {
                      "type": "string",
                      "value": "reason"
                    },
                    {
                      "type": "string",
                      "value": "Access allowed, all rules passed"
                    }
                  ]
                ]
              }
            },
            "body": [
              {
                "index": 0,
                "terms": {
                  "type": "boolean",
                  "value": true
                }
              }
            ]
          }
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 41,
          "col": 3
        },
        "QueryID": 8,
        "ParentID": 4,
        "Locals": null,
        "LocalMetadata": {},
        "Message": ""
      },
      {
        "Op": "Enter",
        "Node": {
          "head": {
            "name": "accessToResourceNotAllowed",
            "key": {
              "type": "var",
              "value": "__local0__"
            }
          },
          "body": [
            {
              "index": 0,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "jwtDecoded"
                    }
                  ]
                },
                {
                  "type": "object",
                  "value": []
                }
              ]
            },
            {
              "index": 1,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local0__"
                },
                {
                  "type": "string",
                  "value": "Invalid input, missing JWT"
                }
              ]
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 12,
          "col": 1
        },
        "QueryID": 9,
        "ParentID": 8,
        "Locals": null,
        "LocalMetadata": {
          "__local0__": {
            "name": "reason",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 12,
              "col": 28
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Fail",
        "Node": {
          "index": 0,
          "terms": [
            {
              "type": "ref",
              "value": [
                {
                  "type": "var",
                  "value": "eq"
                }
              ]
            },
            {
              "type": "ref",
              "value": [
                {
                  "type": "var",
                  "value": "data"
                },
                {
                  "type": "string",
                  "value": "http"
                },
                {
                  "type": "string",
                  "value": "request"
                },
                {
                  "type": "string",
                  "value": "authz"
                },
                {
                  "type": "string",
                  "value": "jwtDecoded"
                }
              ]
            },
            {
              "type": "object",
              "value": []
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 13,
          "col": 5
        },
        "QueryID": 9,
        "ParentID": 8,
        "Locals": null,
        "LocalMetadata": {},
        "Message": ""
      },
      {
        "Op": "Enter",
        "Node": {
          "head": {
            "name": "accessToResourceNotAllowed",
            "key": {
              "type": "var",
              "value": "__local1__"
            }
          },
          "body": [
            {
              "index": 0,
              "negated": true,
              "terms": {
                "type": "ref",
                "value": [
                  {
                    "type": "var",
                    "value": "input"
                  },
                  {
                    "type": "string",
                    "value": "path"
                  }
                ]
              }
            },
            {
              "index": 1,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local1__"
                },
                {
                  "type": "string",
                  "value": "Invalid input, can't extract path"
                }
              ]
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 17,
          "col": 1
        },
        "QueryID": 11,
        "ParentID": 8,
        "Locals": null,
        "LocalMetadata": {
          "__local1__": {
            "name": "reason",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 17,
              "col": 28
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Fail",
        "Node": {
          "index": 0,
          "negated": true,
          "terms": {
            "type": "ref",
            "value": [
              {
                "type": "var",
                "value": "input"
              },
              {
                "type": "string",
                "value": "path"
              }
            ]
          }
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 18,
          "col": 9
        },
        "QueryID": 11,
        "ParentID": 8,
        "Locals": null,
        "LocalMetadata": {},
        "Message": ""
      },
      {
        "Op": "Enter",
        "Node": {
          "head": {
            "name": "accessToResourceNotAllowed",
            "key": {
              "type": "var",
              "value": "__local2__"
            }
          },
          "body": [
            {
              "generated": true,
              "index": 0,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local31__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "input"
                    },
                    {
                      "type": "string",
                      "value": "path"
                    }
                  ]
                }
              ]
            },
            {
              "index": 1,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "startswith"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local31__"
                },
                {
                  "type": "string",
                  "value": "/messages"
                }
              ]
            },
            {
              "generated": true,
              "index": 2,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local32__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "groupsFromJwt"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 3,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local33__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "allowedGroups"
                    }
                  ]
                }
              ]
            },
            {
              "index": 4,
              "negated": true,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "lists_intersect"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local32__"
                },
                {
                  "type": "var",
                  "value": "__local33__"
                }
              ]
            },
            {
              "generated": true,
              "index": 5,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local34__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "input"
                    },
                    {
                      "type": "string",
                      "value": "path"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 6,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local35__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "allowedGroups"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 7,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "sprintf"
                    }
                  ]
                },
                {
                  "type": "string",
                  "value": "Not allowed to access '%v', required group: '%v'"
                },
                {
                  "type": "array",
                  "value": [
                    {
                      "type": "var",
                      "value": "__local34__"
                    },
                    {
                      "type": "var",
                      "value": "__local35__"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local14__"
                }
              ]
            },
            {
              "index": 8,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local2__"
                },
                {
                  "type": "var",
                  "value": "__local14__"
                }
              ]
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 22,
          "col": 1
        },
        "QueryID": 13,
        "ParentID": 8,
        "Locals": null,
        "LocalMetadata": {
          "__local2__": {
            "name": "reason",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 22,
              "col": 28
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Enter",
        "Node": [
          {
            "index": 0,
            "terms": [
              {
                "type": "ref",
                "value": [
                  {
                    "type": "var",
                    "value": "data"
                  },
                  {
                    "type": "string",
                    "value": "http"
                  },
                  {
                    "type": "string",
                    "value": "request"
                  },
                  {
                    "type": "string",
                    "value": "authz"
                  },
                  {
                    "type": "string",
                    "value": "lists_intersect"
                  }
                ]
              },
              {
                "type": "var",
                "value": "__local32__"
              },
              {
                "type": "var",
                "value": "__local33__"
              }
            ]
          }
        ],
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 24,
          "col": 9
        },
        "QueryID": 16,
        "ParentID": 13,
        "Locals": [
          {
            "name": "__local31__",
            "type": "string",
            "value": "/messages"
          },
          {
            "name": "__local32__",
            "type": "array",
            "value": [
              {
                "type": "string",
                "value": ""
              }
            ]
          },
          {
            "name": "__local33__",
            "type": "array",
            "value": [
              {
                "type": "string",
                "value": "sec-ODP-Developer"
              },
              {
                "type": "string",
                "value": "sec-ODP-Data-Controller"
              }
            ]
          }
        ],
        "LocalMetadata": {
          "__local31__": {
            "name": "__local31__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 23,
              "col": 16
            }
          },
          "__local32__": {
            "name": "__local32__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 24,
              "col": 25
            }
          },
          "__local33__": {
            "name": "__local33__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 24,
              "col": 40
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Enter",
        "Node": {
          "head": {
            "name": "lists_intersect",
            "args": [
              {
                "type": "var",
                "value": "list1"
              },
              {
                "type": "var",
                "value": "list2"
              }
            ],
            "value": {
              "type": "boolean",
              "value": true
            }
          },
          "body": [
            {
              "index": 0,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "list1"
                    },
                    {
                      "type": "var",
                      "value": "$2"
                    }
                  ]
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "list2"
                    },
                    {
                      "type": "var",
                      "value": "$3"
                    }
                  ]
                }
              ]
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 75,
          "col": 1
        },
        "QueryID": 17,
        "ParentID": 16,
        "Locals": null,
        "LocalMetadata": {},
        "Message": ""
      },
      {
        "Op": "Fail",
        "Node": {
          "index": 0,
          "terms": [
            {
              "type": "ref",
              "value": [
                {
                  "type": "var",
                  "value": "eq"
                }
              ]
            },
            {
              "type": "ref",
              "value": [
                {
                  "type": "var",
                  "value": "list1"
                },
                {
                  "type": "var",
                  "value": "$2"
                }
              ]
            },
            {
              "type": "ref",
              "value": [
                {
                  "type": "var",
                  "value": "list2"
                },
                {
                  "type": "var",
                  "value": "$3"
                }
              ]
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 76,
          "col": 5
        },
        "QueryID": 17,
        "ParentID": 16,
        "Locals": [
          {
            "name": "list1",
            "type": "array",
            "value": [
              {
                "type": "string",
                "value": ""
              }
            ]
          },
          {
            "name": "list2",
            "type": "array",
            "value": [
              {
                "type": "string",
                "value": "sec-ODP-Developer"
              },
              {
                "type": "string",
                "value": "sec-ODP-Data-Controller"
              }
            ]
          }
        ],
        "LocalMetadata": {
          "list1": {
            "name": "list1",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 75,
              "col": 17
            }
          },
          "list2": {
            "name": "list2",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 75,
              "col": 24
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Fail",
        "Node": {
          "index": 0,
          "terms": [
            {
              "type": "ref",
              "value": [
                {
                  "type": "var",
                  "value": "data"
                },
                {
                  "type": "string",
                  "value": "http"
                },
                {
                  "type": "string",
                  "value": "request"
                },
                {
                  "type": "string",
                  "value": "authz"
                },
                {
                  "type": "string",
                  "value": "lists_intersect"
                }
              ]
            },
            {
              "type": "var",
              "value": "__local32__"
            },
            {
              "type": "var",
              "value": "__local33__"
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 24,
          "col": 9
        },
        "QueryID": 16,
        "ParentID": 13,
        "Locals": [
          {
            "name": "__local31__",
            "type": "string",
            "value": "/messages"
          },
          {
            "name": "__local32__",
            "type": "array",
            "value": [
              {
                "type": "string",
                "value": ""
              }
            ]
          },
          {
            "name": "__local33__",
            "type": "array",
            "value": [
              {
                "type": "string",
                "value": "sec-ODP-Developer"
              },
              {
                "type": "string",
                "value": "sec-ODP-Data-Controller"
              }
            ]
          }
        ],
        "LocalMetadata": {
          "__local31__": {
            "name": "__local31__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 23,
              "col": 16
            }
          },
          "__local32__": {
            "name": "__local32__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 24,
              "col": 25
            }
          },
          "__local33__": {
            "name": "__local33__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 24,
              "col": 40
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Enter",
        "Node": {
          "head": {
            "name": "accessToResourceNotAllowed",
            "key": {
              "type": "var",
              "value": "__local3__"
            }
          },
          "body": [
            {
              "generated": true,
              "index": 0,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local36__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "input"
                    },
                    {
                      "type": "string",
                      "value": "path"
                    }
                  ]
                }
              ]
            },
            {
              "index": 1,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "startswith"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local36__"
                },
                {
                  "type": "string",
                  "value": "/statistics"
                }
              ]
            },
            {
              "generated": true,
              "index": 2,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local37__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "groupsFromJwt"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 3,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local38__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "allowedGroups"
                    }
                  ]
                }
              ]
            },
            {
              "index": 4,
              "negated": true,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "lists_intersect"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local37__"
                },
                {
                  "type": "var",
                  "value": "__local38__"
                }
              ]
            },
            {
              "generated": true,
              "index": 5,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local39__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "input"
                    },
                    {
                      "type": "string",
                      "value": "path"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 6,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local40__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "allowedGroups"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 7,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "sprintf"
                    }
                  ]
                },
                {
                  "type": "string",
                  "value": "Not allowed to access '%v', required group: '%v'"
                },
                {
                  "type": "array",
                  "value": [
                    {
                      "type": "var",
                      "value": "__local39__"
                    },
                    {
                      "type": "var",
                      "value": "__local40__"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local15__"
                }
              ]
            },
            {
              "index": 8,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local3__"
                },
                {
                  "type": "var",
                  "value": "__local15__"
                }
              ]
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 28,
          "col": 1
        },
        "QueryID": 18,
        "ParentID": 8,
        "Locals": null,
        "LocalMetadata": {
          "__local3__": {
            "name": "reason",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 28,
              "col": 28
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Fail",
        "Node": {
          "index": 1,
          "terms": [
            {
              "type": "ref",
              "value": [
                {
                  "type": "var",
                  "value": "startswith"
                }
              ]
            },
            {
              "type": "var",
              "value": "__local36__"
            },
            {
              "type": "string",
              "value": "/statistics"
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 29,
          "col": 5
        },
        "QueryID": 18,
        "ParentID": 8,
        "Locals": [
          {
            "name": "__local36__",
            "type": "string",
            "value": "/messages"
          }
        ],
        "LocalMetadata": {
          "__local36__": {
            "name": "__local36__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 29,
              "col": 16
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Enter",
        "Node": {
          "head": {
            "name": "accessToResourceNotAllowed",
            "key": {
              "type": "var",
              "value": "__local0__"
            }
          },
          "body": [
            {
              "index": 0,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "jwtDecoded"
                    }
                  ]
                },
                {
                  "type": "object",
                  "value": []
                }
              ]
            },
            {
              "index": 1,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local0__"
                },
                {
                  "type": "string",
                  "value": "Invalid input, missing JWT"
                }
              ]
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 12,
          "col": 1
        },
        "QueryID": 19,
        "ParentID": 8,
        "Locals": null,
        "LocalMetadata": {
          "__local0__": {
            "name": "reason",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 12,
              "col": 28
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Fail",
        "Node": {
          "index": 0,
          "terms": [
            {
              "type": "ref",
              "value": [
                {
                  "type": "var",
                  "value": "eq"
                }
              ]
            },
            {
              "type": "ref",
              "value": [
                {
                  "type": "var",
                  "value": "data"
                },
                {
                  "type": "string",
                  "value": "http"
                },
                {
                  "type": "string",
                  "value": "request"
                },
                {
                  "type": "string",
                  "value": "authz"
                },
                {
                  "type": "string",
                  "value": "jwtDecoded"
                }
              ]
            },
            {
              "type": "object",
              "value": []
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 13,
          "col": 5
        },
        "QueryID": 19,
        "ParentID": 8,
        "Locals": null,
        "LocalMetadata": {},
        "Message": ""
      },
      {
        "Op": "Enter",
        "Node": {
          "head": {
            "name": "accessToResourceNotAllowed",
            "key": {
              "type": "var",
              "value": "__local1__"
            }
          },
          "body": [
            {
              "index": 0,
              "negated": true,
              "terms": {
                "type": "ref",
                "value": [
                  {
                    "type": "var",
                    "value": "input"
                  },
                  {
                    "type": "string",
                    "value": "path"
                  }
                ]
              }
            },
            {
              "index": 1,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local1__"
                },
                {
                  "type": "string",
                  "value": "Invalid input, can't extract path"
                }
              ]
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 17,
          "col": 1
        },
        "QueryID": 20,
        "ParentID": 8,
        "Locals": null,
        "LocalMetadata": {
          "__local1__": {
            "name": "reason",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 17,
              "col": 28
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Fail",
        "Node": {
          "index": 0,
          "negated": true,
          "terms": {
            "type": "ref",
            "value": [
              {
                "type": "var",
                "value": "input"
              },
              {
                "type": "string",
                "value": "path"
              }
            ]
          }
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 18,
          "col": 9
        },
        "QueryID": 20,
        "ParentID": 8,
        "Locals": null,
        "LocalMetadata": {},
        "Message": ""
      },
      {
        "Op": "Enter",
        "Node": {
          "head": {
            "name": "accessToResourceNotAllowed",
            "key": {
              "type": "var",
              "value": "__local2__"
            }
          },
          "body": [
            {
              "generated": true,
              "index": 0,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local31__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "input"
                    },
                    {
                      "type": "string",
                      "value": "path"
                    }
                  ]
                }
              ]
            },
            {
              "index": 1,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "startswith"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local31__"
                },
                {
                  "type": "string",
                  "value": "/messages"
                }
              ]
            },
            {
              "generated": true,
              "index": 2,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local32__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "groupsFromJwt"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 3,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local33__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "allowedGroups"
                    }
                  ]
                }
              ]
            },
            {
              "index": 4,
              "negated": true,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "lists_intersect"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local32__"
                },
                {
                  "type": "var",
                  "value": "__local33__"
                }
              ]
            },
            {
              "generated": true,
              "index": 5,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local34__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "input"
                    },
                    {
                      "type": "string",
                      "value": "path"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 6,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local35__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "allowedGroups"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 7,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "sprintf"
                    }
                  ]
                },
                {
                  "type": "string",
                  "value": "Not allowed to access '%v', required group: '%v'"
                },
                {
                  "type": "array",
                  "value": [
                    {
                      "type": "var",
                      "value": "__local34__"
                    },
                    {
                      "type": "var",
                      "value": "__local35__"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local14__"
                }
              ]
            },
            {
              "index": 8,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local2__"
                },
                {
                  "type": "var",
                  "value": "__local14__"
                }
              ]
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 22,
          "col": 1
        },
        "QueryID": 22,
        "ParentID": 8,
        "Locals": null,
        "LocalMetadata": {
          "__local2__": {
            "name": "reason",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 22,
              "col": 28
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Enter",
        "Node": [
          {
            "index": 0,
            "terms": [
              {
                "type": "ref",
                "value": [
                  {
                    "type": "var",
                    "value": "data"
                  },
                  {
                    "type": "string",
                    "value": "http"
                  },
                  {
                    "type": "string",
                    "value": "request"
                  },
                  {
                    "type": "string",
                    "value": "authz"
                  },
                  {
                    "type": "string",
                    "value": "lists_intersect"
                  }
                ]
              },
              {
                "type": "var",
                "value": "__local32__"
              },
              {
                "type": "var",
                "value": "__local33__"
              }
            ]
          }
        ],
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 24,
          "col": 9
        },
        "QueryID": 23,
        "ParentID": 22,
        "Locals": [
          {
            "name": "__local33__",
            "type": "array",
            "value": [
              {
                "type": "string",
                "value": "sec-ODP-Developer"
              },
              {
                "type": "string",
                "value": "sec-ODP-Data-Controller"
              }
            ]
          },
          {
            "name": "__local31__",
            "type": "string",
            "value": "/messages"
          },
          {
            "name": "__local32__",
            "type": "array",
            "value": [
              {
                "type": "string",
                "value": ""
              }
            ]
          }
        ],
        "LocalMetadata": {
          "__local31__": {
            "name": "__local31__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 23,
              "col": 16
            }
          },
          "__local32__": {
            "name": "__local32__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 24,
              "col": 25
            }
          },
          "__local33__": {
            "name": "__local33__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 24,
              "col": 40
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Enter",
        "Node": {
          "head": {
            "name": "lists_intersect",
            "args": [
              {
                "type": "var",
                "value": "list1"
              },
              {
                "type": "var",
                "value": "list2"
              }
            ],
            "value": {
              "type": "boolean",
              "value": true
            }
          },
          "body": [
            {
              "index": 0,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "list1"
                    },
                    {
                      "type": "var",
                      "value": "$2"
                    }
                  ]
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "list2"
                    },
                    {
                      "type": "var",
                      "value": "$3"
                    }
                  ]
                }
              ]
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 75,
          "col": 1
        },
        "QueryID": 24,
        "ParentID": 23,
        "Locals": null,
        "LocalMetadata": {},
        "Message": ""
      },
      {
        "Op": "Fail",
        "Node": {
          "index": 0,
          "terms": [
            {
              "type": "ref",
              "value": [
                {
                  "type": "var",
                  "value": "eq"
                }
              ]
            },
            {
              "type": "ref",
              "value": [
                {
                  "type": "var",
                  "value": "list1"
                },
                {
                  "type": "var",
                  "value": "$2"
                }
              ]
            },
            {
              "type": "ref",
              "value": [
                {
                  "type": "var",
                  "value": "list2"
                },
                {
                  "type": "var",
                  "value": "$3"
                }
              ]
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 76,
          "col": 5
        },
        "QueryID": 24,
        "ParentID": 23,
        "Locals": [
          {
            "name": "list1",
            "type": "array",
            "value": [
              {
                "type": "string",
                "value": ""
              }
            ]
          },
          {
            "name": "list2",
            "type": "array",
            "value": [
              {
                "type": "string",
                "value": "sec-ODP-Developer"
              },
              {
                "type": "string",
                "value": "sec-ODP-Data-Controller"
              }
            ]
          }
        ],
        "LocalMetadata": {
          "list1": {
            "name": "list1",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 75,
              "col": 17
            }
          },
          "list2": {
            "name": "list2",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 75,
              "col": 24
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Fail",
        "Node": {
          "index": 0,
          "terms": [
            {
              "type": "ref",
              "value": [
                {
                  "type": "var",
                  "value": "data"
                },
                {
                  "type": "string",
                  "value": "http"
                },
                {
                  "type": "string",
                  "value": "request"
                },
                {
                  "type": "string",
                  "value": "authz"
                },
                {
                  "type": "string",
                  "value": "lists_intersect"
                }
              ]
            },
            {
              "type": "var",
              "value": "__local32__"
            },
            {
              "type": "var",
              "value": "__local33__"
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 24,
          "col": 9
        },
        "QueryID": 23,
        "ParentID": 22,
        "Locals": [
          {
            "name": "__local33__",
            "type": "array",
            "value": [
              {
                "type": "string",
                "value": "sec-ODP-Developer"
              },
              {
                "type": "string",
                "value": "sec-ODP-Data-Controller"
              }
            ]
          },
          {
            "name": "__local31__",
            "type": "string",
            "value": "/messages"
          },
          {
            "name": "__local32__",
            "type": "array",
            "value": [
              {
                "type": "string",
                "value": ""
              }
            ]
          }
        ],
        "LocalMetadata": {
          "__local31__": {
            "name": "__local31__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 23,
              "col": 16
            }
          },
          "__local32__": {
            "name": "__local32__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 24,
              "col": 25
            }
          },
          "__local33__": {
            "name": "__local33__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 24,
              "col": 40
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Enter",
        "Node": {
          "head": {
            "name": "accessToResourceNotAllowed",
            "key": {
              "type": "var",
              "value": "__local3__"
            }
          },
          "body": [
            {
              "generated": true,
              "index": 0,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local36__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "input"
                    },
                    {
                      "type": "string",
                      "value": "path"
                    }
                  ]
                }
              ]
            },
            {
              "index": 1,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "startswith"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local36__"
                },
                {
                  "type": "string",
                  "value": "/statistics"
                }
              ]
            },
            {
              "generated": true,
              "index": 2,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local37__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "groupsFromJwt"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 3,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local38__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "allowedGroups"
                    }
                  ]
                }
              ]
            },
            {
              "index": 4,
              "negated": true,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "lists_intersect"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local37__"
                },
                {
                  "type": "var",
                  "value": "__local38__"
                }
              ]
            },
            {
              "generated": true,
              "index": 5,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local39__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "input"
                    },
                    {
                      "type": "string",
                      "value": "path"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 6,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local40__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "allowedGroups"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 7,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "sprintf"
                    }
                  ]
                },
                {
                  "type": "string",
                  "value": "Not allowed to access '%v', required group: '%v'"
                },
                {
                  "type": "array",
                  "value": [
                    {
                      "type": "var",
                      "value": "__local39__"
                    },
                    {
                      "type": "var",
                      "value": "__local40__"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local15__"
                }
              ]
            },
            {
              "index": 8,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local3__"
                },
                {
                  "type": "var",
                  "value": "__local15__"
                }
              ]
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 28,
          "col": 1
        },
        "QueryID": 25,
        "ParentID": 8,
        "Locals": null,
        "LocalMetadata": {
          "__local3__": {
            "name": "reason",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 28,
              "col": 28
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Fail",
        "Node": {
          "index": 1,
          "terms": [
            {
              "type": "ref",
              "value": [
                {
                  "type": "var",
                  "value": "startswith"
                }
              ]
            },
            {
              "type": "var",
              "value": "__local36__"
            },
            {
              "type": "string",
              "value": "/statistics"
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 29,
          "col": 5
        },
        "QueryID": 25,
        "ParentID": 8,
        "Locals": [
          {
            "name": "__local36__",
            "type": "string",
            "value": "/messages"
          }
        ],
        "LocalMetadata": {
          "__local36__": {
            "name": "__local36__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 29,
              "col": 16
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Fail",
        "Node": {
          "index": 0,
          "terms": {
            "type": "ref",
            "value": [
              {
                "type": "var",
                "value": "data"
              },
              {
                "type": "string",
                "value": "http"
              },
              {
                "type": "string",
                "value": "request"
              },
              {
                "type": "string",
                "value": "authz"
              },
              {
                "type": "string",
                "value": "allow"
              }
            ]
          }
        },
        "Location": {
          "file": "src/test/resources/opa/policies/policies-test.rego",
          "row": 26,
          "col": 9
        },
        "QueryID": 3,
        "ParentID": 1,
        "Locals": [
          {
            "name": "__local22__",
            "type": "string",
            "value": "eyJhbGciOiAiUlMyNTYiLCAidHlwIjogIkpXVCJ9.eyJjbGllbnRfaWQiOiAib2RwLWRpc21pdCIsICJleHAiOiAxNTgxOTU3NzIxLCAib2RwIjogeyJncm91cHMiOiBbIiJdfSwgInB1cnBvc2UiOiAiYWNjZXNzX3Rva2VuIiwgInNjb3BlIjogIm9wYS1kaXNtaXQiLCAidXNlcm5hbWUiOiAib2RwLWRpc21pdCJ9.V60AwDLqzNfzfOd-R0gxqPHaYU3ok91ogwAvttSuIoZERfevj9qNwaKtp0vfSgpMwAPleXAgDB1ACQbK7ZlQpgqO9npZw3gEELPJaAUcigJs1YgWRz7Yhy1cSDQULK5LycecO_iMPnJtTLR1jrKGdbe-THdXylt2XADxU2MzYHvebf9gNNUZhW_cFyT9RoyxnkPt5t3ktv-WGhwu9x95iedSSQtP3ktuWTOXjavURcVRLwlL7RV1Z5sjcniiMfWNYFcXRQOemKMqvqWIkTzzuaQOCbBIp-gp00EvkNi2-9FFnzZ2_mxha95WSFMypQl5HzCgiPyl3PJ_XExuXRPjLg"
          },
          {
            "name": "__local7__",
            "type": "string",
            "value": "eyJhbGciOiAiUlMyNTYiLCAidHlwIjogIkpXVCJ9.eyJjbGllbnRfaWQiOiAib2RwLWRpc21pdCIsICJleHAiOiAxNTgxOTU3NzIxLCAib2RwIjogeyJncm91cHMiOiBbIiJdfSwgInB1cnBvc2UiOiAiYWNjZXNzX3Rva2VuIiwgInNjb3BlIjogIm9wYS1kaXNtaXQiLCAidXNlcm5hbWUiOiAib2RwLWRpc21pdCJ9.V60AwDLqzNfzfOd-R0gxqPHaYU3ok91ogwAvttSuIoZERfevj9qNwaKtp0vfSgpMwAPleXAgDB1ACQbK7ZlQpgqO9npZw3gEELPJaAUcigJs1YgWRz7Yhy1cSDQULK5LycecO_iMPnJtTLR1jrKGdbe-THdXylt2XADxU2MzYHvebf9gNNUZhW_cFyT9RoyxnkPt5t3ktv-WGhwu9x95iedSSQtP3ktuWTOXjavURcVRLwlL7RV1Z5sjcniiMfWNYFcXRQOemKMqvqWIkTzzuaQOCbBIp-gp00EvkNi2-9FFnzZ2_mxha95WSFMypQl5HzCgiPyl3PJ_XExuXRPjLg"
          }
        ],
        "LocalMetadata": {
          "__local22__": {
            "name": "__local22__",
            "location": {
              "file": "src/test/resources/opa/policies/policies-test.rego",
              "row": 25,
              "col": 12
            }
          },
          "__local7__": {
            "name": "jwt",
            "location": {
              "file": "src/test/resources/opa/policies/policies-test.rego",
              "row": 25,
              "col": 5
            }
          }
        },
        "Message": ""
      }
    ]
  },
  {
    "location": {
      "file": "src/test/resources/opa/policies/policies-test.rego",
      "row": 29,
      "col": 1
    },
    "package": "data.http.request.authz",
    "name": "test_not_allow_if_jwt_with_wrong_group_for_messages",
    "duration": 1955410,
    "trace": [
      {
        "Op": "Enter",
        "Node": [
          {
            "index": 0,
            "terms": [
              {
                "type": "ref",
                "value": [
                  {
                    "type": "var",
                    "value": "eq"
                  }
                ]
              },
              {
                "type": "ref",
                "value": [
                  {
                    "type": "var",
                    "value": "data"
                  },
                  {
                    "type": "string",
                    "value": "http"
                  },
                  {
                    "type": "string",
                    "value": "request"
                  },
                  {
                    "type": "string",
                    "value": "authz"
                  },
                  {
                    "type": "string",
                    "value": "test_not_allow_if_jwt_with_wrong_group_for_messages"
                  }
                ]
              },
              {
                "type": "var",
                "value": "$term1"
              }
            ]
          }
        ],
        "Location": {
          "file": "",
          "row": 1,
          "col": 1
        },
        "QueryID": 0,
        "ParentID": 0,
        "Locals": null,
        "LocalMetadata": {},
        "Message": ""
      },
      {
        "Op": "Enter",
        "Node": {
          "head": {
            "name": "test_not_allow_if_jwt_with_wrong_group_for_messages",
            "value": {
              "type": "boolean",
              "value": true
            }
          },
          "body": [
            {
              "generated": true,
              "index": 0,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "generateJWT"
                    }
                  ]
                },
                {
                  "type": "string",
                  "value": "wrong"
                },
                {
                  "type": "var",
                  "value": "__local23__"
                }
              ]
            },
            {
              "index": 1,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local8__"
                },
                {
                  "type": "var",
                  "value": "__local23__"
                }
              ]
            },
            {
              "index": 2,
              "negated": true,
              "terms": {
                "type": "ref",
                "value": [
                  {
                    "type": "var",
                    "value": "data"
                  },
                  {
                    "type": "string",
                    "value": "http"
                  },
                  {
                    "type": "string",
                    "value": "request"
                  },
                  {
                    "type": "string",
                    "value": "authz"
                  },
                  {
                    "type": "string",
                    "value": "allow"
                  }
                ]
              },
              "with": [
                {
                  "target": {
                    "type": "ref",
                    "value": [
                      {
                        "type": "var",
                        "value": "input"
                      }
                    ]
                  },
                  "value": {
                    "type": "object",
                    "value": [
                      [
                        {
                          "type": "string",
                          "value": "encodedJwt"
                        },
                        {
                          "type": "var",
                          "value": "__local8__"
                        }
                      ],
                      [
                        {
                          "type": "string",
                          "value": "path"
                        },
                        {
                          "type": "string",
                          "value": "/messages"
                        }
                      ]
                    ]
                  }
                }
              ]
            }
          ]
        },
        "Location": {
          "file": "src/test/resources/opa/policies/policies-test.rego",
          "row": 29,
          "col": 1
        },
        "QueryID": 1,
        "ParentID": 0,
        "Locals": null,
        "LocalMetadata": {
          "__local8__": {
            "name": "jwt",
            "location": {
              "file": "src/test/resources/opa/policies/policies-test.rego",
              "row": 30,
              "col": 5
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Enter",
        "Node": [
          {
            "index": 0,
            "terms": {
              "type": "ref",
              "value": [
                {
                  "type": "var",
                  "value": "data"
                },
                {
                  "type": "string",
                  "value": "http"
                },
                {
                  "type": "string",
                  "value": "request"
                },
                {
                  "type": "string",
                  "value": "authz"
                },
                {
                  "type": "string",
                  "value": "allow"
                }
              ]
            }
          }
        ],
        "Location": {
          "file": "src/test/resources/opa/policies/policies-test.rego",
          "row": 31,
          "col": 9
        },
        "QueryID": 3,
        "ParentID": 1,
        "Locals": [
          {
            "name": "__local23__",
            "type": "string",
            "value": "eyJhbGciOiAiUlMyNTYiLCAidHlwIjogIkpXVCJ9.eyJjbGllbnRfaWQiOiAib2RwLWRpc21pdCIsICJleHAiOiAxNTgxOTU3NzIxLCAib2RwIjogeyJncm91cHMiOiBbIndyb25nIl19LCAicHVycG9zZSI6ICJhY2Nlc3NfdG9rZW4iLCAic2NvcGUiOiAib3BhLWRpc21pdCIsICJ1c2VybmFtZSI6ICJvZHAtZGlzbWl0In0.exb4VEfitRcIoAk6motT8VgqK5B8PAZGxf_cTra7WYoevx0eKdtUG-ARtT4j24luQlzUkvhzGLaAMQd5ZmnnW2lA5LvXAFNt2S0eJixA-3K_xrfYn_qp91FWN8OFE9PhVqGFim-klo7V5mhQWR95K0MYcYW4fgQQ2bkBMwirGlH60r1l-yeyL5t376iB71eWSgEjgFqYP6w5I4wDbetblgRisLRu2Da0roMfHXPN1E2-JUMCobfMrUHeqVSl_-gSn1gwMT_BjO4BzaM0csCVfmSwY7AUaYz6vwAE4HNHbz4o9TzoS_WyZoQVLJeNrz1JeTJBrEFlxD7Kzo_XuOGMeA"
          },
          {
            "name": "__local8__",
            "type": "string",
            "value": "eyJhbGciOiAiUlMyNTYiLCAidHlwIjogIkpXVCJ9.eyJjbGllbnRfaWQiOiAib2RwLWRpc21pdCIsICJleHAiOiAxNTgxOTU3NzIxLCAib2RwIjogeyJncm91cHMiOiBbIndyb25nIl19LCAicHVycG9zZSI6ICJhY2Nlc3NfdG9rZW4iLCAic2NvcGUiOiAib3BhLWRpc21pdCIsICJ1c2VybmFtZSI6ICJvZHAtZGlzbWl0In0.exb4VEfitRcIoAk6motT8VgqK5B8PAZGxf_cTra7WYoevx0eKdtUG-ARtT4j24luQlzUkvhzGLaAMQd5ZmnnW2lA5LvXAFNt2S0eJixA-3K_xrfYn_qp91FWN8OFE9PhVqGFim-klo7V5mhQWR95K0MYcYW4fgQQ2bkBMwirGlH60r1l-yeyL5t376iB71eWSgEjgFqYP6w5I4wDbetblgRisLRu2Da0roMfHXPN1E2-JUMCobfMrUHeqVSl_-gSn1gwMT_BjO4BzaM0csCVfmSwY7AUaYz6vwAE4HNHbz4o9TzoS_WyZoQVLJeNrz1JeTJBrEFlxD7Kzo_XuOGMeA"
          }
        ],
        "LocalMetadata": {
          "__local23__": {
            "name": "__local23__",
            "location": {
              "file": "src/test/resources/opa/policies/policies-test.rego",
              "row": 30,
              "col": 12
            }
          },
          "__local8__": {
            "name": "jwt",
            "location": {
              "file": "src/test/resources/opa/policies/policies-test.rego",
              "row": 30,
              "col": 5
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Enter",
        "Node": {
          "head": {
            "name": "allow",
            "value": {
              "type": "var",
              "value": "__local29__"
            }
          },
          "body": [
            {
              "index": 0,
              "terms": {
                "type": "boolean",
                "value": true
              }
            },
            {
              "generated": true,
              "index": 1,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local29__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "status"
                    },
                    {
                      "type": "string",
                      "value": "allowed"
                    }
                  ]
                }
              ]
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 47,
          "col": 9
        },
        "QueryID": 4,
        "ParentID": 3,
        "Locals": null,
        "LocalMetadata": {},
        "Message": ""
      },
      {
        "Op": "Enter",
        "Node": {
          "head": {
            "name": "status",
            "value": {
              "type": "object",
              "value": [
                [
                  {
                    "type": "string",
                    "value": "allowed"
                  },
                  {
                    "type": "boolean",
                    "value": true
                  }
                ],
                [
                  {
                    "type": "string",
                    "value": "reason"
                  },
                  {
                    "type": "var",
                    "value": "__local17__"
                  }
                ]
              ]
            }
          },
          "body": [
            {
              "generated": true,
              "index": 0,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local44__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "accessToWhitelistAllowed"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 1,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "count"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local44__"
                },
                {
                  "type": "var",
                  "value": "__local18__"
                }
              ]
            },
            {
              "index": 2,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "gt"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local18__"
                },
                {
                  "type": "number",
                  "value": 0
                }
              ]
            },
            {
              "generated": true,
              "index": 3,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local45__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "accessToWhitelistAllowed"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 4,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "concat"
                    }
                  ]
                },
                {
                  "type": "string",
                  "value": " | "
                },
                {
                  "type": "var",
                  "value": "__local45__"
                },
                {
                  "type": "var",
                  "value": "__local17__"
                }
              ]
            }
          ],
          "else": {
            "head": {
              "name": "status",
              "value": {
                "type": "object",
                "value": [
                  [
                    {
                      "type": "string",
                      "value": "allowed"
                    },
                    {
                      "type": "boolean",
                      "value": false
                    }
                  ],
                  [
                    {
                      "type": "string",
                      "value": "reason"
                    },
                    {
                      "type": "var",
                      "value": "__local19__"
                    }
                  ]
                ]
              }
            },
            "body": [
              {
                "generated": true,
                "index": 0,
                "terms": [
                  {
                    "type": "ref",
                    "value": [
                      {
                        "type": "var",
                        "value": "eq"
                      }
                    ]
                  },
                  {
                    "type": "var",
                    "value": "__local46__"
                  },
                  {
                    "type": "ref",
                    "value": [
                      {
                        "type": "var",
                        "value": "data"
                      },
                      {
                        "type": "string",
                        "value": "http"
                      },
                      {
                        "type": "string",
                        "value": "request"
                      },
                      {
                        "type": "string",
                        "value": "authz"
                      },
                      {
                        "type": "string",
                        "value": "accessToResourceNotAllowed"
                      }
                    ]
                  }
                ]
              },
              {
                "generated": true,
                "index": 1,
                "terms": [
                  {
                    "type": "ref",
                    "value": [
                      {
                        "type": "var",
                        "value": "count"
                      }
                    ]
                  },
                  {
                    "type": "var",
                    "value": "__local46__"
                  },
                  {
                    "type": "var",
                    "value": "__local20__"
                  }
                ]
              },
              {
                "index": 2,
                "terms": [
                  {
                    "type": "ref",
                    "value": [
                      {
                        "type": "var",
                        "value": "gt"
                      }
                    ]
                  },
                  {
                    "type": "var",
                    "value": "__local20__"
                  },
                  {
                    "type": "number",
                    "value": 0
                  }
                ]
              },
              {
                "generated": true,
                "index": 3,
                "terms": [
                  {
                    "type": "ref",
                    "value": [
                      {
                        "type": "var",
                        "value": "eq"
                      }
                    ]
                  },
                  {
                    "type": "var",
                    "value": "__local47__"
                  },
                  {
                    "type": "ref",
                    "value": [
                      {
                        "type": "var",
                        "value": "data"
                      },
                      {
                        "type": "string",
                        "value": "http"
                      },
                      {
                        "type": "string",
                        "value": "request"
                      },
                      {
                        "type": "string",
                        "value": "authz"
                      },
                      {
                        "type": "string",
                        "value": "accessToResourceNotAllowed"
                      }
                    ]
                  }
                ]
              },
              {
                "generated": true,
                "index": 4,
                "terms": [
                  {
                    "type": "ref",
                    "value": [
                      {
                        "type": "var",
                        "value": "concat"
                      }
                    ]
                  },
                  {
                    "type": "string",
                    "value": " | "
                  },
                  {
                    "type": "var",
                    "value": "__local47__"
                  },
                  {
                    "type": "var",
                    "value": "__local19__"
                  }
                ]
              }
            ],
            "else": {
              "head": {
                "name": "status",
                "value": {
                  "type": "object",
                  "value": [
                    [
                      {
                        "type": "string",
                        "value": "allowed"
                      },
                      {
                        "type": "boolean",
                        "value": true
                      }
                    ],
                    [
                      {
                        "type": "string",
                        "value": "reason"
                      },
                      {
                        "type": "string",
                        "value": "Access allowed, all rules passed"
                      }
                    ]
                  ]
                }
              },
              "body": [
                {
                  "index": 0,
                  "terms": {
                    "type": "boolean",
                    "value": true
                  }
                }
              ]
            }
          }
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 39,
          "col": 1
        },
        "QueryID": 5,
        "ParentID": 4,
        "Locals": null,
        "LocalMetadata": {},
        "Message": ""
      },
      {
        "Op": "Enter",
        "Node": {
          "head": {
            "name": "accessToWhitelistAllowed",
            "key": {
              "type": "var",
              "value": "__local4__"
            }
          },
          "body": [
            {
              "generated": true,
              "index": 0,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local41__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "input"
                    },
                    {
                      "type": "string",
                      "value": "path"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 1,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local42__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "whitelistedEndpoints"
                    },
                    {
                      "type": "var",
                      "value": "$0"
                    }
                  ]
                }
              ]
            },
            {
              "index": 2,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "startswith"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local41__"
                },
                {
                  "type": "var",
                  "value": "__local42__"
                }
              ]
            },
            {
              "generated": true,
              "index": 3,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local43__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "input"
                    },
                    {
                      "type": "string",
                      "value": "path"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 4,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "sprintf"
                    }
                  ]
                },
                {
                  "type": "string",
                  "value": "Resource '%v' on whitelist"
                },
                {
                  "type": "array",
                  "value": [
                    {
                      "type": "var",
                      "value": "__local43__"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local16__"
                }
              ]
            },
            {
              "index": 5,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local4__"
                },
                {
                  "type": "var",
                  "value": "__local16__"
                }
              ]
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 34,
          "col": 1
        },
        "QueryID": 6,
        "ParentID": 5,
        "Locals": null,
        "LocalMetadata": {
          "__local4__": {
            "name": "reason",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 34,
              "col": 26
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Fail",
        "Node": {
          "index": 2,
          "terms": [
            {
              "type": "ref",
              "value": [
                {
                  "type": "var",
                  "value": "startswith"
                }
              ]
            },
            {
              "type": "var",
              "value": "__local41__"
            },
            {
              "type": "var",
              "value": "__local42__"
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 35,
          "col": 5
        },
        "QueryID": 6,
        "ParentID": 5,
        "Locals": [
          {
            "name": "__local41__",
            "type": "string",
            "value": "/messages"
          },
          {
            "name": "_",
            "type": "number",
            "value": 0
          },
          {
            "name": "__local42__",
            "type": "string",
            "value": "/ping"
          }
        ],
        "LocalMetadata": {
          "$0": {
            "name": "$0",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 35,
              "col": 49
            }
          },
          "__local41__": {
            "name": "__local41__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 35,
              "col": 16
            }
          },
          "__local42__": {
            "name": "__local42__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 35,
              "col": 28
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Fail",
        "Node": {
          "index": 2,
          "terms": [
            {
              "type": "ref",
              "value": [
                {
                  "type": "var",
                  "value": "startswith"
                }
              ]
            },
            {
              "type": "var",
              "value": "__local41__"
            },
            {
              "type": "var",
              "value": "__local42__"
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 35,
          "col": 5
        },
        "QueryID": 6,
        "ParentID": 5,
        "Locals": [
          {
            "name": "__local41__",
            "type": "string",
            "value": "/messages"
          },
          {
            "name": "_",
            "type": "number",
            "value": 1
          },
          {
            "name": "__local42__",
            "type": "string",
            "value": "/error"
          }
        ],
        "LocalMetadata": {
          "$0": {
            "name": "$0",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 35,
              "col": 49
            }
          },
          "__local41__": {
            "name": "__local41__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 35,
              "col": 16
            }
          },
          "__local42__": {
            "name": "__local42__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 35,
              "col": 28
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Fail",
        "Node": {
          "index": 2,
          "terms": [
            {
              "type": "ref",
              "value": [
                {
                  "type": "var",
                  "value": "startswith"
                }
              ]
            },
            {
              "type": "var",
              "value": "__local41__"
            },
            {
              "type": "var",
              "value": "__local42__"
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 35,
          "col": 5
        },
        "QueryID": 6,
        "ParentID": 5,
        "Locals": [
          {
            "name": "__local41__",
            "type": "string",
            "value": "/messages"
          },
          {
            "name": "_",
            "type": "number",
            "value": 2
          },
          {
            "name": "__local42__",
            "type": "string",
            "value": "/health"
          }
        ],
        "LocalMetadata": {
          "$0": {
            "name": "$0",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 35,
              "col": 49
            }
          },
          "__local41__": {
            "name": "__local41__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 35,
              "col": 16
            }
          },
          "__local42__": {
            "name": "__local42__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 35,
              "col": 28
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Fail",
        "Node": {
          "index": 2,
          "terms": [
            {
              "type": "ref",
              "value": [
                {
                  "type": "var",
                  "value": "gt"
                }
              ]
            },
            {
              "type": "var",
              "value": "__local18__"
            },
            {
              "type": "number",
              "value": 0
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 40,
          "col": 5
        },
        "QueryID": 5,
        "ParentID": 4,
        "Locals": [
          {
            "name": "__local18__",
            "type": "number",
            "value": 0
          },
          {
            "name": "__local44__",
            "type": "set",
            "value": []
          }
        ],
        "LocalMetadata": {
          "__local18__": {
            "name": "__local18__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 40,
              "col": 5
            }
          },
          "__local44__": {
            "name": "__local44__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 40,
              "col": 11
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Enter",
        "Node": {
          "head": {
            "name": "status",
            "value": {
              "type": "object",
              "value": [
                [
                  {
                    "type": "string",
                    "value": "allowed"
                  },
                  {
                    "type": "boolean",
                    "value": false
                  }
                ],
                [
                  {
                    "type": "string",
                    "value": "reason"
                  },
                  {
                    "type": "var",
                    "value": "__local19__"
                  }
                ]
              ]
            }
          },
          "body": [
            {
              "generated": true,
              "index": 0,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local46__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "accessToResourceNotAllowed"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 1,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "count"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local46__"
                },
                {
                  "type": "var",
                  "value": "__local20__"
                }
              ]
            },
            {
              "index": 2,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "gt"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local20__"
                },
                {
                  "type": "number",
                  "value": 0
                }
              ]
            },
            {
              "generated": true,
              "index": 3,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local47__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "accessToResourceNotAllowed"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 4,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "concat"
                    }
                  ]
                },
                {
                  "type": "string",
                  "value": " | "
                },
                {
                  "type": "var",
                  "value": "__local47__"
                },
                {
                  "type": "var",
                  "value": "__local19__"
                }
              ]
            }
          ],
          "else": {
            "head": {
              "name": "status",
              "value": {
                "type": "object",
                "value": [
                  [
                    {
                      "type": "string",
                      "value": "allowed"
                    },
                    {
                      "type": "boolean",
                      "value": true
                    }
                  ],
                  [
                    {
                      "type": "string",
                      "value": "reason"
                    },
                    {
                      "type": "string",
                      "value": "Access allowed, all rules passed"
                    }
                  ]
                ]
              }
            },
            "body": [
              {
                "index": 0,
                "terms": {
                  "type": "boolean",
                  "value": true
                }
              }
            ]
          }
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 41,
          "col": 3
        },
        "QueryID": 8,
        "ParentID": 4,
        "Locals": null,
        "LocalMetadata": {},
        "Message": ""
      },
      {
        "Op": "Enter",
        "Node": {
          "head": {
            "name": "accessToResourceNotAllowed",
            "key": {
              "type": "var",
              "value": "__local0__"
            }
          },
          "body": [
            {
              "index": 0,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "jwtDecoded"
                    }
                  ]
                },
                {
                  "type": "object",
                  "value": []
                }
              ]
            },
            {
              "index": 1,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local0__"
                },
                {
                  "type": "string",
                  "value": "Invalid input, missing JWT"
                }
              ]
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 12,
          "col": 1
        },
        "QueryID": 9,
        "ParentID": 8,
        "Locals": null,
        "LocalMetadata": {
          "__local0__": {
            "name": "reason",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 12,
              "col": 28
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Fail",
        "Node": {
          "index": 0,
          "terms": [
            {
              "type": "ref",
              "value": [
                {
                  "type": "var",
                  "value": "eq"
                }
              ]
            },
            {
              "type": "ref",
              "value": [
                {
                  "type": "var",
                  "value": "data"
                },
                {
                  "type": "string",
                  "value": "http"
                },
                {
                  "type": "string",
                  "value": "request"
                },
                {
                  "type": "string",
                  "value": "authz"
                },
                {
                  "type": "string",
                  "value": "jwtDecoded"
                }
              ]
            },
            {
              "type": "object",
              "value": []
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 13,
          "col": 5
        },
        "QueryID": 9,
        "ParentID": 8,
        "Locals": null,
        "LocalMetadata": {},
        "Message": ""
      },
      {
        "Op": "Enter",
        "Node": {
          "head": {
            "name": "accessToResourceNotAllowed",
            "key": {
              "type": "var",
              "value": "__local1__"
            }
          },
          "body": [
            {
              "index": 0,
              "negated": true,
              "terms": {
                "type": "ref",
                "value": [
                  {
                    "type": "var",
                    "value": "input"
                  },
                  {
                    "type": "string",
                    "value": "path"
                  }
                ]
              }
            },
            {
              "index": 1,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local1__"
                },
                {
                  "type": "string",
                  "value": "Invalid input, can't extract path"
                }
              ]
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 17,
          "col": 1
        },
        "QueryID": 11,
        "ParentID": 8,
        "Locals": null,
        "LocalMetadata": {
          "__local1__": {
            "name": "reason",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 17,
              "col": 28
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Fail",
        "Node": {
          "index": 0,
          "negated": true,
          "terms": {
            "type": "ref",
            "value": [
              {
                "type": "var",
                "value": "input"
              },
              {
                "type": "string",
                "value": "path"
              }
            ]
          }
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 18,
          "col": 9
        },
        "QueryID": 11,
        "ParentID": 8,
        "Locals": null,
        "LocalMetadata": {},
        "Message": ""
      },
      {
        "Op": "Enter",
        "Node": {
          "head": {
            "name": "accessToResourceNotAllowed",
            "key": {
              "type": "var",
              "value": "__local2__"
            }
          },
          "body": [
            {
              "generated": true,
              "index": 0,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local31__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "input"
                    },
                    {
                      "type": "string",
                      "value": "path"
                    }
                  ]
                }
              ]
            },
            {
              "index": 1,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "startswith"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local31__"
                },
                {
                  "type": "string",
                  "value": "/messages"
                }
              ]
            },
            {
              "generated": true,
              "index": 2,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local32__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "groupsFromJwt"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 3,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local33__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "allowedGroups"
                    }
                  ]
                }
              ]
            },
            {
              "index": 4,
              "negated": true,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "lists_intersect"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local32__"
                },
                {
                  "type": "var",
                  "value": "__local33__"
                }
              ]
            },
            {
              "generated": true,
              "index": 5,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local34__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "input"
                    },
                    {
                      "type": "string",
                      "value": "path"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 6,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local35__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "allowedGroups"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 7,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "sprintf"
                    }
                  ]
                },
                {
                  "type": "string",
                  "value": "Not allowed to access '%v', required group: '%v'"
                },
                {
                  "type": "array",
                  "value": [
                    {
                      "type": "var",
                      "value": "__local34__"
                    },
                    {
                      "type": "var",
                      "value": "__local35__"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local14__"
                }
              ]
            },
            {
              "index": 8,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local2__"
                },
                {
                  "type": "var",
                  "value": "__local14__"
                }
              ]
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 22,
          "col": 1
        },
        "QueryID": 13,
        "ParentID": 8,
        "Locals": null,
        "LocalMetadata": {
          "__local2__": {
            "name": "reason",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 22,
              "col": 28
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Enter",
        "Node": [
          {
            "index": 0,
            "terms": [
              {
                "type": "ref",
                "value": [
                  {
                    "type": "var",
                    "value": "data"
                  },
                  {
                    "type": "string",
                    "value": "http"
                  },
                  {
                    "type": "string",
                    "value": "request"
                  },
                  {
                    "type": "string",
                    "value": "authz"
                  },
                  {
                    "type": "string",
                    "value": "lists_intersect"
                  }
                ]
              },
              {
                "type": "var",
                "value": "__local32__"
              },
              {
                "type": "var",
                "value": "__local33__"
              }
            ]
          }
        ],
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 24,
          "col": 9
        },
        "QueryID": 16,
        "ParentID": 13,
        "Locals": [
          {
            "name": "__local32__",
            "type": "array",
            "value": [
              {
                "type": "string",
                "value": "wrong"
              }
            ]
          },
          {
            "name": "__local33__",
            "type": "array",
            "value": [
              {
                "type": "string",
                "value": "sec-ODP-Developer"
              },
              {
                "type": "string",
                "value": "sec-ODP-Data-Controller"
              }
            ]
          },
          {
            "name": "__local31__",
            "type": "string",
            "value": "/messages"
          }
        ],
        "LocalMetadata": {
          "__local31__": {
            "name": "__local31__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 23,
              "col": 16
            }
          },
          "__local32__": {
            "name": "__local32__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 24,
              "col": 25
            }
          },
          "__local33__": {
            "name": "__local33__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 24,
              "col": 40
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Enter",
        "Node": {
          "head": {
            "name": "lists_intersect",
            "args": [
              {
                "type": "var",
                "value": "list1"
              },
              {
                "type": "var",
                "value": "list2"
              }
            ],
            "value": {
              "type": "boolean",
              "value": true
            }
          },
          "body": [
            {
              "index": 0,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "list1"
                    },
                    {
                      "type": "var",
                      "value": "$2"
                    }
                  ]
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "list2"
                    },
                    {
                      "type": "var",
                      "value": "$3"
                    }
                  ]
                }
              ]
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 75,
          "col": 1
        },
        "QueryID": 17,
        "ParentID": 16,
        "Locals": null,
        "LocalMetadata": {},
        "Message": ""
      },
      {
        "Op": "Fail",
        "Node": {
          "index": 0,
          "terms": [
            {
              "type": "ref",
              "value": [
                {
                  "type": "var",
                  "value": "eq"
                }
              ]
            },
            {
              "type": "ref",
              "value": [
                {
                  "type": "var",
                  "value": "list1"
                },
                {
                  "type": "var",
                  "value": "$2"
                }
              ]
            },
            {
              "type": "ref",
              "value": [
                {
                  "type": "var",
                  "value": "list2"
                },
                {
                  "type": "var",
                  "value": "$3"
                }
              ]
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 76,
          "col": 5
        },
        "QueryID": 17,
        "ParentID": 16,
        "Locals": [
          {
            "name": "list1",
            "type": "array",
            "value": [
              {
                "type": "string",
                "value": "wrong"
              }
            ]
          },
          {
            "name": "list2",
            "type": "array",
            "value": [
              {
                "type": "string",
                "value": "sec-ODP-Developer"
              },
              {
                "type": "string",
                "value": "sec-ODP-Data-Controller"
              }
            ]
          }
        ],
        "LocalMetadata": {
          "list1": {
            "name": "list1",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 75,
              "col": 17
            }
          },
          "list2": {
            "name": "list2",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 75,
              "col": 24
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Fail",
        "Node": {
          "index": 0,
          "terms": [
            {
              "type": "ref",
              "value": [
                {
                  "type": "var",
                  "value": "data"
                },
                {
                  "type": "string",
                  "value": "http"
                },
                {
                  "type": "string",
                  "value": "request"
                },
                {
                  "type": "string",
                  "value": "authz"
                },
                {
                  "type": "string",
                  "value": "lists_intersect"
                }
              ]
            },
            {
              "type": "var",
              "value": "__local32__"
            },
            {
              "type": "var",
              "value": "__local33__"
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 24,
          "col": 9
        },
        "QueryID": 16,
        "ParentID": 13,
        "Locals": [
          {
            "name": "__local31__",
            "type": "string",
            "value": "/messages"
          },
          {
            "name": "__local32__",
            "type": "array",
            "value": [
              {
                "type": "string",
                "value": "wrong"
              }
            ]
          },
          {
            "name": "__local33__",
            "type": "array",
            "value": [
              {
                "type": "string",
                "value": "sec-ODP-Developer"
              },
              {
                "type": "string",
                "value": "sec-ODP-Data-Controller"
              }
            ]
          }
        ],
        "LocalMetadata": {
          "__local31__": {
            "name": "__local31__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 23,
              "col": 16
            }
          },
          "__local32__": {
            "name": "__local32__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 24,
              "col": 25
            }
          },
          "__local33__": {
            "name": "__local33__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 24,
              "col": 40
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Enter",
        "Node": {
          "head": {
            "name": "accessToResourceNotAllowed",
            "key": {
              "type": "var",
              "value": "__local3__"
            }
          },
          "body": [
            {
              "generated": true,
              "index": 0,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local36__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "input"
                    },
                    {
                      "type": "string",
                      "value": "path"
                    }
                  ]
                }
              ]
            },
            {
              "index": 1,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "startswith"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local36__"
                },
                {
                  "type": "string",
                  "value": "/statistics"
                }
              ]
            },
            {
              "generated": true,
              "index": 2,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local37__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "groupsFromJwt"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 3,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local38__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "allowedGroups"
                    }
                  ]
                }
              ]
            },
            {
              "index": 4,
              "negated": true,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "lists_intersect"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local37__"
                },
                {
                  "type": "var",
                  "value": "__local38__"
                }
              ]
            },
            {
              "generated": true,
              "index": 5,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local39__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "input"
                    },
                    {
                      "type": "string",
                      "value": "path"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 6,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local40__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "allowedGroups"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 7,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "sprintf"
                    }
                  ]
                },
                {
                  "type": "string",
                  "value": "Not allowed to access '%v', required group: '%v'"
                },
                {
                  "type": "array",
                  "value": [
                    {
                      "type": "var",
                      "value": "__local39__"
                    },
                    {
                      "type": "var",
                      "value": "__local40__"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local15__"
                }
              ]
            },
            {
              "index": 8,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local3__"
                },
                {
                  "type": "var",
                  "value": "__local15__"
                }
              ]
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 28,
          "col": 1
        },
        "QueryID": 18,
        "ParentID": 8,
        "Locals": null,
        "LocalMetadata": {
          "__local3__": {
            "name": "reason",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 28,
              "col": 28
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Fail",
        "Node": {
          "index": 1,
          "terms": [
            {
              "type": "ref",
              "value": [
                {
                  "type": "var",
                  "value": "startswith"
                }
              ]
            },
            {
              "type": "var",
              "value": "__local36__"
            },
            {
              "type": "string",
              "value": "/statistics"
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 29,
          "col": 5
        },
        "QueryID": 18,
        "ParentID": 8,
        "Locals": [
          {
            "name": "__local36__",
            "type": "string",
            "value": "/messages"
          }
        ],
        "LocalMetadata": {
          "__local36__": {
            "name": "__local36__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 29,
              "col": 16
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Enter",
        "Node": {
          "head": {
            "name": "accessToResourceNotAllowed",
            "key": {
              "type": "var",
              "value": "__local0__"
            }
          },
          "body": [
            {
              "index": 0,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "jwtDecoded"
                    }
                  ]
                },
                {
                  "type": "object",
                  "value": []
                }
              ]
            },
            {
              "index": 1,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local0__"
                },
                {
                  "type": "string",
                  "value": "Invalid input, missing JWT"
                }
              ]
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 12,
          "col": 1
        },
        "QueryID": 19,
        "ParentID": 8,
        "Locals": null,
        "LocalMetadata": {
          "__local0__": {
            "name": "reason",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 12,
              "col": 28
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Fail",
        "Node": {
          "index": 0,
          "terms": [
            {
              "type": "ref",
              "value": [
                {
                  "type": "var",
                  "value": "eq"
                }
              ]
            },
            {
              "type": "ref",
              "value": [
                {
                  "type": "var",
                  "value": "data"
                },
                {
                  "type": "string",
                  "value": "http"
                },
                {
                  "type": "string",
                  "value": "request"
                },
                {
                  "type": "string",
                  "value": "authz"
                },
                {
                  "type": "string",
                  "value": "jwtDecoded"
                }
              ]
            },
            {
              "type": "object",
              "value": []
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 13,
          "col": 5
        },
        "QueryID": 19,
        "ParentID": 8,
        "Locals": null,
        "LocalMetadata": {},
        "Message": ""
      },
      {
        "Op": "Enter",
        "Node": {
          "head": {
            "name": "accessToResourceNotAllowed",
            "key": {
              "type": "var",
              "value": "__local1__"
            }
          },
          "body": [
            {
              "index": 0,
              "negated": true,
              "terms": {
                "type": "ref",
                "value": [
                  {
                    "type": "var",
                    "value": "input"
                  },
                  {
                    "type": "string",
                    "value": "path"
                  }
                ]
              }
            },
            {
              "index": 1,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local1__"
                },
                {
                  "type": "string",
                  "value": "Invalid input, can't extract path"
                }
              ]
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 17,
          "col": 1
        },
        "QueryID": 20,
        "ParentID": 8,
        "Locals": null,
        "LocalMetadata": {
          "__local1__": {
            "name": "reason",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 17,
              "col": 28
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Fail",
        "Node": {
          "index": 0,
          "negated": true,
          "terms": {
            "type": "ref",
            "value": [
              {
                "type": "var",
                "value": "input"
              },
              {
                "type": "string",
                "value": "path"
              }
            ]
          }
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 18,
          "col": 9
        },
        "QueryID": 20,
        "ParentID": 8,
        "Locals": null,
        "LocalMetadata": {},
        "Message": ""
      },
      {
        "Op": "Enter",
        "Node": {
          "head": {
            "name": "accessToResourceNotAllowed",
            "key": {
              "type": "var",
              "value": "__local2__"
            }
          },
          "body": [
            {
              "generated": true,
              "index": 0,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local31__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "input"
                    },
                    {
                      "type": "string",
                      "value": "path"
                    }
                  ]
                }
              ]
            },
            {
              "index": 1,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "startswith"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local31__"
                },
                {
                  "type": "string",
                  "value": "/messages"
                }
              ]
            },
            {
              "generated": true,
              "index": 2,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local32__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "groupsFromJwt"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 3,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local33__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "allowedGroups"
                    }
                  ]
                }
              ]
            },
            {
              "index": 4,
              "negated": true,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "lists_intersect"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local32__"
                },
                {
                  "type": "var",
                  "value": "__local33__"
                }
              ]
            },
            {
              "generated": true,
              "index": 5,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local34__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "input"
                    },
                    {
                      "type": "string",
                      "value": "path"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 6,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local35__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "allowedGroups"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 7,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "sprintf"
                    }
                  ]
                },
                {
                  "type": "string",
                  "value": "Not allowed to access '%v', required group: '%v'"
                },
                {
                  "type": "array",
                  "value": [
                    {
                      "type": "var",
                      "value": "__local34__"
                    },
                    {
                      "type": "var",
                      "value": "__local35__"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local14__"
                }
              ]
            },
            {
              "index": 8,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local2__"
                },
                {
                  "type": "var",
                  "value": "__local14__"
                }
              ]
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 22,
          "col": 1
        },
        "QueryID": 22,
        "ParentID": 8,
        "Locals": null,
        "LocalMetadata": {
          "__local2__": {
            "name": "reason",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 22,
              "col": 28
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Enter",
        "Node": [
          {
            "index": 0,
            "terms": [
              {
                "type": "ref",
                "value": [
                  {
                    "type": "var",
                    "value": "data"
                  },
                  {
                    "type": "string",
                    "value": "http"
                  },
                  {
                    "type": "string",
                    "value": "request"
                  },
                  {
                    "type": "string",
                    "value": "authz"
                  },
                  {
                    "type": "string",
                    "value": "lists_intersect"
                  }
                ]
              },
              {
                "type": "var",
                "value": "__local32__"
              },
              {
                "type": "var",
                "value": "__local33__"
              }
            ]
          }
        ],
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 24,
          "col": 9
        },
        "QueryID": 23,
        "ParentID": 22,
        "Locals": [
          {
            "name": "__local31__",
            "type": "string",
            "value": "/messages"
          },
          {
            "name": "__local32__",
            "type": "array",
            "value": [
              {
                "type": "string",
                "value": "wrong"
              }
            ]
          },
          {
            "name": "__local33__",
            "type": "array",
            "value": [
              {
                "type": "string",
                "value": "sec-ODP-Developer"
              },
              {
                "type": "string",
                "value": "sec-ODP-Data-Controller"
              }
            ]
          }
        ],
        "LocalMetadata": {
          "__local31__": {
            "name": "__local31__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 23,
              "col": 16
            }
          },
          "__local32__": {
            "name": "__local32__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 24,
              "col": 25
            }
          },
          "__local33__": {
            "name": "__local33__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 24,
              "col": 40
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Enter",
        "Node": {
          "head": {
            "name": "lists_intersect",
            "args": [
              {
                "type": "var",
                "value": "list1"
              },
              {
                "type": "var",
                "value": "list2"
              }
            ],
            "value": {
              "type": "boolean",
              "value": true
            }
          },
          "body": [
            {
              "index": 0,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "list1"
                    },
                    {
                      "type": "var",
                      "value": "$2"
                    }
                  ]
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "list2"
                    },
                    {
                      "type": "var",
                      "value": "$3"
                    }
                  ]
                }
              ]
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 75,
          "col": 1
        },
        "QueryID": 24,
        "ParentID": 23,
        "Locals": null,
        "LocalMetadata": {},
        "Message": ""
      },
      {
        "Op": "Fail",
        "Node": {
          "index": 0,
          "terms": [
            {
              "type": "ref",
              "value": [
                {
                  "type": "var",
                  "value": "eq"
                }
              ]
            },
            {
              "type": "ref",
              "value": [
                {
                  "type": "var",
                  "value": "list1"
                },
                {
                  "type": "var",
                  "value": "$2"
                }
              ]
            },
            {
              "type": "ref",
              "value": [
                {
                  "type": "var",
                  "value": "list2"
                },
                {
                  "type": "var",
                  "value": "$3"
                }
              ]
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 76,
          "col": 5
        },
        "QueryID": 24,
        "ParentID": 23,
        "Locals": [
          {
            "name": "list1",
            "type": "array",
            "value": [
              {
                "type": "string",
                "value": "wrong"
              }
            ]
          },
          {
            "name": "list2",
            "type": "array",
            "value": [
              {
                "type": "string",
                "value": "sec-ODP-Developer"
              },
              {
                "type": "string",
                "value": "sec-ODP-Data-Controller"
              }
            ]
          }
        ],
        "LocalMetadata": {
          "list1": {
            "name": "list1",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 75,
              "col": 17
            }
          },
          "list2": {
            "name": "list2",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 75,
              "col": 24
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Fail",
        "Node": {
          "index": 0,
          "terms": [
            {
              "type": "ref",
              "value": [
                {
                  "type": "var",
                  "value": "data"
                },
                {
                  "type": "string",
                  "value": "http"
                },
                {
                  "type": "string",
                  "value": "request"
                },
                {
                  "type": "string",
                  "value": "authz"
                },
                {
                  "type": "string",
                  "value": "lists_intersect"
                }
              ]
            },
            {
              "type": "var",
              "value": "__local32__"
            },
            {
              "type": "var",
              "value": "__local33__"
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 24,
          "col": 9
        },
        "QueryID": 23,
        "ParentID": 22,
        "Locals": [
          {
            "name": "__local31__",
            "type": "string",
            "value": "/messages"
          },
          {
            "name": "__local32__",
            "type": "array",
            "value": [
              {
                "type": "string",
                "value": "wrong"
              }
            ]
          },
          {
            "name": "__local33__",
            "type": "array",
            "value": [
              {
                "type": "string",
                "value": "sec-ODP-Developer"
              },
              {
                "type": "string",
                "value": "sec-ODP-Data-Controller"
              }
            ]
          }
        ],
        "LocalMetadata": {
          "__local31__": {
            "name": "__local31__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 23,
              "col": 16
            }
          },
          "__local32__": {
            "name": "__local32__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 24,
              "col": 25
            }
          },
          "__local33__": {
            "name": "__local33__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 24,
              "col": 40
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Enter",
        "Node": {
          "head": {
            "name": "accessToResourceNotAllowed",
            "key": {
              "type": "var",
              "value": "__local3__"
            }
          },
          "body": [
            {
              "generated": true,
              "index": 0,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local36__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "input"
                    },
                    {
                      "type": "string",
                      "value": "path"
                    }
                  ]
                }
              ]
            },
            {
              "index": 1,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "startswith"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local36__"
                },
                {
                  "type": "string",
                  "value": "/statistics"
                }
              ]
            },
            {
              "generated": true,
              "index": 2,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local37__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "groupsFromJwt"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 3,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local38__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "allowedGroups"
                    }
                  ]
                }
              ]
            },
            {
              "index": 4,
              "negated": true,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "lists_intersect"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local37__"
                },
                {
                  "type": "var",
                  "value": "__local38__"
                }
              ]
            },
            {
              "generated": true,
              "index": 5,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local39__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "input"
                    },
                    {
                      "type": "string",
                      "value": "path"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 6,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local40__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "allowedGroups"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 7,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "sprintf"
                    }
                  ]
                },
                {
                  "type": "string",
                  "value": "Not allowed to access '%v', required group: '%v'"
                },
                {
                  "type": "array",
                  "value": [
                    {
                      "type": "var",
                      "value": "__local39__"
                    },
                    {
                      "type": "var",
                      "value": "__local40__"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local15__"
                }
              ]
            },
            {
              "index": 8,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local3__"
                },
                {
                  "type": "var",
                  "value": "__local15__"
                }
              ]
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 28,
          "col": 1
        },
        "QueryID": 25,
        "ParentID": 8,
        "Locals": null,
        "LocalMetadata": {
          "__local3__": {
            "name": "reason",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 28,
              "col": 28
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Fail",
        "Node": {
          "index": 1,
          "terms": [
            {
              "type": "ref",
              "value": [
                {
                  "type": "var",
                  "value": "startswith"
                }
              ]
            },
            {
              "type": "var",
              "value": "__local36__"
            },
            {
              "type": "string",
              "value": "/statistics"
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 29,
          "col": 5
        },
        "QueryID": 25,
        "ParentID": 8,
        "Locals": [
          {
            "name": "__local36__",
            "type": "string",
            "value": "/messages"
          }
        ],
        "LocalMetadata": {
          "__local36__": {
            "name": "__local36__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 29,
              "col": 16
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Fail",
        "Node": {
          "index": 0,
          "terms": {
            "type": "ref",
            "value": [
              {
                "type": "var",
                "value": "data"
              },
              {
                "type": "string",
                "value": "http"
              },
              {
                "type": "string",
                "value": "request"
              },
              {
                "type": "string",
                "value": "authz"
              },
              {
                "type": "string",
                "value": "allow"
              }
            ]
          }
        },
        "Location": {
          "file": "src/test/resources/opa/policies/policies-test.rego",
          "row": 31,
          "col": 9
        },
        "QueryID": 3,
        "ParentID": 1,
        "Locals": [
          {
            "name": "__local23__",
            "type": "string",
            "value": "eyJhbGciOiAiUlMyNTYiLCAidHlwIjogIkpXVCJ9.eyJjbGllbnRfaWQiOiAib2RwLWRpc21pdCIsICJleHAiOiAxNTgxOTU3NzIxLCAib2RwIjogeyJncm91cHMiOiBbIndyb25nIl19LCAicHVycG9zZSI6ICJhY2Nlc3NfdG9rZW4iLCAic2NvcGUiOiAib3BhLWRpc21pdCIsICJ1c2VybmFtZSI6ICJvZHAtZGlzbWl0In0.exb4VEfitRcIoAk6motT8VgqK5B8PAZGxf_cTra7WYoevx0eKdtUG-ARtT4j24luQlzUkvhzGLaAMQd5ZmnnW2lA5LvXAFNt2S0eJixA-3K_xrfYn_qp91FWN8OFE9PhVqGFim-klo7V5mhQWR95K0MYcYW4fgQQ2bkBMwirGlH60r1l-yeyL5t376iB71eWSgEjgFqYP6w5I4wDbetblgRisLRu2Da0roMfHXPN1E2-JUMCobfMrUHeqVSl_-gSn1gwMT_BjO4BzaM0csCVfmSwY7AUaYz6vwAE4HNHbz4o9TzoS_WyZoQVLJeNrz1JeTJBrEFlxD7Kzo_XuOGMeA"
          },
          {
            "name": "__local8__",
            "type": "string",
            "value": "eyJhbGciOiAiUlMyNTYiLCAidHlwIjogIkpXVCJ9.eyJjbGllbnRfaWQiOiAib2RwLWRpc21pdCIsICJleHAiOiAxNTgxOTU3NzIxLCAib2RwIjogeyJncm91cHMiOiBbIndyb25nIl19LCAicHVycG9zZSI6ICJhY2Nlc3NfdG9rZW4iLCAic2NvcGUiOiAib3BhLWRpc21pdCIsICJ1c2VybmFtZSI6ICJvZHAtZGlzbWl0In0.exb4VEfitRcIoAk6motT8VgqK5B8PAZGxf_cTra7WYoevx0eKdtUG-ARtT4j24luQlzUkvhzGLaAMQd5ZmnnW2lA5LvXAFNt2S0eJixA-3K_xrfYn_qp91FWN8OFE9PhVqGFim-klo7V5mhQWR95K0MYcYW4fgQQ2bkBMwirGlH60r1l-yeyL5t376iB71eWSgEjgFqYP6w5I4wDbetblgRisLRu2Da0roMfHXPN1E2-JUMCobfMrUHeqVSl_-gSn1gwMT_BjO4BzaM0csCVfmSwY7AUaYz6vwAE4HNHbz4o9TzoS_WyZoQVLJeNrz1JeTJBrEFlxD7Kzo_XuOGMeA"
          }
        ],
        "LocalMetadata": {
          "__local23__": {
            "name": "__local23__",
            "location": {
              "file": "src/test/resources/opa/policies/policies-test.rego",
              "row": 30,
              "col": 12
            }
          },
          "__local8__": {
            "name": "jwt",
            "location": {
              "file": "src/test/resources/opa/policies/policies-test.rego",
              "row": 30,
              "col": 5
            }
          }
        },
        "Message": ""
      }
    ]
  },
  {
    "location": {
      "file": "src/test/resources/opa/policies/policies-test.rego",
      "row": 34,
      "col": 1
    },
    "package": "data.http.request.authz",
    "name": "test_allow_if_jwt_with_groups_for_messages",
    "duration": 1750280,
    "trace": [
      {
        "Op": "Enter",
        "Node": [
          {
            "index": 0,
            "terms": [
              {
                "type": "ref",
                "value": [
                  {
                    "type": "var",
                    "value": "eq"
                  }
                ]
              },
              {
                "type": "ref",
                "value": [
                  {
                    "type": "var",
                    "value": "data"
                  },
                  {
                    "type": "string",
                    "value": "http"
                  },
                  {
                    "type": "string",
                    "value": "request"
                  },
                  {
                    "type": "string",
                    "value": "authz"
                  },
                  {
                    "type": "string",
                    "value": "test_allow_if_jwt_with_groups_for_messages"
                  }
                ]
              },
              {
                "type": "var",
                "value": "$term1"
              }
            ]
          }
        ],
        "Location": {
          "file": "",
          "row": 1,
          "col": 1
        },
        "QueryID": 0,
        "ParentID": 0,
        "Locals": null,
        "LocalMetadata": {},
        "Message": ""
      },
      {
        "Op": "Enter",
        "Node": {
          "head": {
            "name": "test_allow_if_jwt_with_groups_for_messages",
            "value": {
              "type": "boolean",
              "value": true
            }
          },
          "body": [
            {
              "generated": true,
              "index": 0,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "generateJWT"
                    }
                  ]
                },
                {
                  "type": "string",
                  "value": "sec-ODP-Developer"
                },
                {
                  "type": "var",
                  "value": "__local24__"
                }
              ]
            },
            {
              "index": 1,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local9__"
                },
                {
                  "type": "var",
                  "value": "__local24__"
                }
              ]
            },
            {
              "index": 2,
              "terms": {
                "type": "ref",
                "value": [
                  {
                    "type": "var",
                    "value": "data"
                  },
                  {
                    "type": "string",
                    "value": "http"
                  },
                  {
                    "type": "string",
                    "value": "request"
                  },
                  {
                    "type": "string",
                    "value": "authz"
                  },
                  {
                    "type": "string",
                    "value": "allow"
                  }
                ]
              },
              "with": [
                {
                  "target": {
                    "type": "ref",
                    "value": [
                      {
                        "type": "var",
                        "value": "input"
                      }
                    ]
                  },
                  "value": {
                    "type": "object",
                    "value": [
                      [
                        {
                          "type": "string",
                          "value": "encodedJwt"
                        },
                        {
                          "type": "var",
                          "value": "__local9__"
                        }
                      ],
                      [
                        {
                          "type": "string",
                          "value": "path"
                        },
                        {
                          "type": "string",
                          "value": "/messages"
                        }
                      ]
                    ]
                  }
                }
              ]
            }
          ]
        },
        "Location": {
          "file": "src/test/resources/opa/policies/policies-test.rego",
          "row": 34,
          "col": 1
        },
        "QueryID": 1,
        "ParentID": 0,
        "Locals": null,
        "LocalMetadata": {
          "__local9__": {
            "name": "jwt",
            "location": {
              "file": "src/test/resources/opa/policies/policies-test.rego",
              "row": 35,
              "col": 5
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Enter",
        "Node": {
          "head": {
            "name": "allow",
            "value": {
              "type": "var",
              "value": "__local29__"
            }
          },
          "body": [
            {
              "index": 0,
              "terms": {
                "type": "boolean",
                "value": true
              }
            },
            {
              "generated": true,
              "index": 1,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local29__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "status"
                    },
                    {
                      "type": "string",
                      "value": "allowed"
                    }
                  ]
                }
              ]
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 47,
          "col": 9
        },
        "QueryID": 3,
        "ParentID": 1,
        "Locals": null,
        "LocalMetadata": {},
        "Message": ""
      },
      {
        "Op": "Enter",
        "Node": {
          "head": {
            "name": "status",
            "value": {
              "type": "object",
              "value": [
                [
                  {
                    "type": "string",
                    "value": "allowed"
                  },
                  {
                    "type": "boolean",
                    "value": true
                  }
                ],
                [
                  {
                    "type": "string",
                    "value": "reason"
                  },
                  {
                    "type": "var",
                    "value": "__local17__"
                  }
                ]
              ]
            }
          },
          "body": [
            {
              "generated": true,
              "index": 0,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local44__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "accessToWhitelistAllowed"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 1,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "count"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local44__"
                },
                {
                  "type": "var",
                  "value": "__local18__"
                }
              ]
            },
            {
              "index": 2,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "gt"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local18__"
                },
                {
                  "type": "number",
                  "value": 0
                }
              ]
            },
            {
              "generated": true,
              "index": 3,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local45__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "accessToWhitelistAllowed"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 4,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "concat"
                    }
                  ]
                },
                {
                  "type": "string",
                  "value": " | "
                },
                {
                  "type": "var",
                  "value": "__local45__"
                },
                {
                  "type": "var",
                  "value": "__local17__"
                }
              ]
            }
          ],
          "else": {
            "head": {
              "name": "status",
              "value": {
                "type": "object",
                "value": [
                  [
                    {
                      "type": "string",
                      "value": "allowed"
                    },
                    {
                      "type": "boolean",
                      "value": false
                    }
                  ],
                  [
                    {
                      "type": "string",
                      "value": "reason"
                    },
                    {
                      "type": "var",
                      "value": "__local19__"
                    }
                  ]
                ]
              }
            },
            "body": [
              {
                "generated": true,
                "index": 0,
                "terms": [
                  {
                    "type": "ref",
                    "value": [
                      {
                        "type": "var",
                        "value": "eq"
                      }
                    ]
                  },
                  {
                    "type": "var",
                    "value": "__local46__"
                  },
                  {
                    "type": "ref",
                    "value": [
                      {
                        "type": "var",
                        "value": "data"
                      },
                      {
                        "type": "string",
                        "value": "http"
                      },
                      {
                        "type": "string",
                        "value": "request"
                      },
                      {
                        "type": "string",
                        "value": "authz"
                      },
                      {
                        "type": "string",
                        "value": "accessToResourceNotAllowed"
                      }
                    ]
                  }
                ]
              },
              {
                "generated": true,
                "index": 1,
                "terms": [
                  {
                    "type": "ref",
                    "value": [
                      {
                        "type": "var",
                        "value": "count"
                      }
                    ]
                  },
                  {
                    "type": "var",
                    "value": "__local46__"
                  },
                  {
                    "type": "var",
                    "value": "__local20__"
                  }
                ]
              },
              {
                "index": 2,
                "terms": [
                  {
                    "type": "ref",
                    "value": [
                      {
                        "type": "var",
                        "value": "gt"
                      }
                    ]
                  },
                  {
                    "type": "var",
                    "value": "__local20__"
                  },
                  {
                    "type": "number",
                    "value": 0
                  }
                ]
              },
              {
                "generated": true,
                "index": 3,
                "terms": [
                  {
                    "type": "ref",
                    "value": [
                      {
                        "type": "var",
                        "value": "eq"
                      }
                    ]
                  },
                  {
                    "type": "var",
                    "value": "__local47__"
                  },
                  {
                    "type": "ref",
                    "value": [
                      {
                        "type": "var",
                        "value": "data"
                      },
                      {
                        "type": "string",
                        "value": "http"
                      },
                      {
                        "type": "string",
                        "value": "request"
                      },
                      {
                        "type": "string",
                        "value": "authz"
                      },
                      {
                        "type": "string",
                        "value": "accessToResourceNotAllowed"
                      }
                    ]
                  }
                ]
              },
              {
                "generated": true,
                "index": 4,
                "terms": [
                  {
                    "type": "ref",
                    "value": [
                      {
                        "type": "var",
                        "value": "concat"
                      }
                    ]
                  },
                  {
                    "type": "string",
                    "value": " | "
                  },
                  {
                    "type": "var",
                    "value": "__local47__"
                  },
                  {
                    "type": "var",
                    "value": "__local19__"
                  }
                ]
              }
            ],
            "else": {
              "head": {
                "name": "status",
                "value": {
                  "type": "object",
                  "value": [
                    [
                      {
                        "type": "string",
                        "value": "allowed"
                      },
                      {
                        "type": "boolean",
                        "value": true
                      }
                    ],
                    [
                      {
                        "type": "string",
                        "value": "reason"
                      },
                      {
                        "type": "string",
                        "value": "Access allowed, all rules passed"
                      }
                    ]
                  ]
                }
              },
              "body": [
                {
                  "index": 0,
                  "terms": {
                    "type": "boolean",
                    "value": true
                  }
                }
              ]
            }
          }
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 39,
          "col": 1
        },
        "QueryID": 4,
        "ParentID": 3,
        "Locals": null,
        "LocalMetadata": {},
        "Message": ""
      },
      {
        "Op": "Enter",
        "Node": {
          "head": {
            "name": "accessToWhitelistAllowed",
            "key": {
              "type": "var",
              "value": "__local4__"
            }
          },
          "body": [
            {
              "generated": true,
              "index": 0,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local41__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "input"
                    },
                    {
                      "type": "string",
                      "value": "path"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 1,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local42__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "whitelistedEndpoints"
                    },
                    {
                      "type": "var",
                      "value": "$0"
                    }
                  ]
                }
              ]
            },
            {
              "index": 2,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "startswith"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local41__"
                },
                {
                  "type": "var",
                  "value": "__local42__"
                }
              ]
            },
            {
              "generated": true,
              "index": 3,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local43__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "input"
                    },
                    {
                      "type": "string",
                      "value": "path"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 4,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "sprintf"
                    }
                  ]
                },
                {
                  "type": "string",
                  "value": "Resource '%v' on whitelist"
                },
                {
                  "type": "array",
                  "value": [
                    {
                      "type": "var",
                      "value": "__local43__"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local16__"
                }
              ]
            },
            {
              "index": 5,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local4__"
                },
                {
                  "type": "var",
                  "value": "__local16__"
                }
              ]
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 34,
          "col": 1
        },
        "QueryID": 5,
        "ParentID": 4,
        "Locals": null,
        "LocalMetadata": {
          "__local4__": {
            "name": "reason",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 34,
              "col": 26
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Fail",
        "Node": {
          "index": 2,
          "terms": [
            {
              "type": "ref",
              "value": [
                {
                  "type": "var",
                  "value": "startswith"
                }
              ]
            },
            {
              "type": "var",
              "value": "__local41__"
            },
            {
              "type": "var",
              "value": "__local42__"
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 35,
          "col": 5
        },
        "QueryID": 5,
        "ParentID": 4,
        "Locals": [
          {
            "name": "__local42__",
            "type": "string",
            "value": "/ping"
          },
          {
            "name": "__local41__",
            "type": "string",
            "value": "/messages"
          },
          {
            "name": "_",
            "type": "number",
            "value": 0
          }
        ],
        "LocalMetadata": {
          "$0": {
            "name": "$0",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 35,
              "col": 49
            }
          },
          "__local41__": {
            "name": "__local41__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 35,
              "col": 16
            }
          },
          "__local42__": {
            "name": "__local42__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 35,
              "col": 28
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Fail",
        "Node": {
          "index": 2,
          "terms": [
            {
              "type": "ref",
              "value": [
                {
                  "type": "var",
                  "value": "startswith"
                }
              ]
            },
            {
              "type": "var",
              "value": "__local41__"
            },
            {
              "type": "var",
              "value": "__local42__"
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 35,
          "col": 5
        },
        "QueryID": 5,
        "ParentID": 4,
        "Locals": [
          {
            "name": "__local41__",
            "type": "string",
            "value": "/messages"
          },
          {
            "name": "_",
            "type": "number",
            "value": 1
          },
          {
            "name": "__local42__",
            "type": "string",
            "value": "/error"
          }
        ],
        "LocalMetadata": {
          "$0": {
            "name": "$0",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 35,
              "col": 49
            }
          },
          "__local41__": {
            "name": "__local41__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 35,
              "col": 16
            }
          },
          "__local42__": {
            "name": "__local42__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 35,
              "col": 28
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Fail",
        "Node": {
          "index": 2,
          "terms": [
            {
              "type": "ref",
              "value": [
                {
                  "type": "var",
                  "value": "startswith"
                }
              ]
            },
            {
              "type": "var",
              "value": "__local41__"
            },
            {
              "type": "var",
              "value": "__local42__"
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 35,
          "col": 5
        },
        "QueryID": 5,
        "ParentID": 4,
        "Locals": [
          {
            "name": "__local42__",
            "type": "string",
            "value": "/health"
          },
          {
            "name": "__local41__",
            "type": "string",
            "value": "/messages"
          },
          {
            "name": "_",
            "type": "number",
            "value": 2
          }
        ],
        "LocalMetadata": {
          "$0": {
            "name": "$0",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 35,
              "col": 49
            }
          },
          "__local41__": {
            "name": "__local41__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 35,
              "col": 16
            }
          },
          "__local42__": {
            "name": "__local42__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 35,
              "col": 28
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Fail",
        "Node": {
          "index": 2,
          "terms": [
            {
              "type": "ref",
              "value": [
                {
                  "type": "var",
                  "value": "gt"
                }
              ]
            },
            {
              "type": "var",
              "value": "__local18__"
            },
            {
              "type": "number",
              "value": 0
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 40,
          "col": 5
        },
        "QueryID": 4,
        "ParentID": 3,
        "Locals": [
          {
            "name": "__local18__",
            "type": "number",
            "value": 0
          },
          {
            "name": "__local44__",
            "type": "set",
            "value": []
          }
        ],
        "LocalMetadata": {
          "__local18__": {
            "name": "__local18__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 40,
              "col": 5
            }
          },
          "__local44__": {
            "name": "__local44__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 40,
              "col": 11
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Enter",
        "Node": {
          "head": {
            "name": "status",
            "value": {
              "type": "object",
              "value": [
                [
                  {
                    "type": "string",
                    "value": "allowed"
                  },
                  {
                    "type": "boolean",
                    "value": false
                  }
                ],
                [
                  {
                    "type": "string",
                    "value": "reason"
                  },
                  {
                    "type": "var",
                    "value": "__local19__"
                  }
                ]
              ]
            }
          },
          "body": [
            {
              "generated": true,
              "index": 0,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local46__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "accessToResourceNotAllowed"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 1,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "count"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local46__"
                },
                {
                  "type": "var",
                  "value": "__local20__"
                }
              ]
            },
            {
              "index": 2,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "gt"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local20__"
                },
                {
                  "type": "number",
                  "value": 0
                }
              ]
            },
            {
              "generated": true,
              "index": 3,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local47__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "accessToResourceNotAllowed"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 4,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "concat"
                    }
                  ]
                },
                {
                  "type": "string",
                  "value": " | "
                },
                {
                  "type": "var",
                  "value": "__local47__"
                },
                {
                  "type": "var",
                  "value": "__local19__"
                }
              ]
            }
          ],
          "else": {
            "head": {
              "name": "status",
              "value": {
                "type": "object",
                "value": [
                  [
                    {
                      "type": "string",
                      "value": "allowed"
                    },
                    {
                      "type": "boolean",
                      "value": true
                    }
                  ],
                  [
                    {
                      "type": "string",
                      "value": "reason"
                    },
                    {
                      "type": "string",
                      "value": "Access allowed, all rules passed"
                    }
                  ]
                ]
              }
            },
            "body": [
              {
                "index": 0,
                "terms": {
                  "type": "boolean",
                  "value": true
                }
              }
            ]
          }
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 41,
          "col": 3
        },
        "QueryID": 7,
        "ParentID": 3,
        "Locals": null,
        "LocalMetadata": {},
        "Message": ""
      },
      {
        "Op": "Enter",
        "Node": {
          "head": {
            "name": "accessToResourceNotAllowed",
            "key": {
              "type": "var",
              "value": "__local0__"
            }
          },
          "body": [
            {
              "index": 0,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "jwtDecoded"
                    }
                  ]
                },
                {
                  "type": "object",
                  "value": []
                }
              ]
            },
            {
              "index": 1,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local0__"
                },
                {
                  "type": "string",
                  "value": "Invalid input, missing JWT"
                }
              ]
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 12,
          "col": 1
        },
        "QueryID": 8,
        "ParentID": 7,
        "Locals": null,
        "LocalMetadata": {
          "__local0__": {
            "name": "reason",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 12,
              "col": 28
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Fail",
        "Node": {
          "index": 0,
          "terms": [
            {
              "type": "ref",
              "value": [
                {
                  "type": "var",
                  "value": "eq"
                }
              ]
            },
            {
              "type": "ref",
              "value": [
                {
                  "type": "var",
                  "value": "data"
                },
                {
                  "type": "string",
                  "value": "http"
                },
                {
                  "type": "string",
                  "value": "request"
                },
                {
                  "type": "string",
                  "value": "authz"
                },
                {
                  "type": "string",
                  "value": "jwtDecoded"
                }
              ]
            },
            {
              "type": "object",
              "value": []
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 13,
          "col": 5
        },
        "QueryID": 8,
        "ParentID": 7,
        "Locals": null,
        "LocalMetadata": {},
        "Message": ""
      },
      {
        "Op": "Enter",
        "Node": {
          "head": {
            "name": "accessToResourceNotAllowed",
            "key": {
              "type": "var",
              "value": "__local1__"
            }
          },
          "body": [
            {
              "index": 0,
              "negated": true,
              "terms": {
                "type": "ref",
                "value": [
                  {
                    "type": "var",
                    "value": "input"
                  },
                  {
                    "type": "string",
                    "value": "path"
                  }
                ]
              }
            },
            {
              "index": 1,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local1__"
                },
                {
                  "type": "string",
                  "value": "Invalid input, can't extract path"
                }
              ]
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 17,
          "col": 1
        },
        "QueryID": 10,
        "ParentID": 7,
        "Locals": null,
        "LocalMetadata": {
          "__local1__": {
            "name": "reason",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 17,
              "col": 28
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Fail",
        "Node": {
          "index": 0,
          "negated": true,
          "terms": {
            "type": "ref",
            "value": [
              {
                "type": "var",
                "value": "input"
              },
              {
                "type": "string",
                "value": "path"
              }
            ]
          }
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 18,
          "col": 9
        },
        "QueryID": 10,
        "ParentID": 7,
        "Locals": null,
        "LocalMetadata": {},
        "Message": ""
      },
      {
        "Op": "Enter",
        "Node": {
          "head": {
            "name": "accessToResourceNotAllowed",
            "key": {
              "type": "var",
              "value": "__local2__"
            }
          },
          "body": [
            {
              "generated": true,
              "index": 0,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local31__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "input"
                    },
                    {
                      "type": "string",
                      "value": "path"
                    }
                  ]
                }
              ]
            },
            {
              "index": 1,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "startswith"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local31__"
                },
                {
                  "type": "string",
                  "value": "/messages"
                }
              ]
            },
            {
              "generated": true,
              "index": 2,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local32__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "groupsFromJwt"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 3,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local33__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "allowedGroups"
                    }
                  ]
                }
              ]
            },
            {
              "index": 4,
              "negated": true,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "lists_intersect"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local32__"
                },
                {
                  "type": "var",
                  "value": "__local33__"
                }
              ]
            },
            {
              "generated": true,
              "index": 5,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local34__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "input"
                    },
                    {
                      "type": "string",
                      "value": "path"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 6,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local35__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "allowedGroups"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 7,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "sprintf"
                    }
                  ]
                },
                {
                  "type": "string",
                  "value": "Not allowed to access '%v', required group: '%v'"
                },
                {
                  "type": "array",
                  "value": [
                    {
                      "type": "var",
                      "value": "__local34__"
                    },
                    {
                      "type": "var",
                      "value": "__local35__"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local14__"
                }
              ]
            },
            {
              "index": 8,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local2__"
                },
                {
                  "type": "var",
                  "value": "__local14__"
                }
              ]
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 22,
          "col": 1
        },
        "QueryID": 12,
        "ParentID": 7,
        "Locals": null,
        "LocalMetadata": {
          "__local2__": {
            "name": "reason",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 22,
              "col": 28
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Fail",
        "Node": {
          "index": 4,
          "negated": true,
          "terms": [
            {
              "type": "ref",
              "value": [
                {
                  "type": "var",
                  "value": "data"
                },
                {
                  "type": "string",
                  "value": "http"
                },
                {
                  "type": "string",
                  "value": "request"
                },
                {
                  "type": "string",
                  "value": "authz"
                },
                {
                  "type": "string",
                  "value": "lists_intersect"
                }
              ]
            },
            {
              "type": "var",
              "value": "__local32__"
            },
            {
              "type": "var",
              "value": "__local33__"
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 24,
          "col": 9
        },
        "QueryID": 12,
        "ParentID": 7,
        "Locals": [
          {
            "name": "__local31__",
            "type": "string",
            "value": "/messages"
          },
          {
            "name": "__local32__",
            "type": "array",
            "value": [
              {
                "type": "string",
                "value": "sec-ODP-Developer"
              }
            ]
          },
          {
            "name": "__local33__",
            "type": "array",
            "value": [
              {
                "type": "string",
                "value": "sec-ODP-Developer"
              },
              {
                "type": "string",
                "value": "sec-ODP-Data-Controller"
              }
            ]
          }
        ],
        "LocalMetadata": {
          "__local31__": {
            "name": "__local31__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 23,
              "col": 16
            }
          },
          "__local32__": {
            "name": "__local32__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 24,
              "col": 25
            }
          },
          "__local33__": {
            "name": "__local33__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 24,
              "col": 40
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Enter",
        "Node": {
          "head": {
            "name": "accessToResourceNotAllowed",
            "key": {
              "type": "var",
              "value": "__local3__"
            }
          },
          "body": [
            {
              "generated": true,
              "index": 0,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local36__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "input"
                    },
                    {
                      "type": "string",
                      "value": "path"
                    }
                  ]
                }
              ]
            },
            {
              "index": 1,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "startswith"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local36__"
                },
                {
                  "type": "string",
                  "value": "/statistics"
                }
              ]
            },
            {
              "generated": true,
              "index": 2,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local37__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "groupsFromJwt"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 3,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local38__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "allowedGroups"
                    }
                  ]
                }
              ]
            },
            {
              "index": 4,
              "negated": true,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "lists_intersect"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local37__"
                },
                {
                  "type": "var",
                  "value": "__local38__"
                }
              ]
            },
            {
              "generated": true,
              "index": 5,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local39__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "input"
                    },
                    {
                      "type": "string",
                      "value": "path"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 6,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local40__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "allowedGroups"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 7,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "sprintf"
                    }
                  ]
                },
                {
                  "type": "string",
                  "value": "Not allowed to access '%v', required group: '%v'"
                },
                {
                  "type": "array",
                  "value": [
                    {
                      "type": "var",
                      "value": "__local39__"
                    },
                    {
                      "type": "var",
                      "value": "__local40__"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local15__"
                }
              ]
            },
            {
              "index": 8,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local3__"
                },
                {
                  "type": "var",
                  "value": "__local15__"
                }
              ]
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 28,
          "col": 1
        },
        "QueryID": 17,
        "ParentID": 7,
        "Locals": null,
        "LocalMetadata": {
          "__local3__": {
            "name": "reason",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 28,
              "col": 28
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Fail",
        "Node": {
          "index": 1,
          "terms": [
            {
              "type": "ref",
              "value": [
                {
                  "type": "var",
                  "value": "startswith"
                }
              ]
            },
            {
              "type": "var",
              "value": "__local36__"
            },
            {
              "type": "string",
              "value": "/statistics"
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 29,
          "col": 5
        },
        "QueryID": 17,
        "ParentID": 7,
        "Locals": [
          {
            "name": "__local36__",
            "type": "string",
            "value": "/messages"
          }
        ],
        "LocalMetadata": {
          "__local36__": {
            "name": "__local36__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 29,
              "col": 16
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Fail",
        "Node": {
          "index": 2,
          "terms": [
            {
              "type": "ref",
              "value": [
                {
                  "type": "var",
                  "value": "gt"
                }
              ]
            },
            {
              "type": "var",
              "value": "__local20__"
            },
            {
              "type": "number",
              "value": 0
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 42,
          "col": 5
        },
        "QueryID": 7,
        "ParentID": 3,
        "Locals": [
          {
            "name": "__local46__",
            "type": "set",
            "value": []
          },
          {
            "name": "__local20__",
            "type": "number",
            "value": 0
          }
        ],
        "LocalMetadata": {
          "__local20__": {
            "name": "__local20__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 42,
              "col": 5
            }
          },
          "__local46__": {
            "name": "__local46__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 42,
              "col": 11
            }
          }
        },
        "Message": ""
      }
    ]
  },
  {
    "location": {
      "file": "src/test/resources/opa/policies/policies-test.rego",
      "row": 39,
      "col": 1
    },
    "package": "data.http.request.authz",
    "name": "test_allow_if_jwt_with_alternate_groups_for_messages",
    "duration": 1752927,
    "trace": [
      {
        "Op": "Enter",
        "Node": [
          {
            "index": 0,
            "terms": [
              {
                "type": "ref",
                "value": [
                  {
                    "type": "var",
                    "value": "eq"
                  }
                ]
              },
              {
                "type": "ref",
                "value": [
                  {
                    "type": "var",
                    "value": "data"
                  },
                  {
                    "type": "string",
                    "value": "http"
                  },
                  {
                    "type": "string",
                    "value": "request"
                  },
                  {
                    "type": "string",
                    "value": "authz"
                  },
                  {
                    "type": "string",
                    "value": "test_allow_if_jwt_with_alternate_groups_for_messages"
                  }
                ]
              },
              {
                "type": "var",
                "value": "$term1"
              }
            ]
          }
        ],
        "Location": {
          "file": "",
          "row": 1,
          "col": 1
        },
        "QueryID": 0,
        "ParentID": 0,
        "Locals": null,
        "LocalMetadata": {},
        "Message": ""
      },
      {
        "Op": "Enter",
        "Node": {
          "head": {
            "name": "test_allow_if_jwt_with_alternate_groups_for_messages",
            "value": {
              "type": "boolean",
              "value": true
            }
          },
          "body": [
            {
              "generated": true,
              "index": 0,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "generateJWT"
                    }
                  ]
                },
                {
                  "type": "string",
                  "value": "sec-ODP-Data-Controller"
                },
                {
                  "type": "var",
                  "value": "__local25__"
                }
              ]
            },
            {
              "index": 1,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local10__"
                },
                {
                  "type": "var",
                  "value": "__local25__"
                }
              ]
            },
            {
              "index": 2,
              "terms": {
                "type": "ref",
                "value": [
                  {
                    "type": "var",
                    "value": "data"
                  },
                  {
                    "type": "string",
                    "value": "http"
                  },
                  {
                    "type": "string",
                    "value": "request"
                  },
                  {
                    "type": "string",
                    "value": "authz"
                  },
                  {
                    "type": "string",
                    "value": "allow"
                  }
                ]
              },
              "with": [
                {
                  "target": {
                    "type": "ref",
                    "value": [
                      {
                        "type": "var",
                        "value": "input"
                      }
                    ]
                  },
                  "value": {
                    "type": "object",
                    "value": [
                      [
                        {
                          "type": "string",
                          "value": "encodedJwt"
                        },
                        {
                          "type": "var",
                          "value": "__local10__"
                        }
                      ],
                      [
                        {
                          "type": "string",
                          "value": "path"
                        },
                        {
                          "type": "string",
                          "value": "/messages"
                        }
                      ]
                    ]
                  }
                }
              ]
            }
          ]
        },
        "Location": {
          "file": "src/test/resources/opa/policies/policies-test.rego",
          "row": 39,
          "col": 1
        },
        "QueryID": 1,
        "ParentID": 0,
        "Locals": null,
        "LocalMetadata": {
          "__local10__": {
            "name": "jwt",
            "location": {
              "file": "src/test/resources/opa/policies/policies-test.rego",
              "row": 40,
              "col": 5
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Enter",
        "Node": {
          "head": {
            "name": "allow",
            "value": {
              "type": "var",
              "value": "__local29__"
            }
          },
          "body": [
            {
              "index": 0,
              "terms": {
                "type": "boolean",
                "value": true
              }
            },
            {
              "generated": true,
              "index": 1,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local29__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "status"
                    },
                    {
                      "type": "string",
                      "value": "allowed"
                    }
                  ]
                }
              ]
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 47,
          "col": 9
        },
        "QueryID": 3,
        "ParentID": 1,
        "Locals": null,
        "LocalMetadata": {},
        "Message": ""
      },
      {
        "Op": "Enter",
        "Node": {
          "head": {
            "name": "status",
            "value": {
              "type": "object",
              "value": [
                [
                  {
                    "type": "string",
                    "value": "allowed"
                  },
                  {
                    "type": "boolean",
                    "value": true
                  }
                ],
                [
                  {
                    "type": "string",
                    "value": "reason"
                  },
                  {
                    "type": "var",
                    "value": "__local17__"
                  }
                ]
              ]
            }
          },
          "body": [
            {
              "generated": true,
              "index": 0,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local44__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "accessToWhitelistAllowed"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 1,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "count"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local44__"
                },
                {
                  "type": "var",
                  "value": "__local18__"
                }
              ]
            },
            {
              "index": 2,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "gt"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local18__"
                },
                {
                  "type": "number",
                  "value": 0
                }
              ]
            },
            {
              "generated": true,
              "index": 3,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local45__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "accessToWhitelistAllowed"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 4,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "concat"
                    }
                  ]
                },
                {
                  "type": "string",
                  "value": " | "
                },
                {
                  "type": "var",
                  "value": "__local45__"
                },
                {
                  "type": "var",
                  "value": "__local17__"
                }
              ]
            }
          ],
          "else": {
            "head": {
              "name": "status",
              "value": {
                "type": "object",
                "value": [
                  [
                    {
                      "type": "string",
                      "value": "allowed"
                    },
                    {
                      "type": "boolean",
                      "value": false
                    }
                  ],
                  [
                    {
                      "type": "string",
                      "value": "reason"
                    },
                    {
                      "type": "var",
                      "value": "__local19__"
                    }
                  ]
                ]
              }
            },
            "body": [
              {
                "generated": true,
                "index": 0,
                "terms": [
                  {
                    "type": "ref",
                    "value": [
                      {
                        "type": "var",
                        "value": "eq"
                      }
                    ]
                  },
                  {
                    "type": "var",
                    "value": "__local46__"
                  },
                  {
                    "type": "ref",
                    "value": [
                      {
                        "type": "var",
                        "value": "data"
                      },
                      {
                        "type": "string",
                        "value": "http"
                      },
                      {
                        "type": "string",
                        "value": "request"
                      },
                      {
                        "type": "string",
                        "value": "authz"
                      },
                      {
                        "type": "string",
                        "value": "accessToResourceNotAllowed"
                      }
                    ]
                  }
                ]
              },
              {
                "generated": true,
                "index": 1,
                "terms": [
                  {
                    "type": "ref",
                    "value": [
                      {
                        "type": "var",
                        "value": "count"
                      }
                    ]
                  },
                  {
                    "type": "var",
                    "value": "__local46__"
                  },
                  {
                    "type": "var",
                    "value": "__local20__"
                  }
                ]
              },
              {
                "index": 2,
                "terms": [
                  {
                    "type": "ref",
                    "value": [
                      {
                        "type": "var",
                        "value": "gt"
                      }
                    ]
                  },
                  {
                    "type": "var",
                    "value": "__local20__"
                  },
                  {
                    "type": "number",
                    "value": 0
                  }
                ]
              },
              {
                "generated": true,
                "index": 3,
                "terms": [
                  {
                    "type": "ref",
                    "value": [
                      {
                        "type": "var",
                        "value": "eq"
                      }
                    ]
                  },
                  {
                    "type": "var",
                    "value": "__local47__"
                  },
                  {
                    "type": "ref",
                    "value": [
                      {
                        "type": "var",
                        "value": "data"
                      },
                      {
                        "type": "string",
                        "value": "http"
                      },
                      {
                        "type": "string",
                        "value": "request"
                      },
                      {
                        "type": "string",
                        "value": "authz"
                      },
                      {
                        "type": "string",
                        "value": "accessToResourceNotAllowed"
                      }
                    ]
                  }
                ]
              },
              {
                "generated": true,
                "index": 4,
                "terms": [
                  {
                    "type": "ref",
                    "value": [
                      {
                        "type": "var",
                        "value": "concat"
                      }
                    ]
                  },
                  {
                    "type": "string",
                    "value": " | "
                  },
                  {
                    "type": "var",
                    "value": "__local47__"
                  },
                  {
                    "type": "var",
                    "value": "__local19__"
                  }
                ]
              }
            ],
            "else": {
              "head": {
                "name": "status",
                "value": {
                  "type": "object",
                  "value": [
                    [
                      {
                        "type": "string",
                        "value": "allowed"
                      },
                      {
                        "type": "boolean",
                        "value": true
                      }
                    ],
                    [
                      {
                        "type": "string",
                        "value": "reason"
                      },
                      {
                        "type": "string",
                        "value": "Access allowed, all rules passed"
                      }
                    ]
                  ]
                }
              },
              "body": [
                {
                  "index": 0,
                  "terms": {
                    "type": "boolean",
                    "value": true
                  }
                }
              ]
            }
          }
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 39,
          "col": 1
        },
        "QueryID": 4,
        "ParentID": 3,
        "Locals": null,
        "LocalMetadata": {},
        "Message": ""
      },
      {
        "Op": "Enter",
        "Node": {
          "head": {
            "name": "accessToWhitelistAllowed",
            "key": {
              "type": "var",
              "value": "__local4__"
            }
          },
          "body": [
            {
              "generated": true,
              "index": 0,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local41__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "input"
                    },
                    {
                      "type": "string",
                      "value": "path"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 1,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local42__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "whitelistedEndpoints"
                    },
                    {
                      "type": "var",
                      "value": "$0"
                    }
                  ]
                }
              ]
            },
            {
              "index": 2,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "startswith"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local41__"
                },
                {
                  "type": "var",
                  "value": "__local42__"
                }
              ]
            },
            {
              "generated": true,
              "index": 3,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local43__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "input"
                    },
                    {
                      "type": "string",
                      "value": "path"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 4,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "sprintf"
                    }
                  ]
                },
                {
                  "type": "string",
                  "value": "Resource '%v' on whitelist"
                },
                {
                  "type": "array",
                  "value": [
                    {
                      "type": "var",
                      "value": "__local43__"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local16__"
                }
              ]
            },
            {
              "index": 5,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local4__"
                },
                {
                  "type": "var",
                  "value": "__local16__"
                }
              ]
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 34,
          "col": 1
        },
        "QueryID": 5,
        "ParentID": 4,
        "Locals": null,
        "LocalMetadata": {
          "__local4__": {
            "name": "reason",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 34,
              "col": 26
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Fail",
        "Node": {
          "index": 2,
          "terms": [
            {
              "type": "ref",
              "value": [
                {
                  "type": "var",
                  "value": "startswith"
                }
              ]
            },
            {
              "type": "var",
              "value": "__local41__"
            },
            {
              "type": "var",
              "value": "__local42__"
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 35,
          "col": 5
        },
        "QueryID": 5,
        "ParentID": 4,
        "Locals": [
          {
            "name": "__local41__",
            "type": "string",
            "value": "/messages"
          },
          {
            "name": "_",
            "type": "number",
            "value": 0
          },
          {
            "name": "__local42__",
            "type": "string",
            "value": "/ping"
          }
        ],
        "LocalMetadata": {
          "$0": {
            "name": "$0",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 35,
              "col": 49
            }
          },
          "__local41__": {
            "name": "__local41__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 35,
              "col": 16
            }
          },
          "__local42__": {
            "name": "__local42__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 35,
              "col": 28
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Fail",
        "Node": {
          "index": 2,
          "terms": [
            {
              "type": "ref",
              "value": [
                {
                  "type": "var",
                  "value": "startswith"
                }
              ]
            },
            {
              "type": "var",
              "value": "__local41__"
            },
            {
              "type": "var",
              "value": "__local42__"
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 35,
          "col": 5
        },
        "QueryID": 5,
        "ParentID": 4,
        "Locals": [
          {
            "name": "__local41__",
            "type": "string",
            "value": "/messages"
          },
          {
            "name": "_",
            "type": "number",
            "value": 1
          },
          {
            "name": "__local42__",
            "type": "string",
            "value": "/error"
          }
        ],
        "LocalMetadata": {
          "$0": {
            "name": "$0",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 35,
              "col": 49
            }
          },
          "__local41__": {
            "name": "__local41__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 35,
              "col": 16
            }
          },
          "__local42__": {
            "name": "__local42__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 35,
              "col": 28
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Fail",
        "Node": {
          "index": 2,
          "terms": [
            {
              "type": "ref",
              "value": [
                {
                  "type": "var",
                  "value": "startswith"
                }
              ]
            },
            {
              "type": "var",
              "value": "__local41__"
            },
            {
              "type": "var",
              "value": "__local42__"
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 35,
          "col": 5
        },
        "QueryID": 5,
        "ParentID": 4,
        "Locals": [
          {
            "name": "__local41__",
            "type": "string",
            "value": "/messages"
          },
          {
            "name": "_",
            "type": "number",
            "value": 2
          },
          {
            "name": "__local42__",
            "type": "string",
            "value": "/health"
          }
        ],
        "LocalMetadata": {
          "$0": {
            "name": "$0",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 35,
              "col": 49
            }
          },
          "__local41__": {
            "name": "__local41__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 35,
              "col": 16
            }
          },
          "__local42__": {
            "name": "__local42__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 35,
              "col": 28
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Fail",
        "Node": {
          "index": 2,
          "terms": [
            {
              "type": "ref",
              "value": [
                {
                  "type": "var",
                  "value": "gt"
                }
              ]
            },
            {
              "type": "var",
              "value": "__local18__"
            },
            {
              "type": "number",
              "value": 0
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 40,
          "col": 5
        },
        "QueryID": 4,
        "ParentID": 3,
        "Locals": [
          {
            "name": "__local44__",
            "type": "set",
            "value": []
          },
          {
            "name": "__local18__",
            "type": "number",
            "value": 0
          }
        ],
        "LocalMetadata": {
          "__local18__": {
            "name": "__local18__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 40,
              "col": 5
            }
          },
          "__local44__": {
            "name": "__local44__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 40,
              "col": 11
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Enter",
        "Node": {
          "head": {
            "name": "status",
            "value": {
              "type": "object",
              "value": [
                [
                  {
                    "type": "string",
                    "value": "allowed"
                  },
                  {
                    "type": "boolean",
                    "value": false
                  }
                ],
                [
                  {
                    "type": "string",
                    "value": "reason"
                  },
                  {
                    "type": "var",
                    "value": "__local19__"
                  }
                ]
              ]
            }
          },
          "body": [
            {
              "generated": true,
              "index": 0,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local46__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "accessToResourceNotAllowed"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 1,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "count"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local46__"
                },
                {
                  "type": "var",
                  "value": "__local20__"
                }
              ]
            },
            {
              "index": 2,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "gt"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local20__"
                },
                {
                  "type": "number",
                  "value": 0
                }
              ]
            },
            {
              "generated": true,
              "index": 3,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local47__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "accessToResourceNotAllowed"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 4,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "concat"
                    }
                  ]
                },
                {
                  "type": "string",
                  "value": " | "
                },
                {
                  "type": "var",
                  "value": "__local47__"
                },
                {
                  "type": "var",
                  "value": "__local19__"
                }
              ]
            }
          ],
          "else": {
            "head": {
              "name": "status",
              "value": {
                "type": "object",
                "value": [
                  [
                    {
                      "type": "string",
                      "value": "allowed"
                    },
                    {
                      "type": "boolean",
                      "value": true
                    }
                  ],
                  [
                    {
                      "type": "string",
                      "value": "reason"
                    },
                    {
                      "type": "string",
                      "value": "Access allowed, all rules passed"
                    }
                  ]
                ]
              }
            },
            "body": [
              {
                "index": 0,
                "terms": {
                  "type": "boolean",
                  "value": true
                }
              }
            ]
          }
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 41,
          "col": 3
        },
        "QueryID": 7,
        "ParentID": 3,
        "Locals": null,
        "LocalMetadata": {},
        "Message": ""
      },
      {
        "Op": "Enter",
        "Node": {
          "head": {
            "name": "accessToResourceNotAllowed",
            "key": {
              "type": "var",
              "value": "__local0__"
            }
          },
          "body": [
            {
              "index": 0,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "jwtDecoded"
                    }
                  ]
                },
                {
                  "type": "object",
                  "value": []
                }
              ]
            },
            {
              "index": 1,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local0__"
                },
                {
                  "type": "string",
                  "value": "Invalid input, missing JWT"
                }
              ]
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 12,
          "col": 1
        },
        "QueryID": 8,
        "ParentID": 7,
        "Locals": null,
        "LocalMetadata": {
          "__local0__": {
            "name": "reason",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 12,
              "col": 28
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Fail",
        "Node": {
          "index": 0,
          "terms": [
            {
              "type": "ref",
              "value": [
                {
                  "type": "var",
                  "value": "eq"
                }
              ]
            },
            {
              "type": "ref",
              "value": [
                {
                  "type": "var",
                  "value": "data"
                },
                {
                  "type": "string",
                  "value": "http"
                },
                {
                  "type": "string",
                  "value": "request"
                },
                {
                  "type": "string",
                  "value": "authz"
                },
                {
                  "type": "string",
                  "value": "jwtDecoded"
                }
              ]
            },
            {
              "type": "object",
              "value": []
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 13,
          "col": 5
        },
        "QueryID": 8,
        "ParentID": 7,
        "Locals": null,
        "LocalMetadata": {},
        "Message": ""
      },
      {
        "Op": "Enter",
        "Node": {
          "head": {
            "name": "accessToResourceNotAllowed",
            "key": {
              "type": "var",
              "value": "__local1__"
            }
          },
          "body": [
            {
              "index": 0,
              "negated": true,
              "terms": {
                "type": "ref",
                "value": [
                  {
                    "type": "var",
                    "value": "input"
                  },
                  {
                    "type": "string",
                    "value": "path"
                  }
                ]
              }
            },
            {
              "index": 1,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local1__"
                },
                {
                  "type": "string",
                  "value": "Invalid input, can't extract path"
                }
              ]
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 17,
          "col": 1
        },
        "QueryID": 10,
        "ParentID": 7,
        "Locals": null,
        "LocalMetadata": {
          "__local1__": {
            "name": "reason",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 17,
              "col": 28
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Fail",
        "Node": {
          "index": 0,
          "negated": true,
          "terms": {
            "type": "ref",
            "value": [
              {
                "type": "var",
                "value": "input"
              },
              {
                "type": "string",
                "value": "path"
              }
            ]
          }
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 18,
          "col": 9
        },
        "QueryID": 10,
        "ParentID": 7,
        "Locals": null,
        "LocalMetadata": {},
        "Message": ""
      },
      {
        "Op": "Enter",
        "Node": {
          "head": {
            "name": "accessToResourceNotAllowed",
            "key": {
              "type": "var",
              "value": "__local2__"
            }
          },
          "body": [
            {
              "generated": true,
              "index": 0,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local31__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "input"
                    },
                    {
                      "type": "string",
                      "value": "path"
                    }
                  ]
                }
              ]
            },
            {
              "index": 1,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "startswith"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local31__"
                },
                {
                  "type": "string",
                  "value": "/messages"
                }
              ]
            },
            {
              "generated": true,
              "index": 2,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local32__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "groupsFromJwt"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 3,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local33__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "allowedGroups"
                    }
                  ]
                }
              ]
            },
            {
              "index": 4,
              "negated": true,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "lists_intersect"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local32__"
                },
                {
                  "type": "var",
                  "value": "__local33__"
                }
              ]
            },
            {
              "generated": true,
              "index": 5,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local34__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "input"
                    },
                    {
                      "type": "string",
                      "value": "path"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 6,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local35__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "allowedGroups"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 7,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "sprintf"
                    }
                  ]
                },
                {
                  "type": "string",
                  "value": "Not allowed to access '%v', required group: '%v'"
                },
                {
                  "type": "array",
                  "value": [
                    {
                      "type": "var",
                      "value": "__local34__"
                    },
                    {
                      "type": "var",
                      "value": "__local35__"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local14__"
                }
              ]
            },
            {
              "index": 8,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local2__"
                },
                {
                  "type": "var",
                  "value": "__local14__"
                }
              ]
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 22,
          "col": 1
        },
        "QueryID": 12,
        "ParentID": 7,
        "Locals": null,
        "LocalMetadata": {
          "__local2__": {
            "name": "reason",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 22,
              "col": 28
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Fail",
        "Node": {
          "index": 4,
          "negated": true,
          "terms": [
            {
              "type": "ref",
              "value": [
                {
                  "type": "var",
                  "value": "data"
                },
                {
                  "type": "string",
                  "value": "http"
                },
                {
                  "type": "string",
                  "value": "request"
                },
                {
                  "type": "string",
                  "value": "authz"
                },
                {
                  "type": "string",
                  "value": "lists_intersect"
                }
              ]
            },
            {
              "type": "var",
              "value": "__local32__"
            },
            {
              "type": "var",
              "value": "__local33__"
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 24,
          "col": 9
        },
        "QueryID": 12,
        "ParentID": 7,
        "Locals": [
          {
            "name": "__local32__",
            "type": "array",
            "value": [
              {
                "type": "string",
                "value": "sec-ODP-Data-Controller"
              }
            ]
          },
          {
            "name": "__local33__",
            "type": "array",
            "value": [
              {
                "type": "string",
                "value": "sec-ODP-Developer"
              },
              {
                "type": "string",
                "value": "sec-ODP-Data-Controller"
              }
            ]
          },
          {
            "name": "__local31__",
            "type": "string",
            "value": "/messages"
          }
        ],
        "LocalMetadata": {
          "__local31__": {
            "name": "__local31__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 23,
              "col": 16
            }
          },
          "__local32__": {
            "name": "__local32__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 24,
              "col": 25
            }
          },
          "__local33__": {
            "name": "__local33__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 24,
              "col": 40
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Enter",
        "Node": {
          "head": {
            "name": "accessToResourceNotAllowed",
            "key": {
              "type": "var",
              "value": "__local3__"
            }
          },
          "body": [
            {
              "generated": true,
              "index": 0,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local36__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "input"
                    },
                    {
                      "type": "string",
                      "value": "path"
                    }
                  ]
                }
              ]
            },
            {
              "index": 1,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "startswith"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local36__"
                },
                {
                  "type": "string",
                  "value": "/statistics"
                }
              ]
            },
            {
              "generated": true,
              "index": 2,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local37__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "groupsFromJwt"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 3,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local38__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "allowedGroups"
                    }
                  ]
                }
              ]
            },
            {
              "index": 4,
              "negated": true,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "lists_intersect"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local37__"
                },
                {
                  "type": "var",
                  "value": "__local38__"
                }
              ]
            },
            {
              "generated": true,
              "index": 5,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local39__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "input"
                    },
                    {
                      "type": "string",
                      "value": "path"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 6,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local40__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "allowedGroups"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 7,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "sprintf"
                    }
                  ]
                },
                {
                  "type": "string",
                  "value": "Not allowed to access '%v', required group: '%v'"
                },
                {
                  "type": "array",
                  "value": [
                    {
                      "type": "var",
                      "value": "__local39__"
                    },
                    {
                      "type": "var",
                      "value": "__local40__"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local15__"
                }
              ]
            },
            {
              "index": 8,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local3__"
                },
                {
                  "type": "var",
                  "value": "__local15__"
                }
              ]
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 28,
          "col": 1
        },
        "QueryID": 17,
        "ParentID": 7,
        "Locals": null,
        "LocalMetadata": {
          "__local3__": {
            "name": "reason",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 28,
              "col": 28
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Fail",
        "Node": {
          "index": 1,
          "terms": [
            {
              "type": "ref",
              "value": [
                {
                  "type": "var",
                  "value": "startswith"
                }
              ]
            },
            {
              "type": "var",
              "value": "__local36__"
            },
            {
              "type": "string",
              "value": "/statistics"
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 29,
          "col": 5
        },
        "QueryID": 17,
        "ParentID": 7,
        "Locals": [
          {
            "name": "__local36__",
            "type": "string",
            "value": "/messages"
          }
        ],
        "LocalMetadata": {
          "__local36__": {
            "name": "__local36__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 29,
              "col": 16
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Fail",
        "Node": {
          "index": 2,
          "terms": [
            {
              "type": "ref",
              "value": [
                {
                  "type": "var",
                  "value": "gt"
                }
              ]
            },
            {
              "type": "var",
              "value": "__local20__"
            },
            {
              "type": "number",
              "value": 0
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 42,
          "col": 5
        },
        "QueryID": 7,
        "ParentID": 3,
        "Locals": [
          {
            "name": "__local46__",
            "type": "set",
            "value": []
          },
          {
            "name": "__local20__",
            "type": "number",
            "value": 0
          }
        ],
        "LocalMetadata": {
          "__local20__": {
            "name": "__local20__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 42,
              "col": 5
            }
          },
          "__local46__": {
            "name": "__local46__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 42,
              "col": 11
            }
          }
        },
        "Message": ""
      }
    ]
  },
  {
    "location": {
      "file": "src/test/resources/opa/policies/policies-test.rego",
      "row": 44,
      "col": 1
    },
    "package": "data.http.request.authz",
    "name": "test_not_allow_if_jwt_without_grop_for_statistics",
    "duration": 1985184,
    "trace": [
      {
        "Op": "Enter",
        "Node": [
          {
            "index": 0,
            "terms": [
              {
                "type": "ref",
                "value": [
                  {
                    "type": "var",
                    "value": "eq"
                  }
                ]
              },
              {
                "type": "ref",
                "value": [
                  {
                    "type": "var",
                    "value": "data"
                  },
                  {
                    "type": "string",
                    "value": "http"
                  },
                  {
                    "type": "string",
                    "value": "request"
                  },
                  {
                    "type": "string",
                    "value": "authz"
                  },
                  {
                    "type": "string",
                    "value": "test_not_allow_if_jwt_without_grop_for_statistics"
                  }
                ]
              },
              {
                "type": "var",
                "value": "$term1"
              }
            ]
          }
        ],
        "Location": {
          "file": "",
          "row": 1,
          "col": 1
        },
        "QueryID": 0,
        "ParentID": 0,
        "Locals": null,
        "LocalMetadata": {},
        "Message": ""
      },
      {
        "Op": "Enter",
        "Node": {
          "head": {
            "name": "test_not_allow_if_jwt_without_grop_for_statistics",
            "value": {
              "type": "boolean",
              "value": true
            }
          },
          "body": [
            {
              "generated": true,
              "index": 0,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "generateJWT"
                    }
                  ]
                },
                {
                  "type": "string",
                  "value": ""
                },
                {
                  "type": "var",
                  "value": "__local26__"
                }
              ]
            },
            {
              "index": 1,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local11__"
                },
                {
                  "type": "var",
                  "value": "__local26__"
                }
              ]
            },
            {
              "index": 2,
              "negated": true,
              "terms": {
                "type": "ref",
                "value": [
                  {
                    "type": "var",
                    "value": "data"
                  },
                  {
                    "type": "string",
                    "value": "http"
                  },
                  {
                    "type": "string",
                    "value": "request"
                  },
                  {
                    "type": "string",
                    "value": "authz"
                  },
                  {
                    "type": "string",
                    "value": "allow"
                  }
                ]
              },
              "with": [
                {
                  "target": {
                    "type": "ref",
                    "value": [
                      {
                        "type": "var",
                        "value": "input"
                      }
                    ]
                  },
                  "value": {
                    "type": "object",
                    "value": [
                      [
                        {
                          "type": "string",
                          "value": "encodedJwt"
                        },
                        {
                          "type": "var",
                          "value": "__local11__"
                        }
                      ],
                      [
                        {
                          "type": "string",
                          "value": "path"
                        },
                        {
                          "type": "string",
                          "value": "/statistics"
                        }
                      ]
                    ]
                  }
                }
              ]
            }
          ]
        },
        "Location": {
          "file": "src/test/resources/opa/policies/policies-test.rego",
          "row": 44,
          "col": 1
        },
        "QueryID": 1,
        "ParentID": 0,
        "Locals": null,
        "LocalMetadata": {
          "__local11__": {
            "name": "jwt",
            "location": {
              "file": "src/test/resources/opa/policies/policies-test.rego",
              "row": 45,
              "col": 5
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Enter",
        "Node": [
          {
            "index": 0,
            "terms": {
              "type": "ref",
              "value": [
                {
                  "type": "var",
                  "value": "data"
                },
                {
                  "type": "string",
                  "value": "http"
                },
                {
                  "type": "string",
                  "value": "request"
                },
                {
                  "type": "string",
                  "value": "authz"
                },
                {
                  "type": "string",
                  "value": "allow"
                }
              ]
            }
          }
        ],
        "Location": {
          "file": "src/test/resources/opa/policies/policies-test.rego",
          "row": 46,
          "col": 9
        },
        "QueryID": 3,
        "ParentID": 1,
        "Locals": [
          {
            "name": "__local26__",
            "type": "string",
            "value": "eyJhbGciOiAiUlMyNTYiLCAidHlwIjogIkpXVCJ9.eyJjbGllbnRfaWQiOiAib2RwLWRpc21pdCIsICJleHAiOiAxNTgxOTU3NzIxLCAib2RwIjogeyJncm91cHMiOiBbIiJdfSwgInB1cnBvc2UiOiAiYWNjZXNzX3Rva2VuIiwgInNjb3BlIjogIm9wYS1kaXNtaXQiLCAidXNlcm5hbWUiOiAib2RwLWRpc21pdCJ9.V60AwDLqzNfzfOd-R0gxqPHaYU3ok91ogwAvttSuIoZERfevj9qNwaKtp0vfSgpMwAPleXAgDB1ACQbK7ZlQpgqO9npZw3gEELPJaAUcigJs1YgWRz7Yhy1cSDQULK5LycecO_iMPnJtTLR1jrKGdbe-THdXylt2XADxU2MzYHvebf9gNNUZhW_cFyT9RoyxnkPt5t3ktv-WGhwu9x95iedSSQtP3ktuWTOXjavURcVRLwlL7RV1Z5sjcniiMfWNYFcXRQOemKMqvqWIkTzzuaQOCbBIp-gp00EvkNi2-9FFnzZ2_mxha95WSFMypQl5HzCgiPyl3PJ_XExuXRPjLg"
          },
          {
            "name": "__local11__",
            "type": "string",
            "value": "eyJhbGciOiAiUlMyNTYiLCAidHlwIjogIkpXVCJ9.eyJjbGllbnRfaWQiOiAib2RwLWRpc21pdCIsICJleHAiOiAxNTgxOTU3NzIxLCAib2RwIjogeyJncm91cHMiOiBbIiJdfSwgInB1cnBvc2UiOiAiYWNjZXNzX3Rva2VuIiwgInNjb3BlIjogIm9wYS1kaXNtaXQiLCAidXNlcm5hbWUiOiAib2RwLWRpc21pdCJ9.V60AwDLqzNfzfOd-R0gxqPHaYU3ok91ogwAvttSuIoZERfevj9qNwaKtp0vfSgpMwAPleXAgDB1ACQbK7ZlQpgqO9npZw3gEELPJaAUcigJs1YgWRz7Yhy1cSDQULK5LycecO_iMPnJtTLR1jrKGdbe-THdXylt2XADxU2MzYHvebf9gNNUZhW_cFyT9RoyxnkPt5t3ktv-WGhwu9x95iedSSQtP3ktuWTOXjavURcVRLwlL7RV1Z5sjcniiMfWNYFcXRQOemKMqvqWIkTzzuaQOCbBIp-gp00EvkNi2-9FFnzZ2_mxha95WSFMypQl5HzCgiPyl3PJ_XExuXRPjLg"
          }
        ],
        "LocalMetadata": {
          "__local11__": {
            "name": "jwt",
            "location": {
              "file": "src/test/resources/opa/policies/policies-test.rego",
              "row": 45,
              "col": 5
            }
          },
          "__local26__": {
            "name": "__local26__",
            "location": {
              "file": "src/test/resources/opa/policies/policies-test.rego",
              "row": 45,
              "col": 12
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Enter",
        "Node": {
          "head": {
            "name": "allow",
            "value": {
              "type": "var",
              "value": "__local29__"
            }
          },
          "body": [
            {
              "index": 0,
              "terms": {
                "type": "boolean",
                "value": true
              }
            },
            {
              "generated": true,
              "index": 1,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local29__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "status"
                    },
                    {
                      "type": "string",
                      "value": "allowed"
                    }
                  ]
                }
              ]
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 47,
          "col": 9
        },
        "QueryID": 4,
        "ParentID": 3,
        "Locals": null,
        "LocalMetadata": {},
        "Message": ""
      },
      {
        "Op": "Enter",
        "Node": {
          "head": {
            "name": "status",
            "value": {
              "type": "object",
              "value": [
                [
                  {
                    "type": "string",
                    "value": "allowed"
                  },
                  {
                    "type": "boolean",
                    "value": true
                  }
                ],
                [
                  {
                    "type": "string",
                    "value": "reason"
                  },
                  {
                    "type": "var",
                    "value": "__local17__"
                  }
                ]
              ]
            }
          },
          "body": [
            {
              "generated": true,
              "index": 0,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local44__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "accessToWhitelistAllowed"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 1,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "count"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local44__"
                },
                {
                  "type": "var",
                  "value": "__local18__"
                }
              ]
            },
            {
              "index": 2,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "gt"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local18__"
                },
                {
                  "type": "number",
                  "value": 0
                }
              ]
            },
            {
              "generated": true,
              "index": 3,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local45__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "accessToWhitelistAllowed"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 4,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "concat"
                    }
                  ]
                },
                {
                  "type": "string",
                  "value": " | "
                },
                {
                  "type": "var",
                  "value": "__local45__"
                },
                {
                  "type": "var",
                  "value": "__local17__"
                }
              ]
            }
          ],
          "else": {
            "head": {
              "name": "status",
              "value": {
                "type": "object",
                "value": [
                  [
                    {
                      "type": "string",
                      "value": "allowed"
                    },
                    {
                      "type": "boolean",
                      "value": false
                    }
                  ],
                  [
                    {
                      "type": "string",
                      "value": "reason"
                    },
                    {
                      "type": "var",
                      "value": "__local19__"
                    }
                  ]
                ]
              }
            },
            "body": [
              {
                "generated": true,
                "index": 0,
                "terms": [
                  {
                    "type": "ref",
                    "value": [
                      {
                        "type": "var",
                        "value": "eq"
                      }
                    ]
                  },
                  {
                    "type": "var",
                    "value": "__local46__"
                  },
                  {
                    "type": "ref",
                    "value": [
                      {
                        "type": "var",
                        "value": "data"
                      },
                      {
                        "type": "string",
                        "value": "http"
                      },
                      {
                        "type": "string",
                        "value": "request"
                      },
                      {
                        "type": "string",
                        "value": "authz"
                      },
                      {
                        "type": "string",
                        "value": "accessToResourceNotAllowed"
                      }
                    ]
                  }
                ]
              },
              {
                "generated": true,
                "index": 1,
                "terms": [
                  {
                    "type": "ref",
                    "value": [
                      {
                        "type": "var",
                        "value": "count"
                      }
                    ]
                  },
                  {
                    "type": "var",
                    "value": "__local46__"
                  },
                  {
                    "type": "var",
                    "value": "__local20__"
                  }
                ]
              },
              {
                "index": 2,
                "terms": [
                  {
                    "type": "ref",
                    "value": [
                      {
                        "type": "var",
                        "value": "gt"
                      }
                    ]
                  },
                  {
                    "type": "var",
                    "value": "__local20__"
                  },
                  {
                    "type": "number",
                    "value": 0
                  }
                ]
              },
              {
                "generated": true,
                "index": 3,
                "terms": [
                  {
                    "type": "ref",
                    "value": [
                      {
                        "type": "var",
                        "value": "eq"
                      }
                    ]
                  },
                  {
                    "type": "var",
                    "value": "__local47__"
                  },
                  {
                    "type": "ref",
                    "value": [
                      {
                        "type": "var",
                        "value": "data"
                      },
                      {
                        "type": "string",
                        "value": "http"
                      },
                      {
                        "type": "string",
                        "value": "request"
                      },
                      {
                        "type": "string",
                        "value": "authz"
                      },
                      {
                        "type": "string",
                        "value": "accessToResourceNotAllowed"
                      }
                    ]
                  }
                ]
              },
              {
                "generated": true,
                "index": 4,
                "terms": [
                  {
                    "type": "ref",
                    "value": [
                      {
                        "type": "var",
                        "value": "concat"
                      }
                    ]
                  },
                  {
                    "type": "string",
                    "value": " | "
                  },
                  {
                    "type": "var",
                    "value": "__local47__"
                  },
                  {
                    "type": "var",
                    "value": "__local19__"
                  }
                ]
              }
            ],
            "else": {
              "head": {
                "name": "status",
                "value": {
                  "type": "object",
                  "value": [
                    [
                      {
                        "type": "string",
                        "value": "allowed"
                      },
                      {
                        "type": "boolean",
                        "value": true
                      }
                    ],
                    [
                      {
                        "type": "string",
                        "value": "reason"
                      },
                      {
                        "type": "string",
                        "value": "Access allowed, all rules passed"
                      }
                    ]
                  ]
                }
              },
              "body": [
                {
                  "index": 0,
                  "terms": {
                    "type": "boolean",
                    "value": true
                  }
                }
              ]
            }
          }
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 39,
          "col": 1
        },
        "QueryID": 5,
        "ParentID": 4,
        "Locals": null,
        "LocalMetadata": {},
        "Message": ""
      },
      {
        "Op": "Enter",
        "Node": {
          "head": {
            "name": "accessToWhitelistAllowed",
            "key": {
              "type": "var",
              "value": "__local4__"
            }
          },
          "body": [
            {
              "generated": true,
              "index": 0,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local41__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "input"
                    },
                    {
                      "type": "string",
                      "value": "path"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 1,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local42__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "whitelistedEndpoints"
                    },
                    {
                      "type": "var",
                      "value": "$0"
                    }
                  ]
                }
              ]
            },
            {
              "index": 2,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "startswith"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local41__"
                },
                {
                  "type": "var",
                  "value": "__local42__"
                }
              ]
            },
            {
              "generated": true,
              "index": 3,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local43__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "input"
                    },
                    {
                      "type": "string",
                      "value": "path"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 4,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "sprintf"
                    }
                  ]
                },
                {
                  "type": "string",
                  "value": "Resource '%v' on whitelist"
                },
                {
                  "type": "array",
                  "value": [
                    {
                      "type": "var",
                      "value": "__local43__"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local16__"
                }
              ]
            },
            {
              "index": 5,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local4__"
                },
                {
                  "type": "var",
                  "value": "__local16__"
                }
              ]
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 34,
          "col": 1
        },
        "QueryID": 6,
        "ParentID": 5,
        "Locals": null,
        "LocalMetadata": {
          "__local4__": {
            "name": "reason",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 34,
              "col": 26
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Fail",
        "Node": {
          "index": 2,
          "terms": [
            {
              "type": "ref",
              "value": [
                {
                  "type": "var",
                  "value": "startswith"
                }
              ]
            },
            {
              "type": "var",
              "value": "__local41__"
            },
            {
              "type": "var",
              "value": "__local42__"
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 35,
          "col": 5
        },
        "QueryID": 6,
        "ParentID": 5,
        "Locals": [
          {
            "name": "__local41__",
            "type": "string",
            "value": "/statistics"
          },
          {
            "name": "_",
            "type": "number",
            "value": 0
          },
          {
            "name": "__local42__",
            "type": "string",
            "value": "/ping"
          }
        ],
        "LocalMetadata": {
          "$0": {
            "name": "$0",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 35,
              "col": 49
            }
          },
          "__local41__": {
            "name": "__local41__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 35,
              "col": 16
            }
          },
          "__local42__": {
            "name": "__local42__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 35,
              "col": 28
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Fail",
        "Node": {
          "index": 2,
          "terms": [
            {
              "type": "ref",
              "value": [
                {
                  "type": "var",
                  "value": "startswith"
                }
              ]
            },
            {
              "type": "var",
              "value": "__local41__"
            },
            {
              "type": "var",
              "value": "__local42__"
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 35,
          "col": 5
        },
        "QueryID": 6,
        "ParentID": 5,
        "Locals": [
          {
            "name": "__local41__",
            "type": "string",
            "value": "/statistics"
          },
          {
            "name": "_",
            "type": "number",
            "value": 1
          },
          {
            "name": "__local42__",
            "type": "string",
            "value": "/error"
          }
        ],
        "LocalMetadata": {
          "$0": {
            "name": "$0",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 35,
              "col": 49
            }
          },
          "__local41__": {
            "name": "__local41__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 35,
              "col": 16
            }
          },
          "__local42__": {
            "name": "__local42__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 35,
              "col": 28
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Fail",
        "Node": {
          "index": 2,
          "terms": [
            {
              "type": "ref",
              "value": [
                {
                  "type": "var",
                  "value": "startswith"
                }
              ]
            },
            {
              "type": "var",
              "value": "__local41__"
            },
            {
              "type": "var",
              "value": "__local42__"
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 35,
          "col": 5
        },
        "QueryID": 6,
        "ParentID": 5,
        "Locals": [
          {
            "name": "__local41__",
            "type": "string",
            "value": "/statistics"
          },
          {
            "name": "_",
            "type": "number",
            "value": 2
          },
          {
            "name": "__local42__",
            "type": "string",
            "value": "/health"
          }
        ],
        "LocalMetadata": {
          "$0": {
            "name": "$0",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 35,
              "col": 49
            }
          },
          "__local41__": {
            "name": "__local41__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 35,
              "col": 16
            }
          },
          "__local42__": {
            "name": "__local42__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 35,
              "col": 28
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Fail",
        "Node": {
          "index": 2,
          "terms": [
            {
              "type": "ref",
              "value": [
                {
                  "type": "var",
                  "value": "gt"
                }
              ]
            },
            {
              "type": "var",
              "value": "__local18__"
            },
            {
              "type": "number",
              "value": 0
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 40,
          "col": 5
        },
        "QueryID": 5,
        "ParentID": 4,
        "Locals": [
          {
            "name": "__local44__",
            "type": "set",
            "value": []
          },
          {
            "name": "__local18__",
            "type": "number",
            "value": 0
          }
        ],
        "LocalMetadata": {
          "__local18__": {
            "name": "__local18__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 40,
              "col": 5
            }
          },
          "__local44__": {
            "name": "__local44__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 40,
              "col": 11
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Enter",
        "Node": {
          "head": {
            "name": "status",
            "value": {
              "type": "object",
              "value": [
                [
                  {
                    "type": "string",
                    "value": "allowed"
                  },
                  {
                    "type": "boolean",
                    "value": false
                  }
                ],
                [
                  {
                    "type": "string",
                    "value": "reason"
                  },
                  {
                    "type": "var",
                    "value": "__local19__"
                  }
                ]
              ]
            }
          },
          "body": [
            {
              "generated": true,
              "index": 0,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local46__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "accessToResourceNotAllowed"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 1,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "count"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local46__"
                },
                {
                  "type": "var",
                  "value": "__local20__"
                }
              ]
            },
            {
              "index": 2,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "gt"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local20__"
                },
                {
                  "type": "number",
                  "value": 0
                }
              ]
            },
            {
              "generated": true,
              "index": 3,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local47__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "accessToResourceNotAllowed"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 4,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "concat"
                    }
                  ]
                },
                {
                  "type": "string",
                  "value": " | "
                },
                {
                  "type": "var",
                  "value": "__local47__"
                },
                {
                  "type": "var",
                  "value": "__local19__"
                }
              ]
            }
          ],
          "else": {
            "head": {
              "name": "status",
              "value": {
                "type": "object",
                "value": [
                  [
                    {
                      "type": "string",
                      "value": "allowed"
                    },
                    {
                      "type": "boolean",
                      "value": true
                    }
                  ],
                  [
                    {
                      "type": "string",
                      "value": "reason"
                    },
                    {
                      "type": "string",
                      "value": "Access allowed, all rules passed"
                    }
                  ]
                ]
              }
            },
            "body": [
              {
                "index": 0,
                "terms": {
                  "type": "boolean",
                  "value": true
                }
              }
            ]
          }
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 41,
          "col": 3
        },
        "QueryID": 8,
        "ParentID": 4,
        "Locals": null,
        "LocalMetadata": {},
        "Message": ""
      },
      {
        "Op": "Enter",
        "Node": {
          "head": {
            "name": "accessToResourceNotAllowed",
            "key": {
              "type": "var",
              "value": "__local0__"
            }
          },
          "body": [
            {
              "index": 0,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "jwtDecoded"
                    }
                  ]
                },
                {
                  "type": "object",
                  "value": []
                }
              ]
            },
            {
              "index": 1,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local0__"
                },
                {
                  "type": "string",
                  "value": "Invalid input, missing JWT"
                }
              ]
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 12,
          "col": 1
        },
        "QueryID": 9,
        "ParentID": 8,
        "Locals": null,
        "LocalMetadata": {
          "__local0__": {
            "name": "reason",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 12,
              "col": 28
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Fail",
        "Node": {
          "index": 0,
          "terms": [
            {
              "type": "ref",
              "value": [
                {
                  "type": "var",
                  "value": "eq"
                }
              ]
            },
            {
              "type": "ref",
              "value": [
                {
                  "type": "var",
                  "value": "data"
                },
                {
                  "type": "string",
                  "value": "http"
                },
                {
                  "type": "string",
                  "value": "request"
                },
                {
                  "type": "string",
                  "value": "authz"
                },
                {
                  "type": "string",
                  "value": "jwtDecoded"
                }
              ]
            },
            {
              "type": "object",
              "value": []
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 13,
          "col": 5
        },
        "QueryID": 9,
        "ParentID": 8,
        "Locals": null,
        "LocalMetadata": {},
        "Message": ""
      },
      {
        "Op": "Enter",
        "Node": {
          "head": {
            "name": "accessToResourceNotAllowed",
            "key": {
              "type": "var",
              "value": "__local1__"
            }
          },
          "body": [
            {
              "index": 0,
              "negated": true,
              "terms": {
                "type": "ref",
                "value": [
                  {
                    "type": "var",
                    "value": "input"
                  },
                  {
                    "type": "string",
                    "value": "path"
                  }
                ]
              }
            },
            {
              "index": 1,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local1__"
                },
                {
                  "type": "string",
                  "value": "Invalid input, can't extract path"
                }
              ]
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 17,
          "col": 1
        },
        "QueryID": 11,
        "ParentID": 8,
        "Locals": null,
        "LocalMetadata": {
          "__local1__": {
            "name": "reason",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 17,
              "col": 28
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Fail",
        "Node": {
          "index": 0,
          "negated": true,
          "terms": {
            "type": "ref",
            "value": [
              {
                "type": "var",
                "value": "input"
              },
              {
                "type": "string",
                "value": "path"
              }
            ]
          }
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 18,
          "col": 9
        },
        "QueryID": 11,
        "ParentID": 8,
        "Locals": null,
        "LocalMetadata": {},
        "Message": ""
      },
      {
        "Op": "Enter",
        "Node": {
          "head": {
            "name": "accessToResourceNotAllowed",
            "key": {
              "type": "var",
              "value": "__local2__"
            }
          },
          "body": [
            {
              "generated": true,
              "index": 0,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local31__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "input"
                    },
                    {
                      "type": "string",
                      "value": "path"
                    }
                  ]
                }
              ]
            },
            {
              "index": 1,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "startswith"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local31__"
                },
                {
                  "type": "string",
                  "value": "/messages"
                }
              ]
            },
            {
              "generated": true,
              "index": 2,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local32__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "groupsFromJwt"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 3,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local33__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "allowedGroups"
                    }
                  ]
                }
              ]
            },
            {
              "index": 4,
              "negated": true,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "lists_intersect"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local32__"
                },
                {
                  "type": "var",
                  "value": "__local33__"
                }
              ]
            },
            {
              "generated": true,
              "index": 5,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local34__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "input"
                    },
                    {
                      "type": "string",
                      "value": "path"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 6,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local35__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "allowedGroups"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 7,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "sprintf"
                    }
                  ]
                },
                {
                  "type": "string",
                  "value": "Not allowed to access '%v', required group: '%v'"
                },
                {
                  "type": "array",
                  "value": [
                    {
                      "type": "var",
                      "value": "__local34__"
                    },
                    {
                      "type": "var",
                      "value": "__local35__"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local14__"
                }
              ]
            },
            {
              "index": 8,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local2__"
                },
                {
                  "type": "var",
                  "value": "__local14__"
                }
              ]
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 22,
          "col": 1
        },
        "QueryID": 13,
        "ParentID": 8,
        "Locals": null,
        "LocalMetadata": {
          "__local2__": {
            "name": "reason",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 22,
              "col": 28
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Fail",
        "Node": {
          "index": 1,
          "terms": [
            {
              "type": "ref",
              "value": [
                {
                  "type": "var",
                  "value": "startswith"
                }
              ]
            },
            {
              "type": "var",
              "value": "__local31__"
            },
            {
              "type": "string",
              "value": "/messages"
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 23,
          "col": 5
        },
        "QueryID": 13,
        "ParentID": 8,
        "Locals": [
          {
            "name": "__local31__",
            "type": "string",
            "value": "/statistics"
          }
        ],
        "LocalMetadata": {
          "__local31__": {
            "name": "__local31__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 23,
              "col": 16
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Enter",
        "Node": {
          "head": {
            "name": "accessToResourceNotAllowed",
            "key": {
              "type": "var",
              "value": "__local3__"
            }
          },
          "body": [
            {
              "generated": true,
              "index": 0,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local36__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "input"
                    },
                    {
                      "type": "string",
                      "value": "path"
                    }
                  ]
                }
              ]
            },
            {
              "index": 1,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "startswith"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local36__"
                },
                {
                  "type": "string",
                  "value": "/statistics"
                }
              ]
            },
            {
              "generated": true,
              "index": 2,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local37__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "groupsFromJwt"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 3,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local38__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "allowedGroups"
                    }
                  ]
                }
              ]
            },
            {
              "index": 4,
              "negated": true,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "lists_intersect"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local37__"
                },
                {
                  "type": "var",
                  "value": "__local38__"
                }
              ]
            },
            {
              "generated": true,
              "index": 5,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local39__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "input"
                    },
                    {
                      "type": "string",
                      "value": "path"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 6,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local40__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "allowedGroups"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 7,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "sprintf"
                    }
                  ]
                },
                {
                  "type": "string",
                  "value": "Not allowed to access '%v', required group: '%v'"
                },
                {
                  "type": "array",
                  "value": [
                    {
                      "type": "var",
                      "value": "__local39__"
                    },
                    {
                      "type": "var",
                      "value": "__local40__"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local15__"
                }
              ]
            },
            {
              "index": 8,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local3__"
                },
                {
                  "type": "var",
                  "value": "__local15__"
                }
              ]
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 28,
          "col": 1
        },
        "QueryID": 14,
        "ParentID": 8,
        "Locals": null,
        "LocalMetadata": {
          "__local3__": {
            "name": "reason",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 28,
              "col": 28
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Enter",
        "Node": [
          {
            "index": 0,
            "terms": [
              {
                "type": "ref",
                "value": [
                  {
                    "type": "var",
                    "value": "data"
                  },
                  {
                    "type": "string",
                    "value": "http"
                  },
                  {
                    "type": "string",
                    "value": "request"
                  },
                  {
                    "type": "string",
                    "value": "authz"
                  },
                  {
                    "type": "string",
                    "value": "lists_intersect"
                  }
                ]
              },
              {
                "type": "var",
                "value": "__local37__"
              },
              {
                "type": "var",
                "value": "__local38__"
              }
            ]
          }
        ],
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 30,
          "col": 9
        },
        "QueryID": 17,
        "ParentID": 14,
        "Locals": [
          {
            "name": "__local36__",
            "type": "string",
            "value": "/statistics"
          },
          {
            "name": "__local37__",
            "type": "array",
            "value": [
              {
                "type": "string",
                "value": ""
              }
            ]
          },
          {
            "name": "__local38__",
            "type": "array",
            "value": [
              {
                "type": "string",
                "value": "sec-ODP-Developer"
              },
              {
                "type": "string",
                "value": "sec-ODP-Data-Controller"
              }
            ]
          }
        ],
        "LocalMetadata": {
          "__local36__": {
            "name": "__local36__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 29,
              "col": 16
            }
          },
          "__local37__": {
            "name": "__local37__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 30,
              "col": 25
            }
          },
          "__local38__": {
            "name": "__local38__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 30,
              "col": 40
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Enter",
        "Node": {
          "head": {
            "name": "lists_intersect",
            "args": [
              {
                "type": "var",
                "value": "list1"
              },
              {
                "type": "var",
                "value": "list2"
              }
            ],
            "value": {
              "type": "boolean",
              "value": true
            }
          },
          "body": [
            {
              "index": 0,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "list1"
                    },
                    {
                      "type": "var",
                      "value": "$2"
                    }
                  ]
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "list2"
                    },
                    {
                      "type": "var",
                      "value": "$3"
                    }
                  ]
                }
              ]
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 75,
          "col": 1
        },
        "QueryID": 18,
        "ParentID": 17,
        "Locals": null,
        "LocalMetadata": {},
        "Message": ""
      },
      {
        "Op": "Fail",
        "Node": {
          "index": 0,
          "terms": [
            {
              "type": "ref",
              "value": [
                {
                  "type": "var",
                  "value": "eq"
                }
              ]
            },
            {
              "type": "ref",
              "value": [
                {
                  "type": "var",
                  "value": "list1"
                },
                {
                  "type": "var",
                  "value": "$2"
                }
              ]
            },
            {
              "type": "ref",
              "value": [
                {
                  "type": "var",
                  "value": "list2"
                },
                {
                  "type": "var",
                  "value": "$3"
                }
              ]
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 76,
          "col": 5
        },
        "QueryID": 18,
        "ParentID": 17,
        "Locals": [
          {
            "name": "list1",
            "type": "array",
            "value": [
              {
                "type": "string",
                "value": ""
              }
            ]
          },
          {
            "name": "list2",
            "type": "array",
            "value": [
              {
                "type": "string",
                "value": "sec-ODP-Developer"
              },
              {
                "type": "string",
                "value": "sec-ODP-Data-Controller"
              }
            ]
          }
        ],
        "LocalMetadata": {
          "list1": {
            "name": "list1",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 75,
              "col": 17
            }
          },
          "list2": {
            "name": "list2",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 75,
              "col": 24
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Fail",
        "Node": {
          "index": 0,
          "terms": [
            {
              "type": "ref",
              "value": [
                {
                  "type": "var",
                  "value": "data"
                },
                {
                  "type": "string",
                  "value": "http"
                },
                {
                  "type": "string",
                  "value": "request"
                },
                {
                  "type": "string",
                  "value": "authz"
                },
                {
                  "type": "string",
                  "value": "lists_intersect"
                }
              ]
            },
            {
              "type": "var",
              "value": "__local37__"
            },
            {
              "type": "var",
              "value": "__local38__"
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 30,
          "col": 9
        },
        "QueryID": 17,
        "ParentID": 14,
        "Locals": [
          {
            "name": "__local36__",
            "type": "string",
            "value": "/statistics"
          },
          {
            "name": "__local37__",
            "type": "array",
            "value": [
              {
                "type": "string",
                "value": ""
              }
            ]
          },
          {
            "name": "__local38__",
            "type": "array",
            "value": [
              {
                "type": "string",
                "value": "sec-ODP-Developer"
              },
              {
                "type": "string",
                "value": "sec-ODP-Data-Controller"
              }
            ]
          }
        ],
        "LocalMetadata": {
          "__local36__": {
            "name": "__local36__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 29,
              "col": 16
            }
          },
          "__local37__": {
            "name": "__local37__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 30,
              "col": 25
            }
          },
          "__local38__": {
            "name": "__local38__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 30,
              "col": 40
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Enter",
        "Node": {
          "head": {
            "name": "accessToResourceNotAllowed",
            "key": {
              "type": "var",
              "value": "__local0__"
            }
          },
          "body": [
            {
              "index": 0,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "jwtDecoded"
                    }
                  ]
                },
                {
                  "type": "object",
                  "value": []
                }
              ]
            },
            {
              "index": 1,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local0__"
                },
                {
                  "type": "string",
                  "value": "Invalid input, missing JWT"
                }
              ]
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 12,
          "col": 1
        },
        "QueryID": 19,
        "ParentID": 8,
        "Locals": null,
        "LocalMetadata": {
          "__local0__": {
            "name": "reason",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 12,
              "col": 28
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Fail",
        "Node": {
          "index": 0,
          "terms": [
            {
              "type": "ref",
              "value": [
                {
                  "type": "var",
                  "value": "eq"
                }
              ]
            },
            {
              "type": "ref",
              "value": [
                {
                  "type": "var",
                  "value": "data"
                },
                {
                  "type": "string",
                  "value": "http"
                },
                {
                  "type": "string",
                  "value": "request"
                },
                {
                  "type": "string",
                  "value": "authz"
                },
                {
                  "type": "string",
                  "value": "jwtDecoded"
                }
              ]
            },
            {
              "type": "object",
              "value": []
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 13,
          "col": 5
        },
        "QueryID": 19,
        "ParentID": 8,
        "Locals": null,
        "LocalMetadata": {},
        "Message": ""
      },
      {
        "Op": "Enter",
        "Node": {
          "head": {
            "name": "accessToResourceNotAllowed",
            "key": {
              "type": "var",
              "value": "__local1__"
            }
          },
          "body": [
            {
              "index": 0,
              "negated": true,
              "terms": {
                "type": "ref",
                "value": [
                  {
                    "type": "var",
                    "value": "input"
                  },
                  {
                    "type": "string",
                    "value": "path"
                  }
                ]
              }
            },
            {
              "index": 1,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local1__"
                },
                {
                  "type": "string",
                  "value": "Invalid input, can't extract path"
                }
              ]
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 17,
          "col": 1
        },
        "QueryID": 20,
        "ParentID": 8,
        "Locals": null,
        "LocalMetadata": {
          "__local1__": {
            "name": "reason",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 17,
              "col": 28
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Fail",
        "Node": {
          "index": 0,
          "negated": true,
          "terms": {
            "type": "ref",
            "value": [
              {
                "type": "var",
                "value": "input"
              },
              {
                "type": "string",
                "value": "path"
              }
            ]
          }
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 18,
          "col": 9
        },
        "QueryID": 20,
        "ParentID": 8,
        "Locals": null,
        "LocalMetadata": {},
        "Message": ""
      },
      {
        "Op": "Enter",
        "Node": {
          "head": {
            "name": "accessToResourceNotAllowed",
            "key": {
              "type": "var",
              "value": "__local2__"
            }
          },
          "body": [
            {
              "generated": true,
              "index": 0,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local31__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "input"
                    },
                    {
                      "type": "string",
                      "value": "path"
                    }
                  ]
                }
              ]
            },
            {
              "index": 1,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "startswith"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local31__"
                },
                {
                  "type": "string",
                  "value": "/messages"
                }
              ]
            },
            {
              "generated": true,
              "index": 2,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local32__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "groupsFromJwt"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 3,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local33__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "allowedGroups"
                    }
                  ]
                }
              ]
            },
            {
              "index": 4,
              "negated": true,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "lists_intersect"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local32__"
                },
                {
                  "type": "var",
                  "value": "__local33__"
                }
              ]
            },
            {
              "generated": true,
              "index": 5,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local34__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "input"
                    },
                    {
                      "type": "string",
                      "value": "path"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 6,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local35__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "allowedGroups"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 7,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "sprintf"
                    }
                  ]
                },
                {
                  "type": "string",
                  "value": "Not allowed to access '%v', required group: '%v'"
                },
                {
                  "type": "array",
                  "value": [
                    {
                      "type": "var",
                      "value": "__local34__"
                    },
                    {
                      "type": "var",
                      "value": "__local35__"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local14__"
                }
              ]
            },
            {
              "index": 8,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local2__"
                },
                {
                  "type": "var",
                  "value": "__local14__"
                }
              ]
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 22,
          "col": 1
        },
        "QueryID": 22,
        "ParentID": 8,
        "Locals": null,
        "LocalMetadata": {
          "__local2__": {
            "name": "reason",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 22,
              "col": 28
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Fail",
        "Node": {
          "index": 1,
          "terms": [
            {
              "type": "ref",
              "value": [
                {
                  "type": "var",
                  "value": "startswith"
                }
              ]
            },
            {
              "type": "var",
              "value": "__local31__"
            },
            {
              "type": "string",
              "value": "/messages"
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 23,
          "col": 5
        },
        "QueryID": 22,
        "ParentID": 8,
        "Locals": [
          {
            "name": "__local31__",
            "type": "string",
            "value": "/statistics"
          }
        ],
        "LocalMetadata": {
          "__local31__": {
            "name": "__local31__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 23,
              "col": 16
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Enter",
        "Node": {
          "head": {
            "name": "accessToResourceNotAllowed",
            "key": {
              "type": "var",
              "value": "__local3__"
            }
          },
          "body": [
            {
              "generated": true,
              "index": 0,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local36__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "input"
                    },
                    {
                      "type": "string",
                      "value": "path"
                    }
                  ]
                }
              ]
            },
            {
              "index": 1,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "startswith"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local36__"
                },
                {
                  "type": "string",
                  "value": "/statistics"
                }
              ]
            },
            {
              "generated": true,
              "index": 2,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local37__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "groupsFromJwt"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 3,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local38__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "allowedGroups"
                    }
                  ]
                }
              ]
            },
            {
              "index": 4,
              "negated": true,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "lists_intersect"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local37__"
                },
                {
                  "type": "var",
                  "value": "__local38__"
                }
              ]
            },
            {
              "generated": true,
              "index": 5,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local39__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "input"
                    },
                    {
                      "type": "string",
                      "value": "path"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 6,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local40__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "allowedGroups"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 7,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "sprintf"
                    }
                  ]
                },
                {
                  "type": "string",
                  "value": "Not allowed to access '%v', required group: '%v'"
                },
                {
                  "type": "array",
                  "value": [
                    {
                      "type": "var",
                      "value": "__local39__"
                    },
                    {
                      "type": "var",
                      "value": "__local40__"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local15__"
                }
              ]
            },
            {
              "index": 8,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local3__"
                },
                {
                  "type": "var",
                  "value": "__local15__"
                }
              ]
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 28,
          "col": 1
        },
        "QueryID": 23,
        "ParentID": 8,
        "Locals": null,
        "LocalMetadata": {
          "__local3__": {
            "name": "reason",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 28,
              "col": 28
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Enter",
        "Node": [
          {
            "index": 0,
            "terms": [
              {
                "type": "ref",
                "value": [
                  {
                    "type": "var",
                    "value": "data"
                  },
                  {
                    "type": "string",
                    "value": "http"
                  },
                  {
                    "type": "string",
                    "value": "request"
                  },
                  {
                    "type": "string",
                    "value": "authz"
                  },
                  {
                    "type": "string",
                    "value": "lists_intersect"
                  }
                ]
              },
              {
                "type": "var",
                "value": "__local37__"
              },
              {
                "type": "var",
                "value": "__local38__"
              }
            ]
          }
        ],
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 30,
          "col": 9
        },
        "QueryID": 24,
        "ParentID": 23,
        "Locals": [
          {
            "name": "__local36__",
            "type": "string",
            "value": "/statistics"
          },
          {
            "name": "__local37__",
            "type": "array",
            "value": [
              {
                "type": "string",
                "value": ""
              }
            ]
          },
          {
            "name": "__local38__",
            "type": "array",
            "value": [
              {
                "type": "string",
                "value": "sec-ODP-Developer"
              },
              {
                "type": "string",
                "value": "sec-ODP-Data-Controller"
              }
            ]
          }
        ],
        "LocalMetadata": {
          "__local36__": {
            "name": "__local36__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 29,
              "col": 16
            }
          },
          "__local37__": {
            "name": "__local37__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 30,
              "col": 25
            }
          },
          "__local38__": {
            "name": "__local38__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 30,
              "col": 40
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Enter",
        "Node": {
          "head": {
            "name": "lists_intersect",
            "args": [
              {
                "type": "var",
                "value": "list1"
              },
              {
                "type": "var",
                "value": "list2"
              }
            ],
            "value": {
              "type": "boolean",
              "value": true
            }
          },
          "body": [
            {
              "index": 0,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "list1"
                    },
                    {
                      "type": "var",
                      "value": "$2"
                    }
                  ]
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "list2"
                    },
                    {
                      "type": "var",
                      "value": "$3"
                    }
                  ]
                }
              ]
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 75,
          "col": 1
        },
        "QueryID": 25,
        "ParentID": 24,
        "Locals": null,
        "LocalMetadata": {},
        "Message": ""
      },
      {
        "Op": "Fail",
        "Node": {
          "index": 0,
          "terms": [
            {
              "type": "ref",
              "value": [
                {
                  "type": "var",
                  "value": "eq"
                }
              ]
            },
            {
              "type": "ref",
              "value": [
                {
                  "type": "var",
                  "value": "list1"
                },
                {
                  "type": "var",
                  "value": "$2"
                }
              ]
            },
            {
              "type": "ref",
              "value": [
                {
                  "type": "var",
                  "value": "list2"
                },
                {
                  "type": "var",
                  "value": "$3"
                }
              ]
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 76,
          "col": 5
        },
        "QueryID": 25,
        "ParentID": 24,
        "Locals": [
          {
            "name": "list1",
            "type": "array",
            "value": [
              {
                "type": "string",
                "value": ""
              }
            ]
          },
          {
            "name": "list2",
            "type": "array",
            "value": [
              {
                "type": "string",
                "value": "sec-ODP-Developer"
              },
              {
                "type": "string",
                "value": "sec-ODP-Data-Controller"
              }
            ]
          }
        ],
        "LocalMetadata": {
          "list1": {
            "name": "list1",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 75,
              "col": 17
            }
          },
          "list2": {
            "name": "list2",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 75,
              "col": 24
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Fail",
        "Node": {
          "index": 0,
          "terms": [
            {
              "type": "ref",
              "value": [
                {
                  "type": "var",
                  "value": "data"
                },
                {
                  "type": "string",
                  "value": "http"
                },
                {
                  "type": "string",
                  "value": "request"
                },
                {
                  "type": "string",
                  "value": "authz"
                },
                {
                  "type": "string",
                  "value": "lists_intersect"
                }
              ]
            },
            {
              "type": "var",
              "value": "__local37__"
            },
            {
              "type": "var",
              "value": "__local38__"
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 30,
          "col": 9
        },
        "QueryID": 24,
        "ParentID": 23,
        "Locals": [
          {
            "name": "__local36__",
            "type": "string",
            "value": "/statistics"
          },
          {
            "name": "__local37__",
            "type": "array",
            "value": [
              {
                "type": "string",
                "value": ""
              }
            ]
          },
          {
            "name": "__local38__",
            "type": "array",
            "value": [
              {
                "type": "string",
                "value": "sec-ODP-Developer"
              },
              {
                "type": "string",
                "value": "sec-ODP-Data-Controller"
              }
            ]
          }
        ],
        "LocalMetadata": {
          "__local36__": {
            "name": "__local36__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 29,
              "col": 16
            }
          },
          "__local37__": {
            "name": "__local37__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 30,
              "col": 25
            }
          },
          "__local38__": {
            "name": "__local38__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 30,
              "col": 40
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Fail",
        "Node": {
          "index": 0,
          "terms": {
            "type": "ref",
            "value": [
              {
                "type": "var",
                "value": "data"
              },
              {
                "type": "string",
                "value": "http"
              },
              {
                "type": "string",
                "value": "request"
              },
              {
                "type": "string",
                "value": "authz"
              },
              {
                "type": "string",
                "value": "allow"
              }
            ]
          }
        },
        "Location": {
          "file": "src/test/resources/opa/policies/policies-test.rego",
          "row": 46,
          "col": 9
        },
        "QueryID": 3,
        "ParentID": 1,
        "Locals": [
          {
            "name": "__local26__",
            "type": "string",
            "value": "eyJhbGciOiAiUlMyNTYiLCAidHlwIjogIkpXVCJ9.eyJjbGllbnRfaWQiOiAib2RwLWRpc21pdCIsICJleHAiOiAxNTgxOTU3NzIxLCAib2RwIjogeyJncm91cHMiOiBbIiJdfSwgInB1cnBvc2UiOiAiYWNjZXNzX3Rva2VuIiwgInNjb3BlIjogIm9wYS1kaXNtaXQiLCAidXNlcm5hbWUiOiAib2RwLWRpc21pdCJ9.V60AwDLqzNfzfOd-R0gxqPHaYU3ok91ogwAvttSuIoZERfevj9qNwaKtp0vfSgpMwAPleXAgDB1ACQbK7ZlQpgqO9npZw3gEELPJaAUcigJs1YgWRz7Yhy1cSDQULK5LycecO_iMPnJtTLR1jrKGdbe-THdXylt2XADxU2MzYHvebf9gNNUZhW_cFyT9RoyxnkPt5t3ktv-WGhwu9x95iedSSQtP3ktuWTOXjavURcVRLwlL7RV1Z5sjcniiMfWNYFcXRQOemKMqvqWIkTzzuaQOCbBIp-gp00EvkNi2-9FFnzZ2_mxha95WSFMypQl5HzCgiPyl3PJ_XExuXRPjLg"
          },
          {
            "name": "__local11__",
            "type": "string",
            "value": "eyJhbGciOiAiUlMyNTYiLCAidHlwIjogIkpXVCJ9.eyJjbGllbnRfaWQiOiAib2RwLWRpc21pdCIsICJleHAiOiAxNTgxOTU3NzIxLCAib2RwIjogeyJncm91cHMiOiBbIiJdfSwgInB1cnBvc2UiOiAiYWNjZXNzX3Rva2VuIiwgInNjb3BlIjogIm9wYS1kaXNtaXQiLCAidXNlcm5hbWUiOiAib2RwLWRpc21pdCJ9.V60AwDLqzNfzfOd-R0gxqPHaYU3ok91ogwAvttSuIoZERfevj9qNwaKtp0vfSgpMwAPleXAgDB1ACQbK7ZlQpgqO9npZw3gEELPJaAUcigJs1YgWRz7Yhy1cSDQULK5LycecO_iMPnJtTLR1jrKGdbe-THdXylt2XADxU2MzYHvebf9gNNUZhW_cFyT9RoyxnkPt5t3ktv-WGhwu9x95iedSSQtP3ktuWTOXjavURcVRLwlL7RV1Z5sjcniiMfWNYFcXRQOemKMqvqWIkTzzuaQOCbBIp-gp00EvkNi2-9FFnzZ2_mxha95WSFMypQl5HzCgiPyl3PJ_XExuXRPjLg"
          }
        ],
        "LocalMetadata": {
          "__local11__": {
            "name": "jwt",
            "location": {
              "file": "src/test/resources/opa/policies/policies-test.rego",
              "row": 45,
              "col": 5
            }
          },
          "__local26__": {
            "name": "__local26__",
            "location": {
              "file": "src/test/resources/opa/policies/policies-test.rego",
              "row": 45,
              "col": 12
            }
          }
        },
        "Message": ""
      }
    ]
  },
  {
    "location": {
      "file": "src/test/resources/opa/policies/policies-test.rego",
      "row": 49,
      "col": 1
    },
    "package": "data.http.request.authz",
    "name": "test_allow_if_jwt_with_groups_for_statistics",
    "duration": 1748708,
    "trace": [
      {
        "Op": "Enter",
        "Node": [
          {
            "index": 0,
            "terms": [
              {
                "type": "ref",
                "value": [
                  {
                    "type": "var",
                    "value": "eq"
                  }
                ]
              },
              {
                "type": "ref",
                "value": [
                  {
                    "type": "var",
                    "value": "data"
                  },
                  {
                    "type": "string",
                    "value": "http"
                  },
                  {
                    "type": "string",
                    "value": "request"
                  },
                  {
                    "type": "string",
                    "value": "authz"
                  },
                  {
                    "type": "string",
                    "value": "test_allow_if_jwt_with_groups_for_statistics"
                  }
                ]
              },
              {
                "type": "var",
                "value": "$term1"
              }
            ]
          }
        ],
        "Location": {
          "file": "",
          "row": 1,
          "col": 1
        },
        "QueryID": 0,
        "ParentID": 0,
        "Locals": null,
        "LocalMetadata": {},
        "Message": ""
      },
      {
        "Op": "Enter",
        "Node": {
          "head": {
            "name": "test_allow_if_jwt_with_groups_for_statistics",
            "value": {
              "type": "boolean",
              "value": true
            }
          },
          "body": [
            {
              "generated": true,
              "index": 0,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "generateJWT"
                    }
                  ]
                },
                {
                  "type": "string",
                  "value": "sec-ODP-Developer"
                },
                {
                  "type": "var",
                  "value": "__local27__"
                }
              ]
            },
            {
              "index": 1,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local12__"
                },
                {
                  "type": "var",
                  "value": "__local27__"
                }
              ]
            },
            {
              "index": 2,
              "terms": {
                "type": "ref",
                "value": [
                  {
                    "type": "var",
                    "value": "data"
                  },
                  {
                    "type": "string",
                    "value": "http"
                  },
                  {
                    "type": "string",
                    "value": "request"
                  },
                  {
                    "type": "string",
                    "value": "authz"
                  },
                  {
                    "type": "string",
                    "value": "allow"
                  }
                ]
              },
              "with": [
                {
                  "target": {
                    "type": "ref",
                    "value": [
                      {
                        "type": "var",
                        "value": "input"
                      }
                    ]
                  },
                  "value": {
                    "type": "object",
                    "value": [
                      [
                        {
                          "type": "string",
                          "value": "encodedJwt"
                        },
                        {
                          "type": "var",
                          "value": "__local12__"
                        }
                      ],
                      [
                        {
                          "type": "string",
                          "value": "path"
                        },
                        {
                          "type": "string",
                          "value": "/statistics"
                        }
                      ]
                    ]
                  }
                }
              ]
            }
          ]
        },
        "Location": {
          "file": "src/test/resources/opa/policies/policies-test.rego",
          "row": 49,
          "col": 1
        },
        "QueryID": 1,
        "ParentID": 0,
        "Locals": null,
        "LocalMetadata": {
          "__local12__": {
            "name": "jwt",
            "location": {
              "file": "src/test/resources/opa/policies/policies-test.rego",
              "row": 50,
              "col": 5
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Enter",
        "Node": {
          "head": {
            "name": "allow",
            "value": {
              "type": "var",
              "value": "__local29__"
            }
          },
          "body": [
            {
              "index": 0,
              "terms": {
                "type": "boolean",
                "value": true
              }
            },
            {
              "generated": true,
              "index": 1,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local29__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "status"
                    },
                    {
                      "type": "string",
                      "value": "allowed"
                    }
                  ]
                }
              ]
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 47,
          "col": 9
        },
        "QueryID": 3,
        "ParentID": 1,
        "Locals": null,
        "LocalMetadata": {},
        "Message": ""
      },
      {
        "Op": "Enter",
        "Node": {
          "head": {
            "name": "status",
            "value": {
              "type": "object",
              "value": [
                [
                  {
                    "type": "string",
                    "value": "allowed"
                  },
                  {
                    "type": "boolean",
                    "value": true
                  }
                ],
                [
                  {
                    "type": "string",
                    "value": "reason"
                  },
                  {
                    "type": "var",
                    "value": "__local17__"
                  }
                ]
              ]
            }
          },
          "body": [
            {
              "generated": true,
              "index": 0,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local44__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "accessToWhitelistAllowed"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 1,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "count"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local44__"
                },
                {
                  "type": "var",
                  "value": "__local18__"
                }
              ]
            },
            {
              "index": 2,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "gt"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local18__"
                },
                {
                  "type": "number",
                  "value": 0
                }
              ]
            },
            {
              "generated": true,
              "index": 3,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local45__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "accessToWhitelistAllowed"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 4,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "concat"
                    }
                  ]
                },
                {
                  "type": "string",
                  "value": " | "
                },
                {
                  "type": "var",
                  "value": "__local45__"
                },
                {
                  "type": "var",
                  "value": "__local17__"
                }
              ]
            }
          ],
          "else": {
            "head": {
              "name": "status",
              "value": {
                "type": "object",
                "value": [
                  [
                    {
                      "type": "string",
                      "value": "allowed"
                    },
                    {
                      "type": "boolean",
                      "value": false
                    }
                  ],
                  [
                    {
                      "type": "string",
                      "value": "reason"
                    },
                    {
                      "type": "var",
                      "value": "__local19__"
                    }
                  ]
                ]
              }
            },
            "body": [
              {
                "generated": true,
                "index": 0,
                "terms": [
                  {
                    "type": "ref",
                    "value": [
                      {
                        "type": "var",
                        "value": "eq"
                      }
                    ]
                  },
                  {
                    "type": "var",
                    "value": "__local46__"
                  },
                  {
                    "type": "ref",
                    "value": [
                      {
                        "type": "var",
                        "value": "data"
                      },
                      {
                        "type": "string",
                        "value": "http"
                      },
                      {
                        "type": "string",
                        "value": "request"
                      },
                      {
                        "type": "string",
                        "value": "authz"
                      },
                      {
                        "type": "string",
                        "value": "accessToResourceNotAllowed"
                      }
                    ]
                  }
                ]
              },
              {
                "generated": true,
                "index": 1,
                "terms": [
                  {
                    "type": "ref",
                    "value": [
                      {
                        "type": "var",
                        "value": "count"
                      }
                    ]
                  },
                  {
                    "type": "var",
                    "value": "__local46__"
                  },
                  {
                    "type": "var",
                    "value": "__local20__"
                  }
                ]
              },
              {
                "index": 2,
                "terms": [
                  {
                    "type": "ref",
                    "value": [
                      {
                        "type": "var",
                        "value": "gt"
                      }
                    ]
                  },
                  {
                    "type": "var",
                    "value": "__local20__"
                  },
                  {
                    "type": "number",
                    "value": 0
                  }
                ]
              },
              {
                "generated": true,
                "index": 3,
                "terms": [
                  {
                    "type": "ref",
                    "value": [
                      {
                        "type": "var",
                        "value": "eq"
                      }
                    ]
                  },
                  {
                    "type": "var",
                    "value": "__local47__"
                  },
                  {
                    "type": "ref",
                    "value": [
                      {
                        "type": "var",
                        "value": "data"
                      },
                      {
                        "type": "string",
                        "value": "http"
                      },
                      {
                        "type": "string",
                        "value": "request"
                      },
                      {
                        "type": "string",
                        "value": "authz"
                      },
                      {
                        "type": "string",
                        "value": "accessToResourceNotAllowed"
                      }
                    ]
                  }
                ]
              },
              {
                "generated": true,
                "index": 4,
                "terms": [
                  {
                    "type": "ref",
                    "value": [
                      {
                        "type": "var",
                        "value": "concat"
                      }
                    ]
                  },
                  {
                    "type": "string",
                    "value": " | "
                  },
                  {
                    "type": "var",
                    "value": "__local47__"
                  },
                  {
                    "type": "var",
                    "value": "__local19__"
                  }
                ]
              }
            ],
            "else": {
              "head": {
                "name": "status",
                "value": {
                  "type": "object",
                  "value": [
                    [
                      {
                        "type": "string",
                        "value": "allowed"
                      },
                      {
                        "type": "boolean",
                        "value": true
                      }
                    ],
                    [
                      {
                        "type": "string",
                        "value": "reason"
                      },
                      {
                        "type": "string",
                        "value": "Access allowed, all rules passed"
                      }
                    ]
                  ]
                }
              },
              "body": [
                {
                  "index": 0,
                  "terms": {
                    "type": "boolean",
                    "value": true
                  }
                }
              ]
            }
          }
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 39,
          "col": 1
        },
        "QueryID": 4,
        "ParentID": 3,
        "Locals": null,
        "LocalMetadata": {},
        "Message": ""
      },
      {
        "Op": "Enter",
        "Node": {
          "head": {
            "name": "accessToWhitelistAllowed",
            "key": {
              "type": "var",
              "value": "__local4__"
            }
          },
          "body": [
            {
              "generated": true,
              "index": 0,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local41__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "input"
                    },
                    {
                      "type": "string",
                      "value": "path"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 1,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local42__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "whitelistedEndpoints"
                    },
                    {
                      "type": "var",
                      "value": "$0"
                    }
                  ]
                }
              ]
            },
            {
              "index": 2,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "startswith"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local41__"
                },
                {
                  "type": "var",
                  "value": "__local42__"
                }
              ]
            },
            {
              "generated": true,
              "index": 3,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local43__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "input"
                    },
                    {
                      "type": "string",
                      "value": "path"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 4,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "sprintf"
                    }
                  ]
                },
                {
                  "type": "string",
                  "value": "Resource '%v' on whitelist"
                },
                {
                  "type": "array",
                  "value": [
                    {
                      "type": "var",
                      "value": "__local43__"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local16__"
                }
              ]
            },
            {
              "index": 5,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local4__"
                },
                {
                  "type": "var",
                  "value": "__local16__"
                }
              ]
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 34,
          "col": 1
        },
        "QueryID": 5,
        "ParentID": 4,
        "Locals": null,
        "LocalMetadata": {
          "__local4__": {
            "name": "reason",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 34,
              "col": 26
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Fail",
        "Node": {
          "index": 2,
          "terms": [
            {
              "type": "ref",
              "value": [
                {
                  "type": "var",
                  "value": "startswith"
                }
              ]
            },
            {
              "type": "var",
              "value": "__local41__"
            },
            {
              "type": "var",
              "value": "__local42__"
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 35,
          "col": 5
        },
        "QueryID": 5,
        "ParentID": 4,
        "Locals": [
          {
            "name": "__local41__",
            "type": "string",
            "value": "/statistics"
          },
          {
            "name": "_",
            "type": "number",
            "value": 0
          },
          {
            "name": "__local42__",
            "type": "string",
            "value": "/ping"
          }
        ],
        "LocalMetadata": {
          "$0": {
            "name": "$0",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 35,
              "col": 49
            }
          },
          "__local41__": {
            "name": "__local41__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 35,
              "col": 16
            }
          },
          "__local42__": {
            "name": "__local42__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 35,
              "col": 28
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Fail",
        "Node": {
          "index": 2,
          "terms": [
            {
              "type": "ref",
              "value": [
                {
                  "type": "var",
                  "value": "startswith"
                }
              ]
            },
            {
              "type": "var",
              "value": "__local41__"
            },
            {
              "type": "var",
              "value": "__local42__"
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 35,
          "col": 5
        },
        "QueryID": 5,
        "ParentID": 4,
        "Locals": [
          {
            "name": "__local41__",
            "type": "string",
            "value": "/statistics"
          },
          {
            "name": "_",
            "type": "number",
            "value": 1
          },
          {
            "name": "__local42__",
            "type": "string",
            "value": "/error"
          }
        ],
        "LocalMetadata": {
          "$0": {
            "name": "$0",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 35,
              "col": 49
            }
          },
          "__local41__": {
            "name": "__local41__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 35,
              "col": 16
            }
          },
          "__local42__": {
            "name": "__local42__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 35,
              "col": 28
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Fail",
        "Node": {
          "index": 2,
          "terms": [
            {
              "type": "ref",
              "value": [
                {
                  "type": "var",
                  "value": "startswith"
                }
              ]
            },
            {
              "type": "var",
              "value": "__local41__"
            },
            {
              "type": "var",
              "value": "__local42__"
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 35,
          "col": 5
        },
        "QueryID": 5,
        "ParentID": 4,
        "Locals": [
          {
            "name": "_",
            "type": "number",
            "value": 2
          },
          {
            "name": "__local42__",
            "type": "string",
            "value": "/health"
          },
          {
            "name": "__local41__",
            "type": "string",
            "value": "/statistics"
          }
        ],
        "LocalMetadata": {
          "$0": {
            "name": "$0",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 35,
              "col": 49
            }
          },
          "__local41__": {
            "name": "__local41__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 35,
              "col": 16
            }
          },
          "__local42__": {
            "name": "__local42__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 35,
              "col": 28
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Fail",
        "Node": {
          "index": 2,
          "terms": [
            {
              "type": "ref",
              "value": [
                {
                  "type": "var",
                  "value": "gt"
                }
              ]
            },
            {
              "type": "var",
              "value": "__local18__"
            },
            {
              "type": "number",
              "value": 0
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 40,
          "col": 5
        },
        "QueryID": 4,
        "ParentID": 3,
        "Locals": [
          {
            "name": "__local44__",
            "type": "set",
            "value": []
          },
          {
            "name": "__local18__",
            "type": "number",
            "value": 0
          }
        ],
        "LocalMetadata": {
          "__local18__": {
            "name": "__local18__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 40,
              "col": 5
            }
          },
          "__local44__": {
            "name": "__local44__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 40,
              "col": 11
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Enter",
        "Node": {
          "head": {
            "name": "status",
            "value": {
              "type": "object",
              "value": [
                [
                  {
                    "type": "string",
                    "value": "allowed"
                  },
                  {
                    "type": "boolean",
                    "value": false
                  }
                ],
                [
                  {
                    "type": "string",
                    "value": "reason"
                  },
                  {
                    "type": "var",
                    "value": "__local19__"
                  }
                ]
              ]
            }
          },
          "body": [
            {
              "generated": true,
              "index": 0,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local46__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "accessToResourceNotAllowed"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 1,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "count"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local46__"
                },
                {
                  "type": "var",
                  "value": "__local20__"
                }
              ]
            },
            {
              "index": 2,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "gt"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local20__"
                },
                {
                  "type": "number",
                  "value": 0
                }
              ]
            },
            {
              "generated": true,
              "index": 3,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local47__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "accessToResourceNotAllowed"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 4,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "concat"
                    }
                  ]
                },
                {
                  "type": "string",
                  "value": " | "
                },
                {
                  "type": "var",
                  "value": "__local47__"
                },
                {
                  "type": "var",
                  "value": "__local19__"
                }
              ]
            }
          ],
          "else": {
            "head": {
              "name": "status",
              "value": {
                "type": "object",
                "value": [
                  [
                    {
                      "type": "string",
                      "value": "allowed"
                    },
                    {
                      "type": "boolean",
                      "value": true
                    }
                  ],
                  [
                    {
                      "type": "string",
                      "value": "reason"
                    },
                    {
                      "type": "string",
                      "value": "Access allowed, all rules passed"
                    }
                  ]
                ]
              }
            },
            "body": [
              {
                "index": 0,
                "terms": {
                  "type": "boolean",
                  "value": true
                }
              }
            ]
          }
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 41,
          "col": 3
        },
        "QueryID": 7,
        "ParentID": 3,
        "Locals": null,
        "LocalMetadata": {},
        "Message": ""
      },
      {
        "Op": "Enter",
        "Node": {
          "head": {
            "name": "accessToResourceNotAllowed",
            "key": {
              "type": "var",
              "value": "__local0__"
            }
          },
          "body": [
            {
              "index": 0,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "jwtDecoded"
                    }
                  ]
                },
                {
                  "type": "object",
                  "value": []
                }
              ]
            },
            {
              "index": 1,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local0__"
                },
                {
                  "type": "string",
                  "value": "Invalid input, missing JWT"
                }
              ]
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 12,
          "col": 1
        },
        "QueryID": 8,
        "ParentID": 7,
        "Locals": null,
        "LocalMetadata": {
          "__local0__": {
            "name": "reason",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 12,
              "col": 28
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Fail",
        "Node": {
          "index": 0,
          "terms": [
            {
              "type": "ref",
              "value": [
                {
                  "type": "var",
                  "value": "eq"
                }
              ]
            },
            {
              "type": "ref",
              "value": [
                {
                  "type": "var",
                  "value": "data"
                },
                {
                  "type": "string",
                  "value": "http"
                },
                {
                  "type": "string",
                  "value": "request"
                },
                {
                  "type": "string",
                  "value": "authz"
                },
                {
                  "type": "string",
                  "value": "jwtDecoded"
                }
              ]
            },
            {
              "type": "object",
              "value": []
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 13,
          "col": 5
        },
        "QueryID": 8,
        "ParentID": 7,
        "Locals": null,
        "LocalMetadata": {},
        "Message": ""
      },
      {
        "Op": "Enter",
        "Node": {
          "head": {
            "name": "accessToResourceNotAllowed",
            "key": {
              "type": "var",
              "value": "__local1__"
            }
          },
          "body": [
            {
              "index": 0,
              "negated": true,
              "terms": {
                "type": "ref",
                "value": [
                  {
                    "type": "var",
                    "value": "input"
                  },
                  {
                    "type": "string",
                    "value": "path"
                  }
                ]
              }
            },
            {
              "index": 1,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local1__"
                },
                {
                  "type": "string",
                  "value": "Invalid input, can't extract path"
                }
              ]
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 17,
          "col": 1
        },
        "QueryID": 10,
        "ParentID": 7,
        "Locals": null,
        "LocalMetadata": {
          "__local1__": {
            "name": "reason",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 17,
              "col": 28
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Fail",
        "Node": {
          "index": 0,
          "negated": true,
          "terms": {
            "type": "ref",
            "value": [
              {
                "type": "var",
                "value": "input"
              },
              {
                "type": "string",
                "value": "path"
              }
            ]
          }
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 18,
          "col": 9
        },
        "QueryID": 10,
        "ParentID": 7,
        "Locals": null,
        "LocalMetadata": {},
        "Message": ""
      },
      {
        "Op": "Enter",
        "Node": {
          "head": {
            "name": "accessToResourceNotAllowed",
            "key": {
              "type": "var",
              "value": "__local2__"
            }
          },
          "body": [
            {
              "generated": true,
              "index": 0,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local31__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "input"
                    },
                    {
                      "type": "string",
                      "value": "path"
                    }
                  ]
                }
              ]
            },
            {
              "index": 1,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "startswith"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local31__"
                },
                {
                  "type": "string",
                  "value": "/messages"
                }
              ]
            },
            {
              "generated": true,
              "index": 2,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local32__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "groupsFromJwt"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 3,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local33__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "allowedGroups"
                    }
                  ]
                }
              ]
            },
            {
              "index": 4,
              "negated": true,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "lists_intersect"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local32__"
                },
                {
                  "type": "var",
                  "value": "__local33__"
                }
              ]
            },
            {
              "generated": true,
              "index": 5,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local34__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "input"
                    },
                    {
                      "type": "string",
                      "value": "path"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 6,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local35__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "allowedGroups"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 7,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "sprintf"
                    }
                  ]
                },
                {
                  "type": "string",
                  "value": "Not allowed to access '%v', required group: '%v'"
                },
                {
                  "type": "array",
                  "value": [
                    {
                      "type": "var",
                      "value": "__local34__"
                    },
                    {
                      "type": "var",
                      "value": "__local35__"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local14__"
                }
              ]
            },
            {
              "index": 8,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local2__"
                },
                {
                  "type": "var",
                  "value": "__local14__"
                }
              ]
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 22,
          "col": 1
        },
        "QueryID": 12,
        "ParentID": 7,
        "Locals": null,
        "LocalMetadata": {
          "__local2__": {
            "name": "reason",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 22,
              "col": 28
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Fail",
        "Node": {
          "index": 1,
          "terms": [
            {
              "type": "ref",
              "value": [
                {
                  "type": "var",
                  "value": "startswith"
                }
              ]
            },
            {
              "type": "var",
              "value": "__local31__"
            },
            {
              "type": "string",
              "value": "/messages"
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 23,
          "col": 5
        },
        "QueryID": 12,
        "ParentID": 7,
        "Locals": [
          {
            "name": "__local31__",
            "type": "string",
            "value": "/statistics"
          }
        ],
        "LocalMetadata": {
          "__local31__": {
            "name": "__local31__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 23,
              "col": 16
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Enter",
        "Node": {
          "head": {
            "name": "accessToResourceNotAllowed",
            "key": {
              "type": "var",
              "value": "__local3__"
            }
          },
          "body": [
            {
              "generated": true,
              "index": 0,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local36__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "input"
                    },
                    {
                      "type": "string",
                      "value": "path"
                    }
                  ]
                }
              ]
            },
            {
              "index": 1,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "startswith"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local36__"
                },
                {
                  "type": "string",
                  "value": "/statistics"
                }
              ]
            },
            {
              "generated": true,
              "index": 2,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local37__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "groupsFromJwt"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 3,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local38__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "allowedGroups"
                    }
                  ]
                }
              ]
            },
            {
              "index": 4,
              "negated": true,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "lists_intersect"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local37__"
                },
                {
                  "type": "var",
                  "value": "__local38__"
                }
              ]
            },
            {
              "generated": true,
              "index": 5,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local39__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "input"
                    },
                    {
                      "type": "string",
                      "value": "path"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 6,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local40__"
                },
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "data"
                    },
                    {
                      "type": "string",
                      "value": "http"
                    },
                    {
                      "type": "string",
                      "value": "request"
                    },
                    {
                      "type": "string",
                      "value": "authz"
                    },
                    {
                      "type": "string",
                      "value": "allowedGroups"
                    }
                  ]
                }
              ]
            },
            {
              "generated": true,
              "index": 7,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "sprintf"
                    }
                  ]
                },
                {
                  "type": "string",
                  "value": "Not allowed to access '%v', required group: '%v'"
                },
                {
                  "type": "array",
                  "value": [
                    {
                      "type": "var",
                      "value": "__local39__"
                    },
                    {
                      "type": "var",
                      "value": "__local40__"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local15__"
                }
              ]
            },
            {
              "index": 8,
              "terms": [
                {
                  "type": "ref",
                  "value": [
                    {
                      "type": "var",
                      "value": "eq"
                    }
                  ]
                },
                {
                  "type": "var",
                  "value": "__local3__"
                },
                {
                  "type": "var",
                  "value": "__local15__"
                }
              ]
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 28,
          "col": 1
        },
        "QueryID": 13,
        "ParentID": 7,
        "Locals": null,
        "LocalMetadata": {
          "__local3__": {
            "name": "reason",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 28,
              "col": 28
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Fail",
        "Node": {
          "index": 4,
          "negated": true,
          "terms": [
            {
              "type": "ref",
              "value": [
                {
                  "type": "var",
                  "value": "data"
                },
                {
                  "type": "string",
                  "value": "http"
                },
                {
                  "type": "string",
                  "value": "request"
                },
                {
                  "type": "string",
                  "value": "authz"
                },
                {
                  "type": "string",
                  "value": "lists_intersect"
                }
              ]
            },
            {
              "type": "var",
              "value": "__local37__"
            },
            {
              "type": "var",
              "value": "__local38__"
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 30,
          "col": 9
        },
        "QueryID": 13,
        "ParentID": 7,
        "Locals": [
          {
            "name": "__local36__",
            "type": "string",
            "value": "/statistics"
          },
          {
            "name": "__local37__",
            "type": "array",
            "value": [
              {
                "type": "string",
                "value": "sec-ODP-Developer"
              }
            ]
          },
          {
            "name": "__local38__",
            "type": "array",
            "value": [
              {
                "type": "string",
                "value": "sec-ODP-Developer"
              },
              {
                "type": "string",
                "value": "sec-ODP-Data-Controller"
              }
            ]
          }
        ],
        "LocalMetadata": {
          "__local36__": {
            "name": "__local36__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 29,
              "col": 16
            }
          },
          "__local37__": {
            "name": "__local37__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 30,
              "col": 25
            }
          },
          "__local38__": {
            "name": "__local38__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 30,
              "col": 40
            }
          }
        },
        "Message": ""
      },
      {
        "Op": "Fail",
        "Node": {
          "index": 2,
          "terms": [
            {
              "type": "ref",
              "value": [
                {
                  "type": "var",
                  "value": "gt"
                }
              ]
            },
            {
              "type": "var",
              "value": "__local20__"
            },
            {
              "type": "number",
              "value": 0
            }
          ]
        },
        "Location": {
          "file": "src/main/resources/opa/policies/policies.rego",
          "row": 42,
          "col": 5
        },
        "QueryID": 7,
        "ParentID": 3,
        "Locals": [
          {
            "name": "__local46__",
            "type": "set",
            "value": []
          },
          {
            "name": "__local20__",
            "type": "number",
            "value": 0
          }
        ],
        "LocalMetadata": {
          "__local20__": {
            "name": "__local20__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 42,
              "col": 5
            }
          },
          "__local46__": {
            "name": "__local46__",
            "location": {
              "file": "src/main/resources/opa/policies/policies.rego",
              "row": 42,
              "col": 11
            }
          }
        },
        "Message": ""
      }
    ]
  }
]